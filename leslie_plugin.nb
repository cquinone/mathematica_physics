(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     73837,       1911]
NotebookOptionsPosition[     72867,       1889]
NotebookOutlinePosition[     73261,       1905]
CellTagsIndexPosition[     73218,       1902]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "define", " ", "and", " ", "solve", " ", "matrices", " ", "for", " ", 
     "non"}], "-", 
    RowBox[{"frank", " ", "form", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"is", " ", "this", " ", "saying"}], ",", " ", 
       RowBox[{"size", " ", ">>", " ", 
        RowBox[{"K", " ", "stuff"}]}], ",", " ", "or", ",", " ", 
       RowBox[{"just", " ", "ignore", " ", "K", " ", "for", " ", 
        RowBox[{"now", "?"}]}]}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{"dynamics", " ", "eq", " ", "of", " ", "nhat"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DnDt", "[", 
     RowBox[{
     "v_", ",", "gradn_", ",", "nhat_", ",", "antiv_", ",", "\[Lambda]_", ",",
       "symmv_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", ".", "gradn"}]}], " ", "+", " ", 
     RowBox[{"nhat", ".", "antiv"}], " ", "+", " ", 
     RowBox[{"\[Lambda]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"symmv", ".", "nhat"}], " ", "-", " ", 
        RowBox[{"nhat", 
         RowBox[{"(", 
          RowBox[{"nhat", ".", "symmv", ".", "nhat"}], ")"}]}]}], ")"}]}]}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "set", " ", "simplest", " ", "form", " ", "for", " ", "stuff", " ", 
     "right", " ", "here"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalOmega]", "/", "H"}], ")"}], "*", "r", "*", "z"}], 
       ",", "0"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"gamma", " ", "=", " ", 
     RowBox[{
      RowBox[{"Omega", "/", "gap"}], "*", "R"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "r"}], "]"}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], " ",
           "-", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "r"}], ")"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}
       }], "\[NoBreak]", ")"}]}], "  ", ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\[Theta]", " ", "is", " ", "rotation", " ", "angle", " ", "in", " ", 
      "cyl", " ", "coords"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"symmv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "+", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "-", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dont", " ", "propose", " ", "form", " ", "for", " ", "n"}], 
       ".."}], " ", "but", " ", "use", " ", "theta", " ", "derivs"}], " ", 
     "\[Rule]", " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", "nt"}], "/", "r"}], 
         RowBox[{"nr", "/", "r"}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"nr", "^", "2"}], "+", 
          RowBox[{"nt", "^", "2"}], "+", 
          RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", "1"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "here", " ", "is", " ", "switch", " ", "n", " ", "and", " ", "gradn", 
      " ", "to", " ", "phi"}], ",", " ", 
     RowBox[{"alpha", " ", "stuff"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nhat", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "/", "r"}], 
         RowBox[{
          RowBox[{"nhat", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "r"}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", "[", "\"\<Dynamics vector:\>\"", "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"solve", " ", "for", " ", "phi"}], ",", " ", 
     RowBox[{"aLph", " ", "simple", " ", "lambda", " ", "vals"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Alpha]"}], "}"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"eqs", " ", "for", " ", "stability", " ", "matrix"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phidot", "[", 
     RowBox[{
     "v_", ",", "gradn_", ",", "nhat_", ",", "antiv_", ",", "\[Lambda]_", ",",
       "symmv_", ",", "nhat_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], ")"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"phidot", "[", 
      RowBox[{
      "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
       "symmv", ",", "nhat"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphadot", "[", 
     RowBox[{
     "v_", ",", "gradn_", ",", "nhat_", ",", "antiv_", ",", "\[Lambda]_", ",",
       "symmv_", ",", "nhat_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], ")"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"alphadot", "[", 
      RowBox[{
      "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
       "symmv", ",", "nhat"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}]}
       }], "\[NoBreak]", ")"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"phi_", ",", "alph_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]},
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]}
      }], "\[NoBreak]", ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", "[", "\"\<Stability matrix: \>\"", "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"m", "[", 
       RowBox[{"\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"m", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], ",", 
       RowBox[{"-", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"-", 
          FractionBox[
           SqrtBox[
            RowBox[{"1", "+", "\[Lambda]"}]], 
           RowBox[{
            SqrtBox["2"], " ", 
            SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "-", " ", "DEFINITE"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
     " ", "STUFF", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ABOVE", " ", "--"}], "--"}], "--"}], "--"}], 
               "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
        "--"}], "--"}]}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", " ", "arbitrary"}]}]}]}], " ", "v_r", " ", "function", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stuff", " ", "--"}], "--"}], "--"}], "--"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"r", ",", "z"}], "]"}], ",", "0", ",", "0"}], "}"}]}], ";", 
    "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"just", " ", "v_r", " ", "is", " ", "to", " ", "say"}], ",", 
      " ", 
      RowBox[{"consider", " ", "just", " ", "perturb", " ", "addition"}], ",",
       " ", 
      RowBox[{"as", " ", "they", " ", "separate", " ", "cleanly"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "r"}], "]"}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], " ",
           "-", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "r"}], ")"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}
       }], "\[NoBreak]", ")"}]}], "  ", ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\[Theta]", " ", "is", " ", "rotation", " ", "angle", " ", "in", " ", 
      "cyl", " ", "coords"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", "gradv", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symmv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "+", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "-", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"nhat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nhat", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "/", "r"}], 
         RowBox[{
          RowBox[{"nhat", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "r"}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"g", " ", "\[Rule]", " ", "g"}], ",", " ", 
     RowBox[{
      RowBox[{"dg", "/", "dr"}], " ", "\[Rule]", " ", "dgdr"}], ",", " ", 
     RowBox[{"dgdz", " ", "\[Rule]", " ", "dgdz"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dnrdr", " ", "r"}], "+", 
               RowBox[{"nr", " ", 
                SuperscriptBox["nt", "2"], " ", "\[Lambda]"}]}], ")"}], " ", 
             "g"}], "r"]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "nz", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Lambda]", "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["nr", "2"], " ", "\[Lambda]"}]}], ")"}], " ", 
           "dgdz"}], "-", 
          RowBox[{"nr", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["nr", "2"]}], ")"}], " ", "\[Lambda]", " ", 
           "dgdr"}]}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dntdr", " ", "r"}], "+", 
               RowBox[{"nt", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["nt", "2"]}], ")"}], " ", "\[Lambda]"}]}], 
              ")"}], " ", "g"}], "r"]}], "-", 
          RowBox[{"nr", " ", "nt", " ", "\[Lambda]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"nz", " ", "dgdz"}], "+", 
             RowBox[{"nr", " ", "dgdr"}]}], ")"}]}]}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dnzdr", " ", "r"}], "+", 
               RowBox[{
                SuperscriptBox["nt", "2"], " ", "nz", " ", "\[Lambda]"}]}], 
              ")"}], " ", "g"}], "r"]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", "nr", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Lambda]", "-", 
                RowBox[{"2", " ", 
                 SuperscriptBox["nz", "2"], " ", "\[Lambda]"}]}], ")"}], 
              "dgdz"}], "-", 
             RowBox[{
             "2", " ", "nr", " ", "nz", " ", "\[Lambda]", " ", "dgdr"}]}], 
            ")"}]}]}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"nr", "^", "2"}], "+", 
          RowBox[{"nt", "^", "2"}], "+", 
          RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", "1"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shiftndot", "[", 
      RowBox[{"\[Alpha]_", ",", "\[Phi]_", ",", "R_"}], "]"}], " ", ":=", " ", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"r", ",", "z"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"dnrdr", " ", "r"}], "+", 
                 RowBox[{"\[Lambda]", " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], " ", 
                  RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}], ")"}]}], 
              "R"]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"\[Lambda]", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["g", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}], "+", 
               RowBox[{"\[Lambda]", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["g", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}]}], ")"}]}]}]},
          {
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"r", ",", "z"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"dntdr", " ", "r"}], "-", 
                 RowBox[{"\[Lambda]", " ", 
                  RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                  RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
                 RowBox[{"\[Lambda]", " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], "3"], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Phi]", "]"}], "3"]}]}], ")"}]}], 
              "R"]}], "-", 
            RowBox[{"\[Lambda]", " ", 
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["g", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                RowBox[{
                 SuperscriptBox["g", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}]}], ")"}]}]}]},
          {
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{"r", ",", "z"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"dnzdr", " ", "r"}], "+", 
                 RowBox[{"\[Lambda]", " ", 
                  SuperscriptBox[
                   RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], " ", 
                  RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Phi]", "]"}], "3"]}]}], ")"}]}], 
              "R"]}], "+", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Lambda]", "-", 
                  RowBox[{"2", " ", "\[Lambda]", " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Alpha]", "]"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["g", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}], "-", 
               RowBox[{"\[Lambda]", " ", 
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["g", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}]}], ")"}]}]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"shiftndot", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"-", 
           FractionBox[
            SqrtBox[
             RowBox[{"1", "+", "\[Lambda]"}]], 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox["\[Lambda]"]}]]}], "]"}]}], ",", 
        RowBox[{"Pi", "/", "2"}], ",", "r"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"shiftndot", "[", 
        RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", " ", 
       RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], "]"}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "so", " ", "this", " ", "is", " ", "large", " ", "R", " ", "leftover", 
      " ", "of", " ", "JUST", " ", "v_r", " ", "addition", " ", "to", " ", 
      "ndot"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"shiftndot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "r"}], "]"}], ".", 
            RowBox[{"D", "[", 
             RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}], ")"}], ",", "\[Phi]"}],
          "]"}], "]"}], " ", "add", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"r", ",", "z"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"r", ",", "z"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"r", ",", "z"}], "]"}], "\[Equal]", "0"}]}], "}"}], " ", 
       "to", " ", "get", " ", "0"}], ",", " ", "meaning", ",", " ", 
      RowBox[{"depends", " ", "only", " ", "on", " ", "g", " ", "existing"}], 
      ",", " ", 
      RowBox[{"of", " ", "course"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shiftphidot", "[", 
      RowBox[{"\[Alpha]_", ",", "\[Phi]_", ",", "R_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"shiftndot", "[", 
       RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shiftalphadot", "[", 
     RowBox[{"\[Alpha]_", ",", "\[Phi]_", ",", "R_"}], "]"}], " ", ":=", " ", 
    
    RowBox[{
     RowBox[{"shiftndot", "[", 
      RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shiftm", "[", 
      RowBox[{"phi_", ",", "alph_"}], "]"}], " ", ":=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftphidot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Phi]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftphidot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]},
        {
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftalphadot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Phi]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftalphadot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"shiftm", "[", 
       RowBox[{"\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"shiftm", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], ",", 
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"-", 
           FractionBox[
            SqrtBox[
             RowBox[{"1", "+", "\[Lambda]"}]], 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"shiftm", "[", 
        RowBox[{
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"-", 
            FractionBox[
             SqrtBox[
              RowBox[{"1", "+", "\[Lambda]"}]], 
             RowBox[{
              SqrtBox["2"], " ", 
              SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"MatrixForm", "[", "d", "]"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ">", "1"}], "}"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simpled", " ", "=", " ", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"3", "+", 
                   RowBox[{"2", " ", "dnzdr", " ", "r", " ", 
                    SqrtBox[
                    RowBox[{"2", "-", 
                    FractionBox["2", "\[Lambda]"]}]]}]}], ")"}], " ", 
                 "\[Lambda]"}], "+", 
                SuperscriptBox["\[Lambda]", "2"], "+", 
                RowBox[{"2", " ", 
                 SqrtBox["2"], " ", "dntdr", " ", "r", " ", 
                 SqrtBox[
                  RowBox[{"\[Lambda]", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]]}]}], ")"}], " ",
               "g"}], "-", 
             RowBox[{"2", " ", "R", " ", 
              SuperscriptBox["\[Lambda]", "2"], " ", "dgdr"}], "+", 
             SqrtBox[
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], "2"], " ", 
                  "\[Lambda]", " ", 
                  SuperscriptBox["g", "2"]}], "-", 
                 RowBox[{"4", " ", "R", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], " ", 
                  SuperscriptBox["\[Lambda]", "2"], " ", "g", " ", "dgdr"}], 
                 "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["R", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Lambda]"}], ")"}], "2"], " ", 
                    SuperscriptBox["dgdz", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["\[Lambda]", "3"], " ", 
                    SuperscriptBox["dgdr", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
            RowBox[{"4", " ", "R", " ", "\[Lambda]"}]]}], "0"},
         {"0", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"3", "+", 
                   RowBox[{"2", " ", "dnzdr", " ", "r", " ", 
                    SqrtBox[
                    RowBox[{"2", "-", 
                    FractionBox["2", "\[Lambda]"]}]]}]}], ")"}], " ", 
                 "\[Lambda]"}], "+", 
                SuperscriptBox["\[Lambda]", "2"], "+", 
                RowBox[{"2", " ", 
                 SqrtBox["2"], " ", "dntdr", " ", "r", " ", 
                 SqrtBox[
                  RowBox[{"\[Lambda]", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]]}]}], ")"}]}], 
             " ", "g"}], "+", 
            RowBox[{"2", " ", "R", " ", 
             SuperscriptBox["\[Lambda]", "2"], " ", "dgdr"}], "+", 
            SqrtBox[
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], "2"], " ", 
                 "\[Lambda]", " ", 
                 SuperscriptBox["g", "2"]}], "-", 
                RowBox[{"4", " ", "R", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], " ", 
                 SuperscriptBox["\[Lambda]", "2"], " ", "g", " ", "dgdr"}], 
                "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["R", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Lambda]"}], ")"}], "2"], " ", 
                    SuperscriptBox["dgdz", "2"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["\[Lambda]", "3"], " ", 
                    SuperscriptBox["dgdr", "2"]}]}], ")"}]}]}], ")"}]}]]}], 
           RowBox[{"4", " ", "R", " ", "\[Lambda]"}]]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"simple", " ", "refers", " ", "to"}], "..."}], ".."}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Limit", "[", 
      RowBox[{"simpled", ",", 
       RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", " ", "arbitrary"}]}]}]}], " ", "v_theta", " ", 
     "function", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"stuff", " ", "--"}], "--"}], "--"}], "--"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"f", "[", 
        RowBox[{"r", ",", "z"}], "]"}], ",", "0"}], "}"}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"just", " ", "v_r", " ", "is", " ", "to", " ", "say"}], ",", 
      " ", 
      RowBox[{"consider", " ", "just", " ", "perturb", " ", "addition"}], ",",
       " ", 
      RowBox[{"as", " ", "they", " ", "separate", " ", "cleanly"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "r"}], "]"}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], " ",
           "-", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "r"}], ")"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}
       }], "\[NoBreak]", ")"}]}], "  ", ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "\[Theta]", " ", "is", " ", "rotation", " ", "angle", " ", "in", " ", 
      "cyl", " ", "coords"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", "gradv", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symmv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "+", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "-", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"nhat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nhat", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "/", "r"}], 
         RowBox[{
          RowBox[{"nhat", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "r"}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shiftndot", "[", 
      RowBox[{"\[Alpha]_", ",", "\[Phi]_", ",", "R_"}], "]"}], " ", ":=", " ", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "R"}], " ", "\[Lambda]", " ", 
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["f", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"\[Lambda]", " ", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"r", ",", "z"}], "]"}], "-", 
                  RowBox[{"R", "*", 
                   RowBox[{
                    SuperscriptBox["f", 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                    MultilineFunction->None], "[", 
                    RowBox[{"r", ",", "z"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
            RowBox[{"2", " ", "R"}]]},
          {
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "-", "\[Lambda]", "+", 
                RowBox[{"2", " ", "\[Lambda]", " ", 
                 SuperscriptBox[
                  RowBox[{"Cos", "[", "\[Alpha]", "]"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", 
                 RowBox[{"f", "[", 
                  RowBox[{"r", ",", "z"}], "]"}]}], "+", 
                RowBox[{"R", " ", 
                 RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{
                  SuperscriptBox["f", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"r", ",", "z"}], "]"}]}], "+", 
                RowBox[{"R", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
                 RowBox[{
                  SuperscriptBox["f", 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                    Derivative],
                   MultilineFunction->None], "[", 
                  RowBox[{"r", ",", "z"}], "]"}]}]}], ")"}]}], 
             RowBox[{"2", " ", "R"}]]}]},
          {
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Lambda]", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"r", ",", "z"}], "]"}], " ", 
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Lambda]", "-", 
                  RowBox[{"2", " ", "\[Lambda]", " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Alpha]", "]"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}], ")"}], " ", 
                RowBox[{
                 SuperscriptBox["f", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"0", ",", "1"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}], "-", 
               RowBox[{"R", " ", "\[Lambda]", " ", 
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
                RowBox[{
                 SuperscriptBox["f", 
                  TagBox[
                   RowBox[{"(", 
                    RowBox[{"1", ",", "0"}], ")"}],
                   Derivative],
                  MultilineFunction->None], "[", 
                 RowBox[{"r", ",", "z"}], "]"}]}]}], ")"}]}], 
            RowBox[{"2", " ", "R"}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        Column], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"shiftndot", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"-", 
           FractionBox[
            SqrtBox[
             RowBox[{"1", "+", "\[Lambda]"}]], 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox["\[Lambda]"]}]]}], "]"}]}], ",", 
        RowBox[{"Pi", "/", "2"}], ",", "r"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Limit", "[", 
       RowBox[{
        RowBox[{"shiftndot", "[", 
         RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", " ", 
        RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], "]"}], "]"}], ";", 
    "  ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "so", " ", "this", " ", "is", " ", "large", " ", "R", " ", "leftover", 
      " ", "of", " ", "JUST", " ", "general", " ", "v_theta", " ", "addition",
       " ", "to", " ", "ndot"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shiftphidot", "[", 
      RowBox[{"\[Alpha]_", ",", "\[Phi]_", ",", "R_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"shiftndot", "[", 
       RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shiftalphadot", "[", 
     RowBox[{"\[Alpha]_", ",", "\[Phi]_", ",", "R_"}], "]"}], " ", ":=", " ", 
    
    RowBox[{
     RowBox[{"shiftndot", "[", 
      RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shiftm", "[", 
      RowBox[{"phi_", ",", "alph_"}], "]"}], " ", ":=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftphidot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Phi]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftphidot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]},
        {
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftalphadot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Phi]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"shiftalphadot", "[", 
             RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "R"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"shiftm", "[", 
       RowBox[{"\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"shiftm", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], ",", 
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"-", 
           FractionBox[
            SqrtBox[
             RowBox[{"1", "+", "\[Lambda]"}]], 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", " ", "=", " ", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"shiftm", "[", 
        RowBox[{
         RowBox[{"Pi", "/", "2"}], ",", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"-", 
            FractionBox[
             SqrtBox[
              RowBox[{"1", "+", "\[Lambda]"}]], 
             RowBox[{
              SqrtBox["2"], " ", 
              SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"MatrixForm", "[", "d", "]"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]", ">", "1"}], ",", " ", 
        RowBox[{"r", "\[Equal]", "R"}], ",", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"r_", ",", "z_"}], "]"}], " ", ":=", " ", 
         RowBox[{"r", "*", "z"}]}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8266752799540854`*^9, 3.8266753071948223`*^9}, {
   3.826675664843732*^9, 3.8266756901798983`*^9}, {3.826675869053034*^9, 
   3.826675988497328*^9}, {3.82667603722441*^9, 3.826676268554097*^9}, {
   3.826676384735524*^9, 3.826676431675276*^9}, {3.8266765121851597`*^9, 
   3.8266767612926903`*^9}, {3.826676820305739*^9, 3.826676985177932*^9}, {
   3.826677026541018*^9, 3.8266770738015623`*^9}, {3.826677109504314*^9, 
   3.8266771184989862`*^9}, {3.826677153028069*^9, 3.826677178498794*^9}, {
   3.826677219719841*^9, 3.826677297141605*^9}, {3.826677356180641*^9, 
   3.82667740141089*^9}, {3.826677453720838*^9, 3.826677610289278*^9}, {
   3.8266850741666937`*^9, 3.826685104498743*^9}, {3.8266851585717897`*^9, 
   3.826685177385954*^9}, {3.8266867655545053`*^9, 3.8266867949417677`*^9}, {
   3.8266868269174747`*^9, 3.8266869441441183`*^9}, {3.826686993526887*^9, 
   3.8266870852828503`*^9}, {3.826687187078718*^9, 3.8266874311784678`*^9}, {
   3.8266874718308353`*^9, 3.826687512579859*^9}, {3.8266875732310534`*^9, 
   3.826687581565832*^9}, {3.82668779224944*^9, 3.826687926275687*^9}, {
   3.826687983236977*^9, 3.8266880629178*^9}, {3.826688100172669*^9, 
   3.826688203820545*^9}, {3.82668828038172*^9, 3.8266883937544727`*^9}, {
   3.826688440129004*^9, 3.8266884439559813`*^9}, {3.826688488348743*^9, 
   3.826688545842688*^9}, {3.8266887128364487`*^9, 3.8266887460881987`*^9}, {
   3.8266887763351717`*^9, 3.826688784396687*^9}, {3.8266888253648243`*^9, 
   3.8266888337491283`*^9}, {3.826688877385788*^9, 3.826688884598859*^9}, {
   3.8266889741716213`*^9, 3.826689009699057*^9}, {3.8266902857176867`*^9, 
   3.8266903066340837`*^9}, {3.826697617996537*^9, 3.8266976324928637`*^9}, {
   3.826697687785988*^9, 3.826697793666182*^9}, {3.826697833961116*^9, 
   3.826697940399906*^9}, {3.8266981065181713`*^9, 3.826698151825027*^9}, {
   3.8266981836610203`*^9, 3.826698186648077*^9}, {3.826698325071155*^9, 
   3.8266983781926517`*^9}, {3.826698413513307*^9, 3.826698502122808*^9}, 
   3.826849042072997*^9, {3.826849084035697*^9, 3.826849102433227*^9}, {
   3.8268491360807333`*^9, 3.826849218269122*^9}, {3.826849275660131*^9, 
   3.8268492790226383`*^9}, {3.826849312667118*^9, 3.826849314199774*^9}, {
   3.826849378934092*^9, 3.8268493892303534`*^9}, 3.826849426204302*^9, {
   3.8268494627770653`*^9, 3.8268494796039143`*^9}, {3.826849669814518*^9, 
   3.826849787626096*^9}, {3.826851651265483*^9, 3.826851718933124*^9}, {
   3.826851759340425*^9, 3.8268517881026087`*^9}, {3.826851931225995*^9, 
   3.826851960141914*^9}, {3.826851990812619*^9, 3.826852035255816*^9}, {
   3.8268520674348*^9, 3.826852070711692*^9}, {3.826852246335545*^9, 
   3.826852303030847*^9}, 3.826852379100375*^9, {3.826852685582899*^9, 
   3.826852686287402*^9}, {3.826852758154278*^9, 3.82685281802089*^9}, {
   3.8268530193873453`*^9, 3.8268531262635517`*^9}, {3.826853174522757*^9, 
   3.826853185170986*^9}, {3.826853237171986*^9, 3.8268533100304613`*^9}, {
   3.82685334633039*^9, 3.82685340885181*^9}, {3.8268534660204773`*^9, 
   3.8268534706678247`*^9}, {3.8268535391953573`*^9, 3.826853583876688*^9}, {
   3.8268582864023943`*^9, 3.826858361399314*^9}, {3.826858402084729*^9, 
   3.826858402213182*^9}, {3.8268584354962177`*^9, 3.826858437238428*^9}, {
   3.826858476305705*^9, 3.826858537086557*^9}, 3.826858594237236*^9, {
   3.826858642199092*^9, 3.8268587037224607`*^9}, {3.826858801720055*^9, 
   3.826858802208788*^9}, {3.827463748292818*^9, 3.827463797668681*^9}, {
   3.827509448827282*^9, 3.8275094750737667`*^9}, 3.8279823141465*^9, {
   3.827982352315975*^9, 3.827982354943056*^9}, {3.82798342758034*^9, 
   3.8279834483430653`*^9}, {3.827983500329693*^9, 3.82798361577477*^9}, {
   3.827983651145262*^9, 3.8279836732578487`*^9}, 3.828061535851241*^9, {
   3.8280618597332993`*^9, 3.828061870981382*^9}, 3.8280619738464117`*^9, {
   3.828062186829857*^9, 3.828062199846595*^9}, 3.828062242065627*^9, {
   3.828062329493493*^9, 3.828062384960328*^9}, {3.8280625842047977`*^9, 
   3.828062610583666*^9}, {3.82806367723635*^9, 3.828063742219535*^9}, {
   3.828063802003001*^9, 3.828063826477655*^9}, {3.828063878946217*^9, 
   3.828063896042923*^9}, {3.828064939127571*^9, 3.828065091628007*^9}, {
   3.828065277393334*^9, 3.8280652814545507`*^9}, {3.8280691621473217`*^9, 
   3.828069189946616*^9}, {3.8280699862689734`*^9, 3.8280702517054863`*^9}, {
   3.828070301037059*^9, 3.828070410736566*^9}, {3.828070449071154*^9, 
   3.828070469509294*^9}, {3.8280705043725367`*^9, 3.828070690582553*^9}, {
   3.8280707539644413`*^9, 3.828070852652205*^9}, {3.8280720467898417`*^9, 
   3.82807214395755*^9}, {3.828072186859428*^9, 3.828072376240749*^9}, {
   3.828072416929453*^9, 3.8280726197535*^9}, {3.828072679993044*^9, 
   3.828072701508692*^9}, {3.828072754303526*^9, 3.82807296668894*^9}, 
   3.8280730249088173`*^9, {3.82807315276042*^9, 3.828073200389824*^9}, {
   3.8280732563528557`*^9, 3.8280733240717793`*^9}, {3.828073364193123*^9, 
   3.828073508370653*^9}, 3.8280735405725307`*^9, {3.82807360252912*^9, 
   3.828073607900588*^9}, {3.8280736532972403`*^9, 3.828073835038212*^9}, {
   3.828073922994327*^9, 3.8280739705954514`*^9}, {3.8280740224978247`*^9, 
   3.8280740287597523`*^9}, {3.8280740840865183`*^9, 3.828074095336207*^9}, {
   3.8280741275250063`*^9, 3.828074153269123*^9}, {3.828074184667466*^9, 
   3.828074220395521*^9}, {3.8280742521310577`*^9, 3.8280743743138742`*^9}, {
   3.8280744293098783`*^9, 3.828074491118881*^9}, {3.828074527006485*^9, 
   3.828074528707436*^9}, {3.8280746159730797`*^9, 3.8280746953401117`*^9}, {
   3.828074732950632*^9, 
   3.828074743381495*^9}},ExpressionUUID->"2a6caf09-dd25-47bc-9d77-\
ea3c64666733"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"r", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Lambda]"}]], " ", 
         SqrtBox[
          RowBox[{"1", "+", "\[Lambda]"}]], " ", "\[CapitalOmega]"}], 
        RowBox[{"2", " ", "H"}]]}], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"r", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Lambda]"}]], " ", 
         SqrtBox[
          RowBox[{"1", "+", "\[Lambda]"}]], " ", "\[CapitalOmega]"}], "H"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.828070140310543*^9, 3.8280701786629133`*^9, {3.828070244233568*^9, 
   3.828070257582015*^9}, {3.8280703887004843`*^9, 3.828070418424597*^9}, {
   3.828070449457386*^9, 3.828070471746132*^9}, {3.828070629327873*^9, 
   3.8280706911239567`*^9}, {3.828070727077384*^9, 3.8280707888306427`*^9}, 
   3.8280708551466722`*^9, 3.8280720656903133`*^9, 3.8280724907576036`*^9, {
   3.8280725308914547`*^9, 3.828072550122813*^9}, {3.828072588173624*^9, 
   3.828072610899715*^9}, 3.8280727022450647`*^9, {3.828072758018154*^9, 
   3.8280727915583363`*^9}, 3.828072825602887*^9, {3.8280729539106493`*^9, 
   3.82807296710102*^9}, 3.828073025259406*^9, 3.828073245800374*^9, {
   3.828073280770952*^9, 3.8280732938451366`*^9}, 3.828073324740325*^9, 
   3.8280733913435926`*^9, {3.828073477032115*^9, 3.828073510111402*^9}, 
   3.8280735411583633`*^9, 3.828073608634801*^9, 3.8280736781151752`*^9, {
   3.828073717382348*^9, 3.828073736333943*^9}, {3.8280737797026243`*^9, 
   3.82807383575033*^9}, {3.828073945081028*^9, 3.8280739722113047`*^9}, 
   3.828074031042789*^9, 3.8280740959880667`*^9, {3.82807413598098*^9, 
   3.828074153792595*^9}, {3.828074185811778*^9, 3.82807422099492*^9}, {
   3.8280742527499847`*^9, 3.82807427226997*^9}, {3.8280743067656307`*^9, 
   3.828074374810569*^9}, {3.828074440965107*^9, 3.828074493750298*^9}, 
   3.828074530001266*^9, {3.8280746206132183`*^9, 3.8280746964048653`*^9}},
 CellLabel->
  "Out[3009]//MatrixForm=",ExpressionUUID->"ac50be20-2ff7-49b8-ae98-\
b4f2917aecfb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Lambda]"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            SuperscriptBox["R", "2"], " ", 
            SqrtBox[
             RowBox[{"1", "+", "\[Lambda]"}]]}], "+", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["R", "4"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]]}], ")"}]}], 
        RowBox[{"4", " ", "R"}]]}], "0"},
     {"0", 
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Lambda]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["R", "2"], " ", 
           SqrtBox[
            RowBox[{"1", "+", "\[Lambda]"}]]}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["R", "4"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Lambda]"}], ")"}]}]]}], ")"}]}], 
       RowBox[{"4", " ", "R"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.828070140310543*^9, 3.8280701786629133`*^9, {3.828070244233568*^9, 
   3.828070257582015*^9}, {3.8280703887004843`*^9, 3.828070418424597*^9}, {
   3.828070449457386*^9, 3.828070471746132*^9}, {3.828070629327873*^9, 
   3.8280706911239567`*^9}, {3.828070727077384*^9, 3.8280707888306427`*^9}, 
   3.8280708551466722`*^9, 3.8280720656903133`*^9, 3.8280724907576036`*^9, {
   3.8280725308914547`*^9, 3.828072550122813*^9}, {3.828072588173624*^9, 
   3.828072610899715*^9}, 3.8280727022450647`*^9, {3.828072758018154*^9, 
   3.8280727915583363`*^9}, 3.828072825602887*^9, {3.8280729539106493`*^9, 
   3.82807296710102*^9}, 3.828073025259406*^9, 3.828073245800374*^9, {
   3.828073280770952*^9, 3.8280732938451366`*^9}, 3.828073324740325*^9, 
   3.8280733913435926`*^9, {3.828073477032115*^9, 3.828073510111402*^9}, 
   3.8280735411583633`*^9, 3.828073608634801*^9, 3.8280736781151752`*^9, {
   3.828073717382348*^9, 3.828073736333943*^9}, {3.8280737797026243`*^9, 
   3.82807383575033*^9}, {3.828073945081028*^9, 3.8280739722113047`*^9}, 
   3.828074031042789*^9, 3.8280740959880667`*^9, {3.82807413598098*^9, 
   3.828074153792595*^9}, {3.828074185811778*^9, 3.82807422099492*^9}, {
   3.8280742527499847`*^9, 3.82807427226997*^9}, {3.8280743067656307`*^9, 
   3.828074374810569*^9}, {3.828074440965107*^9, 3.828074493750298*^9}, 
   3.828074530001266*^9, {3.8280746206132183`*^9, 3.828074667515645*^9}, 
   3.828074699289847*^9},
 CellLabel->
  "Out[3041]//MatrixForm=",ExpressionUUID->"9bc4a1d1-eb45-4b78-8a71-\
7cb5022f9c47"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.828072841438545*^9, 
  3.8280728414405203`*^9}},ExpressionUUID->"c642ef02-0b59-4b55-964d-\
a3eed579ef42"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8280649474793797`*^9, 
  3.828064947480178*^9}},ExpressionUUID->"61baf267-18d9-477a-9a25-\
6ea11e56ba48"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.828062573980013*^9, 
  3.828062573980753*^9}},ExpressionUUID->"3f4d8458-445e-48c1-957b-\
c7069e4410a1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.828062571311763*^9, 
  3.828062571312564*^9}},ExpressionUUID->"80f8772b-57cd-4245-9d2e-\
ae0e32ecd3a5"]
},
WindowSize->{1436, 778},
WindowMargins->{{0, Automatic}, {23, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b710506f-046f-43d5-95f5-112a4c25cdc3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 65960, 1710, 3338, "Input",ExpressionUUID->"2a6caf09-dd25-47bc-9d77-ea3c64666733"],
Cell[66543, 1734, 2545, 55, 80, "Output",ExpressionUUID->"ac50be20-2ff7-49b8-ae98-b4f2917aecfb"],
Cell[69091, 1791, 3136, 75, 96, "Output",ExpressionUUID->"9bc4a1d1-eb45-4b78-8a71-7cb5022f9c47"]
}, Open  ]],
Cell[72242, 1869, 154, 3, 30, InheritFromParent,ExpressionUUID->"c642ef02-0b59-4b55-964d-a3eed579ef42"],
Cell[72399, 1874, 154, 3, 30, "Input",ExpressionUUID->"61baf267-18d9-477a-9a25-6ea11e56ba48"],
Cell[72556, 1879, 152, 3, 30, "Input",ExpressionUUID->"3f4d8458-445e-48c1-957b-c7069e4410a1"],
Cell[72711, 1884, 152, 3, 30, "Input",ExpressionUUID->"80f8772b-57cd-4245-9d2e-ae0e32ecd3a5"]
}
]
*)


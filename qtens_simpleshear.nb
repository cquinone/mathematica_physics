(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45561,       1295]
NotebookOptionsPosition[     44785,       1275]
NotebookOutlinePosition[     45181,       1291]
CellTagsIndexPosition[     45138,       1288]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckRow", "[", "vec_", "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "vec", "]"}], "<", "2"}], ",", " ", 
     RowBox[{"Transpose", "[", "vec", "]"}], ",", " ", "vec"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VecOuter", "[", 
     RowBox[{"vec1_", ",", "vec2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatOuter", "[", 
     RowBox[{"mat1_", ",", "mat2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "1"}], "]"}], ",",
               "2"}], "]"}], ",", "1"}], "]"}], ",", "2"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "1"}], "]"}], ",",
               "3"}], "]"}], ",", "1"}], "]"}], ",", "3"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "2"}], "]"}], ",",
               "2"}], "]"}], ",", "2"}], "]"}], ",", "2"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "2"}], "]"}], ",",
               "3"}], "]"}], ",", "2"}], "]"}], ",", "3"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "3"}], "]"}], ",",
               "2"}], "]"}], ",", "3"}], "]"}], ",", "2"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "3"}], "]"}], ",",
               "3"}], "]"}], ",", "3"}], "]"}], ",", "3"}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "*", "y"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradv", " ", "=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}]},
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}]},
       {
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "x"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "y"}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}
      }], "\[NoBreak]", ")"}]}], "  ", ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"Transpose", "[", "gradv", "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nhat", " ", "=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]},
       {
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]},
       {
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}
      }], "\[NoBreak]", ")"}]}], ";", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"nx", " ", "\[Rule]", " ", 
      RowBox[{"cos", 
       RowBox[{"(", "phi", ")"}]}]}], ",", " ", 
     RowBox[{"so", " ", "like", " ", "old", " ", "nz"}], ",", " ", 
     RowBox[{
     "then", " ", "nt", " ", "and", " ", "nz", " ", "are", " ", "alpha", " ", 
      "ones"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"nhat", " ", "=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"nx"},
       {"ny"},
       {"nz"}
      }], "\[NoBreak]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ident", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmv", " ", "=", 
   RowBox[{"(", 
    RowBox[{"gradv", "+", 
     RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"ACTUALLY", " ", "D", "*", 
    RowBox[{"2", "!!"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"qtens", "[", "nhat_", "]"}], " ", ":=", " ", 
   RowBox[{"s", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"VecOuter", "[", 
       RowBox[{
        RowBox[{"CheckRow", "[", "nhat", "]"}], ",", 
        RowBox[{"CheckRow", "[", "nhat", "]"}]}], "]"}], "-", 
      RowBox[{"ident", "/", "3"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"qtens", "[", "nhat", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "functions", " ", "of", " ", "above", " ", "variables"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"u_", ",", "s_", ",", " ", "d_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "6"}], "*", "d", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"u", "/", "3"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"u", "/", "3"}], ")"}], "*", "s"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "/", "3"}], ")"}], "*", "u", "*", 
       RowBox[{"s", "^", "2"}]}]}], ")"}]}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "3"}], ")"}], 
     RowBox[{"(", "symmv", ")"}]}], " ", "+", " ", 
    RowBox[{"gradv", ".", "q"}], " ", "+", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"gradv", ".", "q"}], "]"}], " ", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}], "*", "ident", "*", 
     RowBox[{"(", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"MatOuter", "[", 
         RowBox[{"gradv", ",", "q"}], "]"}], ",", "Infinity"}], "]"}], 
      ")"}]}], " ", "-", " ", 
    RowBox[{"2", "*", "q", "*", 
     RowBox[{"(", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"MatOuter", "[", 
         RowBox[{"gradv", ",", "q"}], "]"}], ",", "Infinity"}], "]"}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", " ", "=", " ", 
    RowBox[{"q", "*", 
     RowBox[{"h", "[", 
      RowBox[{"U", ",", "s", ",", "D"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "/", "2"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "nhat", "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"f", ".", "nhat"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Transpose", "[", "nhat", "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"g", ".", "nhat"}], ")"}]}]}], ")"}]}], "]"}], "   ", 
     "this", " ", "is", " ", 
     RowBox[{"(", 
      RowBox[{"3", "/", "2"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"n", " ", "dot", " ", 
       RowBox[{"(", 
        RowBox[{"f", " ", "+", " ", "g"}], ")"}], " ", "dot", " ", "n"}], 
      ")"}]}], ",", " ", 
    RowBox[{"same", " ", "as", " ", "other", " ", 
     RowBox[{"sdot", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndot", "[", 
   RowBox[{"s_", ",", "q_", ",", "nhat_", ",", "g_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "s"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"g", ".", "nhat"}], ")"}]}], " ", "-", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"s", "^", "2"}]}], ")"}], "*", "nhat", "*", 
    RowBox[{"Tr", "[", 
     RowBox[{"q", ".", "g"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sdot", "[", 
     RowBox[{"s_", ",", "q_", ",", "f_", ",", "g_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "/", 
       RowBox[{"(", 
        RowBox[{"2", "s"}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"q", ".", "f"}], "]"}], " ", "+", " ", 
       RowBox[{"Tr", "[", 
        RowBox[{"q", ".", "g"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "6"}], "D", "*", "s"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", "s"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", "*", "r", "*", "nt", "*", "nz"}], " ", "+", " ", 
        RowBox[{"2", "*", "D", "*", "s", "*", "U"}]}], ")"}]}]}], " ", "=", 
    " ", "sdot"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"ndot", "[", 
     RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"nx", "^", "2"}], " ", "+", " ", 
      RowBox[{"ny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", " ", "1"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"sdot", "[", 
     RowBox[{"s", ",", "q", ",", "f", ",", "g"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"nx", "^", "2"}], " ", "+", " ", 
      RowBox[{"ny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", " ", "1"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nsols", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"nx", "^", "2"}], " ", "+", " ", 
        RowBox[{"ny", "^", "2"}], "+", 
        RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", "1"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nsols", " ", "=", " ", 
     RowBox[{"Quiet", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ndot", "[", 
            RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"ndot", "[", 
            RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"ndot", "[", 
            RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "\[Alpha]"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "s"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"q", "*", 
          RowBox[{"h", "[", 
           RowBox[{"U", ",", 
            RowBox[{
             RowBox[{"1", "/", "4"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"3", "/", "4"}], ")"}], "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{"8", "/", 
                  RowBox[{"(", 
                   RowBox[{"3", "U"}], ")"}]}], ")"}]}], "]"}]}]}], ",", 
            "D"}], "]"}]}], " ", ")"}], ".", "nhat"}], " ", "+", " ", 
       RowBox[{"g", ".", "nhat"}]}], ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"nx", "^", "2"}], "+", 
      RowBox[{"ny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nz", "^", "2"}]}], "\[Equal]", " ", "1"}]}], "]"}], ";", "  ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", 
     RowBox[{"ds", "/", "dt"}]}], "=", 
    RowBox[{"0", " ", "version", " ", "of", " ", "nhat", " ", "dot"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "/", 
       RowBox[{"(", 
        RowBox[{"2", "s"}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{"q", ".", "f"}], "]"}], " ", "+", " ", 
       RowBox[{"Tr", "[", 
        RowBox[{"q", ".", "g"}], "]"}]}], ")"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"nx", "^", "2"}], "+", 
      RowBox[{"ny", "^", "2"}], " ", "+", " ", 
      RowBox[{"nz", "^", "2"}]}], "\[Equal]", " ", "1"}]}], "]"}], ";", "  ", 
  
  RowBox[{"(*", " ", 
   RowBox[{"pure", " ", 
    RowBox[{"ds", "/", "dt"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "s"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"g", ".", "nhat"}], ")"}]}], " ", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"s", "^", "2"}]}], ")"}], "*", "nhat", "*", 
       RowBox[{"Tr", "[", 
        RowBox[{"q", ".", "g"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"nx", "^", "2"}], "+", 
       RowBox[{"ny", "^", "2"}], " ", "+", " ", 
       RowBox[{"nz", "^", "2"}]}], "\[Equal]", " ", "1"}]}], " ", "]"}], 
   "]"}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "nhat", " ", "dot", " ", "using", " ", 
    "rearrangement", " ", "of", " ", "sdot"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "6"}], " ", "D", " ", "s"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "s"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dvdx", "*", "nx", "*", "ny"}], " ", "+", " ", 
         RowBox[{"2", " ", "D", " ", "s", " ", "U"}]}], ")"}]}]}], "\[Equal]",
      "0"}], ",", 
    RowBox[{"{", "s", "}"}]}], "]"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "6"}], " ", "D", " ", "s"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "D", " ", "s", " ", "U"}], ")"}]}]}], "\[Equal]", 
      "0"}], ",", 
     RowBox[{"{", "s", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"particular", " ", "solve", " ", "for", " ", "sdot"}], ",", " ", 
    RowBox[{"so", " ", "just", " ", "minimums", " ", "of", " ", "f"}], ",", 
    " ", 
    RowBox[{
    "log", " ", "rolling", " ", "gives", " ", "you", " ", "the", " ", "old", 
     " ", "non", " ", "flow", " ", "sols"}], ",", " ", 
    RowBox[{"this", " ", "makes", " ", 
     RowBox[{"snese", "?", " ", "ignores"}], " ", "affect", " ", "of", " ", 
     "flow"}], ",", ".."}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"now", " ", "stability"}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phidot", "[", 
    RowBox[{"s_", ",", "\[Phi]_", ",", "\[Alpha]_"}], "]"}], " ", ":=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ndot", "[", 
          RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ndot", "[", 
          RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ndot", "[", 
          RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"phidot", "[", 
     RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphadot", "[", 
    RowBox[{"s_", ",", "\[Phi]_", ",", "\[Alpha]_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ndot", "[", 
          RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ndot", "[", 
          RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ndot", "[", 
          RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"alphadot", "[", 
     RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phidot", "[", 
   RowBox[{"k_", ",", "s_", ",", "\[Phi]_", ",", "\[Alpha]_"}], "]"}], " ", ":=",
   " ", 
  FractionBox[
   RowBox[{"k", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "s"}], ")"}], " ", 
    RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
   RowBox[{"3", " ", "s"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphadot", "[", 
    RowBox[{"k_", ",", "s_", ",", "\[Phi]_", ",", "\[Alpha]_"}], "]"}], " ", ":=",
    " ", 
   FractionBox[
    RowBox[{"k", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", "s"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "s"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], 
    RowBox[{"6", " ", "s"}]]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"phi_", ",", "alph_", ",", "order_"}], "]"}], ":=", " ", 
    RowBox[{"(", "\[NoBreak]\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"k", ",", "s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], 
           ",", "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}], "\[NoBreak]"}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"k", ",", "s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], 
           ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]},
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"k", ",", "s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], 
           ",", "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"k", ",", "s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], 
           ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]}
      }], ")"}]}], " ", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "stability", " ", "matrix", " ", "assuming", " ", "s", " ", "constant"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"m", "[", 
      RowBox[{"\[Phi]", ",", "\[Alpha]", ",", "s"}], "]"}], "]"}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Eigensystem", "[", 
     RowBox[{"m", "[", 
      RowBox[{
       FractionBox["\[Pi]", "2"], ",", 
       RowBox[{"ArcCos", "[", 
        FractionBox[
         SqrtBox[
          RowBox[{"1", "-", "s"}]], 
         SqrtBox[
          RowBox[{"2", "+", "s"}]]], "]"}], ",", "s"}], "]"}], "]"}], ";"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
  "(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"for", " ", "shear", " ", "flow"}], ",", " ", 
    RowBox[{"spatial", " ", "stuff", " ", "in", " ", "velocity"}], ",", " ", 
    RowBox[{
    "but", " ", "removed", "\[IndentingNewLine]", "by", " ", "gradient"}], 
    ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "BUT", " ", "also", " ", "spatial", " ", "stuff", " ", "in", " ", 
        "advection"}], " ", "-", " ", 
       RowBox[{"unless", " ", "you", " ", "say", " ", 
        RowBox[{"no", "?", " ", "\"\<only in shear plane\>\""}]}]}], " ", 
      "..."}], "\[IndentingNewLine]", "only", " ", "in", " ", "shear", " ", 
     "plane", " ", "is", "  ", "solution"}], ",", " ", 
    RowBox[{
    "but", " ", "graient", " ", "of", " ", "n", " ", "would", " ", "sya", " ",
      "that", " ", "you", " ", "have", " ", "some", " ", "natural", " ", 
     "variation", "\[IndentingNewLine]", "\[IndentingNewLine]", "In", " ", 
     "Qtens", " ", "form"}], ",", " ", 
    RowBox[{"dont", " ", 
     RowBox[{"(", 
      RowBox[{"or", " ", "do", 
       RowBox[{"??", "?"}]}], ")"}], " ", "have", " ", "the", " ", "same", 
     " ", "graident", " ", "thing"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "but", " ", "anyway", " ", "spatial", " ", "stuff", " ", "removed", " ",
        "in", " ", "gradient", "\[IndentingNewLine]", "so", " ", "it", " ", 
       "works", " ", "out", " ", "that", " ", "way"}], "..."}], " ", "shear", 
     " ", "seems", " ", "unfair", " ", "as", " ", "for", " ", 
     "\"\<interesting\>\"", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "for", " ", "rad", " ", 
     "flow"}], ",", " ", 
    RowBox[{
    "\"\<more\>\"", " ", "spatial", " ", "stuff", " ", "in", " ", "v"}], ",", 
    " ", 
    RowBox[{"and", " ", "survives", " ", "in", " ", "grad", " ", "v"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
     "so", " ", "this", " ", "could", " ", "trickle", " ", "on", " ", "down", 
      " ", "to", " ", "director", "\[IndentingNewLine]", 
      RowBox[{"BUT", "!"}], " ", "deleted"}], " ", "\[Rule]", " ", 
     RowBox[{
     "now", " ", "including", " ", "the", " ", "advective", " ", "term"}]}], 
    ",", " ", 
    RowBox[{
    "not", " ", "actually", " ", "asking", " ", "for", " ", "spatial", " ", 
     "homogenity"}], ",", " ", 
    RowBox[{
    "gives", " ", "you", " ", "a", " ", "homogeneous", " ", "solution"}], ",",
     " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"omega", ".", "n"}]}], " ", "+", " ", 
      RowBox[{"v", ".", 
       RowBox[{"gradn", " ", "--"}]}]}], ">", " ", 
     RowBox[{
      RowBox[{"0", "?", " ", "or"}], " ", 
      RowBox[{"D", " ", "~", " ", "0"}]}]}], ",", " ", 
    RowBox[{"from", " ", "linear", " ", "v", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "*", "r"}], ")"}], "?", " ", "and"}], " ", "then", " ", 
     "what", " ", "keeps", " ", "it", " ", "in", " ", "the", " ", "plane", 
     " ", "is", " ", "resulting", " ", "toqrue", " ", "that", " ", "says", 
     " ", "NO", " ", "to", " ", "into", " ", "z", " ", "stuff", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "in", " ", "Qtens", " ", 
     "form"}], ",", " ", 
    RowBox[{
    "leaving", " ", "out", " ", "grad", " ", "q", " ", "gives", " ", 
     "tilting", " ", "stuff"}], ",", " ", 
    RowBox[{"so", " ", "the", " ", "conjugate", " ", 
     RowBox[{"omega", ".", "n"}], " ", "part", " ", "here", " ", "is", " ", 
     "left", " ", "to", " ", "its", " ", "own", " ", 
     RowBox[{"devices", "?", " ", "but"}], " ", "themn", " ", "even", " ", 
     "including", " ", "advection", " ", "is", " ", "to", " ", "include", " ",
      "different", " ", "kind", " ", "of", " ", "term", " ", "and", " ", 
     "\"\<survives\>\""}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symmv", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"gradv", "+", 
      RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiv", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"gradv", "-", 
      RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"altn", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"nhat", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Lambda]", "*", 
         RowBox[{"(", "symmv", ")"}]}], " ", "-", " ", 
        RowBox[{"(", "antiv", ")"}]}], ")"}], ".", "nhat"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"altn", ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"nx", "^", "2"}], "+", 
       RowBox[{"ny", "^", "2"}], " ", "+", " ", 
       RowBox[{"nz", "^", "2"}]}], "\[Equal]", " ", "1"}]}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "nx", " ", "nz", " ", 
       RowBox[{"(", 
        RowBox[{"k", "-", 
         RowBox[{"k", " ", "\[Lambda]"}]}], ")"}]}], "\[Equal]", "0"}], "&&", 
     
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "k", " ", "ny", " ", "nz", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]"}], ")"}]}], "\[Equal]", "0"}], "&&", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          SuperscriptBox["nz", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Lambda]"}], ")"}]}], "+", "\[Lambda]", "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["ny", "2"], " ", "\[Lambda]"}]}], ")"}]}], 
      "\[Equal]", "0"}], "&&", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"nx", "^", "2"}], "+", 
       RowBox[{"ny", "^", "2"}], " ", "+", " ", 
       RowBox[{"nz", "^", "2"}]}], "\[Equal]", " ", "1"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"nx", ",", "ny", ",", "nz"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"nhat", ",", 
      RowBox[{"-", 
       RowBox[{"antiv", ".", "nhat"}]}]}], "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"nhat", ",", 
      RowBox[{"symmv", ".", "nhat"}]}], "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Solve", "[", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.831858888393132*^9, 3.8318589778946457`*^9}, {
   3.831859046922565*^9, 3.831859098244917*^9}, {3.831859135325418*^9, 
   3.831859177640337*^9}, {3.8318592659697227`*^9, 3.8318593695436153`*^9}, {
   3.831859449573756*^9, 3.831859456537941*^9}, {3.831859501540235*^9, 
   3.831859559682766*^9}, {3.831859595108596*^9, 3.8318596148859463`*^9}, {
   3.831859744988027*^9, 3.831859750882265*^9}, {3.8318600433329782`*^9, 
   3.831860092437655*^9}, {3.83186012518994*^9, 3.8318601794450197`*^9}, {
   3.83186021012959*^9, 3.831860298753851*^9}, {3.831860398799653*^9, 
   3.831860424830188*^9}, {3.8319163306645823`*^9, 3.831916339565444*^9}, {
   3.8319169647401943`*^9, 3.831916985845758*^9}, {3.831917152834383*^9, 
   3.831917351457934*^9}, {3.831918008833666*^9, 3.831918228514276*^9}, 
   3.8320343552793093`*^9, {3.83203643512768*^9, 3.8320365286696157`*^9}, {
   3.83203664268091*^9, 3.832036711736101*^9}, {3.83203680015098*^9, 
   3.8320368784298763`*^9}, {3.832036916874672*^9, 3.8320369541963253`*^9}, {
   3.8320372130299263`*^9, 3.8320372645814447`*^9}, {3.8320376453507977`*^9, 
   3.8320376457703047`*^9}, {3.832065815826519*^9, 3.832065905567192*^9}, {
   3.832069643232215*^9, 3.832069645487218*^9}, 3.832072496490056*^9, 
   3.8320769379691343`*^9, {3.832076982353483*^9, 3.832076984452441*^9}, {
   3.832077099909767*^9, 3.8320771377822657`*^9}, {3.833192431866105*^9, 
   3.8331924449833727`*^9}, {3.833193858302491*^9, 3.833193885362321*^9}, {
   3.833301871518558*^9, 3.833301882464682*^9}, {3.833301914609692*^9, 
   3.833301937849997*^9}, {3.833302758679825*^9, 3.833302760248148*^9}, {
   3.833302934921627*^9, 3.833302937977626*^9}, {3.833304255871023*^9, 
   3.833304259101285*^9}},
 CellLabel->
  "In[398]:=",ExpressionUUID->"ccd37fd0-2deb-45b6-959e-ab799e711cd3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"k", " ", "ny", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s", "+", 
          RowBox[{
           SuperscriptBox["ny", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "s"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["nz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "s"}], ")"}]}]}], ")"}]}], 
       RowBox[{"3", " ", "s"}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k", " ", "nx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "s", "+", 
           RowBox[{
            SuperscriptBox["ny", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "s"}], ")"}]}]}], ")"}]}], 
        RowBox[{"3", " ", "s"}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"k", " ", "nx", " ", "ny", " ", "nz", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "s"}], ")"}]}], 
        RowBox[{"3", " ", "s"}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.833192446645653*^9, {3.833193879772883*^9, 3.833193886344964*^9}, 
   3.8332997193748827`*^9, {3.833301889577132*^9, 3.8333019386945057`*^9}, 
   3.8333027635474577`*^9, 3.8333029385782146`*^9, 3.833304259722205*^9},
 CellLabel->
  "Out[413]//MatrixForm=",ExpressionUUID->"34cd476e-501a-4c5f-adad-\
0f3c4f59f601"],

Cell[BoxData[
 RowBox[{
  RowBox[{"k", " ", "nx", " ", "ny", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "s", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["s", "2"]}]}], ")"}]}], "+", 
  RowBox[{"2", " ", "D", " ", "s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "s", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["s", "2"]}]}], ")"}], " ", "U"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.833192446645653*^9, {3.833193879772883*^9, 3.833193886344964*^9}, 
   3.8332997193748827`*^9, {3.833301889577132*^9, 3.8333019386945057`*^9}, 
   3.8333027635474577`*^9, 3.8333029385782146`*^9, 3.833304259724079*^9},
 CellLabel->
  "Out[414]=",ExpressionUUID->"ecc0a7e6-cb2e-4758-965a-9a642cad1ac6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nx", "\[Rule]", "0"}], ",", 
     RowBox[{"ny", "\[Rule]", "0"}], ",", 
     RowBox[{"nz", "\[Rule]", 
      RowBox[{"-", "1"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nx", "\[Rule]", "0"}], ",", 
     RowBox[{"ny", "\[Rule]", "0"}], ",", 
     RowBox[{"nz", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nx", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}], ",", 
     RowBox[{"ny", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "-", "s"}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}], ",", 
     RowBox[{"nz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nx", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}], ",", 
     RowBox[{"ny", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "-", "s"}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}], ",", 
     RowBox[{"nz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nx", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}], ",", 
     RowBox[{"ny", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "-", "s"}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}], ",", 
     RowBox[{"nz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nx", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}], ",", 
     RowBox[{"ny", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "-", "s"}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}], ",", 
     RowBox[{"nz", "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.833192446645653*^9, {3.833193879772883*^9, 3.833193886344964*^9}, 
   3.8332997193748827`*^9, {3.833301889577132*^9, 3.8333019386945057`*^9}, 
   3.8333027635474577`*^9, 3.8333029385782146`*^9, 3.833304259756208*^9},
 CellLabel->
  "Out[415]=",ExpressionUUID->"04f8bb62-ea5a-43a1-b797-bb07eeb3396e"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.833301376868473*^9},ExpressionUUID->"16a21be3-b972-43fb-ab0d-\
36cdccbfce2c"]
},
WindowSize->{1139, 818},
WindowMargins->{{Automatic, -244}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ec74b447-0b04-40f8-9a11-e3dd7ce5357b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 38846, 1076, 2400, "Input",ExpressionUUID->"ccd37fd0-2deb-45b6-959e-ab799e711cd3"],
Cell[39429, 1100, 1828, 54, 120, "Output",ExpressionUUID->"34cd476e-501a-4c5f-adad-0f3c4f59f601"],
Cell[41260, 1156, 801, 22, 37, "Output",ExpressionUUID->"ecc0a7e6-cb2e-4758-965a-9a642cad1ac6"],
Cell[42064, 1180, 2573, 87, 107, "Output",ExpressionUUID->"04f8bb62-ea5a-43a1-b797-bb07eeb3396e"]
}, Open  ]],
Cell[44652, 1270, 129, 3, 30, "Input",ExpressionUUID->"16a21be3-b972-43fb-ab0d-36cdccbfce2c"]
}
]
*)


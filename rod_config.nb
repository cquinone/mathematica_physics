(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103855,       2248]
NotebookOptionsPosition[    100034,       2190]
NotebookOutlinePosition[    100431,       2206]
CellTagsIndexPosition[    100388,       2203]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/quinones/work/phys/research/rods/simulations\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<Quaternions`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", "   ", "DEFINED"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{"FUNCTIONS", "    ", "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"checkEllips", "[", 
    RowBox[{"thisEllip_", ",", "ellipList_"}], "]"}], " ", ":=", " ", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"ellipList", ",", " ", 
     RowBox[{
      RowBox[{"ellipDisjoint", "[", 
       RowBox[{"thisEllip", ",", "#"}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cmat", "[", 
    RowBox[{"\[Lambda]_", ",", "A_", ",", "B_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Inverse", "[", 
    RowBox[{
     RowBox[{"\[Lambda]", "*", "B"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]"}], ")"}], "*", "A"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"func", " ", "that", " ", "takes", " ", "two"}], ",", " ", 
    RowBox[{"returns", " ", "true", " ", "if", " ", "separate"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ellipDisjoint", "[", 
    RowBox[{"ellipA_", ",", " ", "ellipB_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Lambda]", ",", "f", ",", "rA", ",", "rB", ",", "A", ",", "B"}], 
      "}"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
     RowBox[{
      RowBox[{"rA", " ", "=", " ", 
       RowBox[{"ellipA", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t", 
      RowBox[{"rB", " ", "=", " ", 
       RowBox[{"ellipB", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"ellipA", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"ellipB", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Lambda]"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rB", "-", "rA"}], "]"}], ".", 
            RowBox[{"Cmat", "[", 
             RowBox[{"\[Lambda]", ",", "A", ",", "B"}], "]"}], ".", 
            RowBox[{"(", 
             RowBox[{"rB", "-", "rA"}], ")"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FindMaximum", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"f", ",", 
              RowBox[{"0", "<", "\[Lambda]", "<", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", ".05"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "\[LessEqual]", " ", "1"}], 
        ",", " ", "False", ",", " ", "True"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ellipConvert", "[", 
    RowBox[{"pos_", ",", "rot_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Aprime", "}"}], ",", "\[IndentingNewLine]", 
     "\t\t\t\t\t\t\t", 
     RowBox[{
      RowBox[{"Aprime", " ", "=", " ", 
       RowBox[{
        RowBox[{"Transpose", "[", "rot", "]"}], ".", "Ainv", ".", "rot"}]}], 
      ";", "\[IndentingNewLine]", "\t\t\t\t\t\t\t", 
      RowBox[{"Ellipsoid", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "pos", "]"}], ",", "Aprime"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getQuaternion", "[", "rot_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "angle", ",", " ", "eigvals", ",", " ", "eigvects", ",", " ", 
       "rotAxis"}], "}"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
     RowBox[{
      RowBox[{"angle", " ", "=", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tr", "[", "rot", "]"}], "-", "1"}], ")"}], "/", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
      RowBox[{"eigvals", "=", 
       RowBox[{"Eigenvalues", "[", "rot", "]"}]}], ";", "\[IndentingNewLine]",
       "\t\t\t\t\t\t", 
      RowBox[{"eigvects", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"Eigenvectors", "[", "rot", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t\t\t\t\t\t", 
      RowBox[{"rotAxis", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Pick", "[", 
         RowBox[{"eigvects", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", "#", "]"}], "\[Equal]", "0"}], "&"}], ",", 
            "eigvals"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"angle", "/", "2"}], "]"}], ",", 
        RowBox[{
         RowBox[{"rotAxis", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"angle", "/", "2"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"rotAxis", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"angle", "/", "2"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"rotAxis", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"angle", "/", "2"}], "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  "\t\t\t\t\t\t\t\t\t\t\t\t\t\t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Qtens", "[", "u_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"3", "*", 
     RowBox[{"TensorProduct", "[", 
      RowBox[{"u", ",", "u"}], "]"}]}], "-", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", "   ", "MAIN"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{"CODE", "    ", "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dens", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diam", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"\[Alpha]", "*", "diam"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"L", "^", "2"}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"diam", " ", "^", "2"}], ")"}]}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"diam", "^", "2"}], ")"}]}]}], "}"}]}], "}"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "inner", " ", "matrix", " ", "for", " ", "unrotated", " ", "ellip"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ainv", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"L", "^", "2"}], ")"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"(", 
         RowBox[{"diam", " ", "^", "2"}], ")"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"(", 
         RowBox[{"diam", "^", "2"}], ")"}]}], "}"}]}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Inv", " ", "of", " ", "typical", " ", "A"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", " ", "=", " ", ".39"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boxL", " ", "=", " ", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numP", " ", "=", " ", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stdev", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "/", 
      RowBox[{"(", 
       RowBox[{"4", "*", "Pi"}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Phi]"}], ")"}], "^", "4"}]}], ")"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", "*", "\[Phi]"}], "-", 
       RowBox[{"3", "*", 
        RowBox[{"(", 
         RowBox[{"\[Phi]", "^", "2"}], ")"}]}]}], ")"}], "^", "2"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acceptedEllips", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"us", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotMats", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pCount", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"accept", " ", "=", " ", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"writefile", " ", "=", " ", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tries", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"accept", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "try", " ", "20", " ", "times", " ", "to", " ", "find", " ", "one"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"tries", " ", "<", " ", "35"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"which", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{"UniformDistribution", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "pick", " ", "if", " ", "down", " ", "or", " ", "up", " ", 
            RowBox[{"(", 
             RowBox[{"50", "-", "50"}], ")"}], " ", "then", " ", "pick", " ", 
            "shifted", " ", "u"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[Theta]", " ", "=", " ", 
           RowBox[{"-", "50"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"impossibly", " ", "wrong", " ", "val"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"which", " ", "\[LessEqual]", " ", ".5"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]", " ", ">", " ", 
                 RowBox[{"Pi", "/", "2"}]}], " ", "||", " ", 
                RowBox[{"\[Theta]", " ", "<", " ", "0"}]}], ")"}], ",", " ", 
              RowBox[{"\[Theta]", " ", "=", " ", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{"NormalDistribution", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"1", "/", 
                   RowBox[{"Sqrt", "[", "stdev", "]"}]}]}], " ", "]"}], 
                "]"}]}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]", " ", ">", " ", "Pi"}], " ", "||", " ", 
                RowBox[{"\[Theta]", " ", "<", " ", 
                 RowBox[{"Pi", "/", "2"}]}]}], ")"}], ",", " ", 
              RowBox[{"\[Theta]", " ", "=", " ", 
               RowBox[{"RandomVariate", "[", 
                RowBox[{"NormalDistribution", "[", 
                 RowBox[{"Pi", ",", 
                  RowBox[{"1", "/", 
                   RowBox[{"Sqrt", "[", "stdev", "]"}]}]}], " ", "]"}], 
                "]"}]}]}], " ", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"uz", " ", "=", " ", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ang", " ", "=", "  ", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{"UniformDistribution", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "*", "Pi"}]}], "}"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ux", " ", "=", " ", 
           RowBox[{
            RowBox[{"Cos", "[", "ang", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"uy", " ", "=", 
           RowBox[{
            RowBox[{"Sin", "[", "ang", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "construct", " ", "rotation", " ", "matrix", " ", "for", " ", 
            "ellipsoid", " ", "from", " ", "x", " ", "to", " ", "u"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"rot", " ", "=", " ", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ux", ",", "uy", ",", "uz"}], "}"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Aprime", " ", "=", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "rot", "]"}], ".", "Ainv", ".", 
            "rot"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "pick", " ", "random", " ", "point", " ", "in", " ", "box"}], ",",
             " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"at", " ", "least", " ", 
                RowBox[{"L", "/", "2"}], " ", "away", "  ", "from", " ", 
                "edges"}], " ", "..."}], ".", " ", "or"}], " ", 
             RowBox[{"not", " ", "?"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"x", " ", "=", " ", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "boxL"}], "+", "L"}], ",", 
                 RowBox[{"boxL", "-", "L"}]}], "}"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y", " ", "=", " ", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "boxL"}], "+", "L"}], ",", 
                 RowBox[{"boxL", "-", "L"}]}], "}"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z", " ", "=", " ", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "boxL"}], "+", "L"}], ",", 
                 RowBox[{"boxL", "-", "L"}]}], "}"}], "]"}], "]"}]}], ";"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"x", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{"UniformDistribution", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "boxL"}], ",", "boxL"}], "}"}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"y", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{"UniformDistribution", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "boxL"}], ",", "boxL"}], "}"}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"z", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", 
            RowBox[{"UniformDistribution", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "boxL"}], ",", "boxL"}], "}"}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"now", " ", "test", " ", "if", " ", "in", " ", "box"}], 
            ",", " ", 
            RowBox[{
            "and", " ", "not", " ", "intersecting", " ", "other", " ", 
             "ellips"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "acceptedEllips", "]"}], " ", "<", "1"}], 
            ",", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"accept", "=", "True"}], ";", " ", 
              RowBox[{"Break", "[", "]"}]}], ")"}]}], "]"}], ";", "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"if", " ", "empty", " ", "box"}], ",", " ", 
            RowBox[{"accept", " ", "and", " ", "break"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"construct", " ", "list", " ", "of", " ", "neighbors"}], 
            ",", " ", 
            RowBox[{"meaning", " ", "within", " ", "L"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"neighborbuild", " ", "=", " ", 
           RowBox[{"Reap", "[", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "<", 
               RowBox[{"Length", "[", "acceptedEllips", "]"}]}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"EuclideanDistance", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"acceptedEllips", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], 
                 "\[LessEqual]", " ", "L"}], ",", 
                RowBox[{"Sow", "[", 
                 RowBox[{
                  RowBox[{"acceptedEllips", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<close\>\""}], 
                 "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "if", " ", "there", " ", "are", " ", "even", " ", "any", " ", 
             "close", " ", "enough"}], ",", " ", 
            RowBox[{"save", " ", "as", " ", "list", " ", "now"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"neighborbuild", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", " ", "0"}], ",", 
            RowBox[{"neighborList", " ", "=", " ", 
             RowBox[{
              RowBox[{"neighborbuild", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
            RowBox[{"neighborList", "=", " ", 
             RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "check", " ", "for", " ", "disjoint", " ", "against", " ", "only", 
            " ", "neighbors"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"accept", " ", "=", " ", 
           RowBox[{"checkEllips", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "Aprime"}], 
              "}"}], ",", " ", "neighborList"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"accept", ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "break", " ", "if", " ", "random", " ", "ellipsoid", " ", "is", 
            " ", "disjoint", " ", "with", " ", "all", " ", "the", " ", 
            "rest"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"tries", ">", "1"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<tries = \>\"", ",", "tries"}], "]"}]}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tries", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"accept", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"acceptedEllips", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "x", "}"}], ",", 
                 RowBox[{"{", "y", "}"}], ",", 
                 RowBox[{"{", "z", "}"}]}], "}"}], ",", "Aprime"}], "}"}]}], 
            "]"}], ";", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"us", ",", " ", 
             RowBox[{"{", 
              RowBox[{"ux", ",", "uy", ",", "uz"}], "}"}]}], "]"}], ";", " ", 
           
           RowBox[{"AppendTo", "[", 
            RowBox[{"rotMats", ",", " ", "rot"}], "]"}]}], ")"}], ",", " ", 
         RowBox[{
         "Print", "[", "\"\<After 35 tries, couldn't find one\>\"", "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pCount", "++"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"pCount", ",", "100"}], "]"}], " ", "\[Equal]", " ", "0"}],
          ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<# particles: \>\"", ",", " ", "pCount"}], "]"}]}], 
        "]"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "keep", " ", "only", " ", "if", " ", "you", " ", "want", " ", "to", 
        " ", "track", " ", "algo", " ", "progress"}], " ", "*)"}], 
      "\[IndentingNewLine]", ",", "numP"}], "]"}], ";"}], " ", "//", " ", 
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Num stuffed = \>\"", ",", 
   RowBox[{"Length", "[", "acceptedEllips", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qtot", " ", "=", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Qtens", "[", "#", "]"}], "&"}], ",", "us"}], "]"}], "]"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", 
      RowBox[{"Length", "[", "us", "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", " ", "=", " ", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Eigensystem", "[", "Qtot", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Q eigs: \>\"", ",", 
     RowBox[{"Eigensystem", "[", "Qtot", "]"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<S = \>\"", ",", " ", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pVol", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "*", 
       RowBox[{"Pi", "/", "3"}]}], ")"}], "*", "diam", "*", "diam", "*", 
     "L"}]}], " ", ";", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"10", ":", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"1", "*", "1", "*", 
       RowBox[{"10", "?", " ", "L_p"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"20", " ", "really"}], "..."}]}]}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<PHI: \>\"", ",", " ", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Length", "[", "acceptedEllips", "]"}], "*", 
       RowBox[{"pVol", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"(", "boxL", ")"}]}], ")"}], "^", "3"}], ")"}]}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "construct", " ", "quaternions", " ", "from", " ", "rot", " ", "matrices", 
    " ", "and", " ", "ellipsoid", " ", "pointing", " ", "vectors"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Chop", " ", "turns", " ", "very", " ", "small", " ", "numbers", " ", 
    "into", " ", "0", " ", "here"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quats", " ", "=", " ", 
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"getQuaternion", ",", "rotMats"}], "]"}], ",", 
      RowBox[{"10", "^", 
       RowBox[{"-", "10"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"pos", " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "acceptedEllips"}], 
      "]"}]}], ";", " ", 
    RowBox[{"see", " ", "below", " ", "on", " ", "old", " ", "method"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", "#", "]"}], "&"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "acceptedEllips"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mats", " ", "=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "acceptedEllips"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"oldEllips", " ", "=", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{"ellipConvert", ",", 
        RowBox[{"{", 
         RowBox[{"pos", ",", "rotMats"}], "}"}]}], "]"}]}], ";", "  ", 
     RowBox[{"old", " ", "method"}]}], ",", " ", 
    RowBox[{"useful", " ", "if", " ", "Do", " ", "return", " ", "ever", " ", 
     RowBox[{"changed", "!"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ellipRegions", " ", "=", " ", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Ellipsoid", ",", 
     RowBox[{"{", 
      RowBox[{"pos", ",", "mats"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotEllips", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "@", "Red"}], ",", "#"}], "}"}], ",", " ", 
        RowBox[{"Lighting", " ", "\[Rule]", " ", "\"\<Neutral\>\""}], ",", 
        " ", 
        RowBox[{"Boxed", "\[Rule]", " ", "False"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", " ", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}], 
        ",", " ", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}], ",", "Black",
            ",", "Bold"}], "}"}]}]}], "]"}], "&"}], ",", "ellipRegions"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundcube", " ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", 
      RowBox[{"Opacity", "[", ".1", "]"}], ",", 
      RowBox[{"EdgeForm", "[", 
       RowBox[{"Opacity", "[", "0", "]"}], "]"}], ",", 
      RowBox[{"Cuboid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "boxL"}], "+", "L"}], ",", 
          RowBox[{
           RowBox[{"-", "boxL"}], "+", "L"}], ",", 
          RowBox[{
           RowBox[{"-", "boxL"}], "+", "L"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"boxL", "-", "L"}], ",", 
          RowBox[{"boxL", "-", "L"}], ",", 
          RowBox[{"boxL", "-", "L"}]}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outercube", "  ", "=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Black", ",", 
      RowBox[{"Opacity", "[", "0", "]"}], ",", 
      RowBox[{"EdgeForm", "[", "Thick", "]"}], ",", 
      RowBox[{"Cuboid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "boxL"}], ",", 
          RowBox[{"-", "boxL"}], ",", 
          RowBox[{"-", "boxL"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"boxL", ",", "boxL", ",", "boxL"}], "}"}]}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"plotEllips", ",", "boundcube", ",", "outercube"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Construct", " ", "LAMMPS", " ", "friendly", " ", "input", " ", "file"}], 
   "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstStr", " ", "=", " ", 
    RowBox[{
     RowBox[{
     "StringTemplate", "[", 
      "\"\<# ellipsoid data file... have to fill this line\n\n`` atoms\n`` \
ellipsoids\n1   atom types\n-`` `` xlo xhi\n-`` `` ylo yhi\n-`` `` zlo zhi\n\n\
Atoms\n\>\"", "]"}], "[", 
     RowBox[{
     "numP", ",", "numP", ",", "boxL", ",", "boxL", ",", "boxL", ",", "boxL", 
      ",", "boxL", ",", "boxL"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "acceptedEllips", "]"}], "\[Equal]", " ", 
     "numP"}], ",", 
    RowBox[{"writefile", "=", "True"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uStr", " ", "=", " ", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qStr", " ", "=", " ", "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shapex", " ", "=", " ", "L"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shapey", " ", "=", " ", "diam"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"shapez", " ", "=", " ", "diam"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"way", " ", "it", " ", 
     RowBox[{"works", ":", " ", 
      RowBox[{"write", " ", "firststr"}]}]}], ",", " ", 
    RowBox[{"which", " ", "has", " ", "no", " ", "atom", " ", "data"}], ",", 
    " ", 
    RowBox[{"then", " ", "write", " ", "ustr"}], ",", " ", 
    RowBox[{"which", " ", "has", " ", "atom", " ", "data", " ", 
     RowBox[{"(", 
      RowBox[{"no", " ", "orients"}], ")"}], "\[IndentingNewLine]", 
     "\t\t\t\t", "then", " ", "write", " ", "uStr"}], ",", " ", 
    RowBox[{
    "which", " ", "has", " ", "density", " ", "and", " ", "pos", " ", 
     "data"}], ",", " ", 
    RowBox[{"then", " ", "write", " ", "qStr"}], ",", " ", 
    RowBox[{
    "which", " ", "has", " ", "orients", " ", "and", " ", "shape", " ", 
     "data"}]}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", "1"}], ",", " ", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "us", "]"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"uStr", " ", "=", " ", 
     RowBox[{"uStr", " ", "<>", " ", 
      RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<\\t\>\"", " ",
       "<>", " ", "\"\<1\>\"", " ", "<>", " ", "\"\<\\t\>\"", " ", "<>", " ", 
      "\"\<1\>\"", " ", "<>", "  ", "\"\<\\t\>\"", " ", "<>", " ", 
      RowBox[{"ToString", "[", "dens", "]"}], " ", "<>", " ", "\"\<\\t\>\"", 
      " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"pos", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\t\>\"", " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"pos", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\t\>\"", " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"pos", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"qStr", " ", "=", " ", 
     RowBox[{"qStr", " ", "<>", " ", 
      RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\<\\t\>\"", " ",
       "<>", " ", 
      RowBox[{"ToString", "[", "shapex", "]"}], " ", "<>", " ", "\"\<\\t\>\"",
       " ", "<>", " ", 
      RowBox[{"ToString", "[", "shapey", "]"}], " ", "<>", " ", "\"\<\\t\>\"",
       " ", "<>", " ", 
      RowBox[{"ToString", "[", "shapez", "]"}], " ", "<>", " ", "\"\<\\t\>\"",
       " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"quats", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\t\>\"", " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"quats", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\t\>\"", " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"quats", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\t\>\"", " ", "<>", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", 
        RowBox[{"DecimalForm", "[", 
         RowBox[{"quats", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "4"}], "]"}], "]"}], "]"}], "]"}], "]"}], " ", "<>",
       " ", "\"\<\\n\>\""}]}], " ", ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uStr", "=", 
   RowBox[{
   "uStr", "<>", "\"\<\\n\>\"", "<>", "\"\<Ellipsoids\>\"", "<>", 
    "\"\<\\n\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", " ", "=", " ", 
   RowBox[{
    RowBox[{"ToString", "[", "numP", "]"}], "<>", "\"\<_rods_data_2\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"file", " ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Directory", "[", "]"}], ",", "filename"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"writefile", ",", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DeleteFile", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"CreateFile", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteLine", "[", 
       RowBox[{"file", ",", " ", "firstStr"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteLine", "[", 
       RowBox[{"file", ",", " ", "uStr"}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"WriteLine", "[", 
       RowBox[{"file", ",", " ", "qStr"}], "]"}]}], "\[IndentingNewLine]", 
     ")"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8460618820411263`*^9, 3.846062042482993*^9}, {
   3.846062152800826*^9, 3.8460622029888906`*^9}, {3.846062236914885*^9, 
   3.846062251563753*^9}, {3.8460623161283607`*^9, 3.846062437192318*^9}, {
   3.846062526279436*^9, 3.846062532588901*^9}, {3.846062842542852*^9, 
   3.8460628806754417`*^9}, {3.846062994818985*^9, 3.846063008284588*^9}, {
   3.846064750048284*^9, 3.846064801974753*^9}, {3.846064841960396*^9, 
   3.846064860809091*^9}, {3.846064892575902*^9, 3.846065167069693*^9}, {
   3.84606522406485*^9, 3.846065241768496*^9}, {3.846065364178274*^9, 
   3.846065675504133*^9}, {3.8460657205871773`*^9, 3.846066003111541*^9}, {
   3.846066057205525*^9, 3.846066120578961*^9}, {3.8460661511238728`*^9, 
   3.846066162568713*^9}, {3.846066449418785*^9, 3.846066506683601*^9}, {
   3.846066600103838*^9, 3.84606666664767*^9}, {3.8460667056157293`*^9, 
   3.8460667187243233`*^9}, {3.8460667519686747`*^9, 3.846066828852024*^9}, {
   3.846066876282454*^9, 3.846066884855966*^9}, {3.846067008968319*^9, 
   3.846067148505781*^9}, {3.84606741285744*^9, 3.846067566316506*^9}, {
   3.846067662583803*^9, 3.846067662652494*^9}, {3.8460677206260233`*^9, 
   3.846067723263427*^9}, {3.846067789108561*^9, 3.846067836989546*^9}, {
   3.846067955569522*^9, 3.846067956816243*^9}, 3.846068042008623*^9, {
   3.846068369326248*^9, 3.8460683796727543`*^9}, {3.846068713684805*^9, 
   3.846068733086556*^9}, {3.846068882722518*^9, 3.846068884144665*^9}, {
   3.846069457871641*^9, 3.8460696070236673`*^9}, {3.846069679734297*^9, 
   3.846069770516571*^9}, {3.846069805120673*^9, 3.8460698117124043`*^9}, {
   3.846069893029401*^9, 3.846070114601986*^9}, {3.846070150184518*^9, 
   3.8460702056553497`*^9}, {3.846070248395298*^9, 3.846070274388357*^9}, 
   3.8460703310375347`*^9, {3.8460704017119637`*^9, 3.846070445575498*^9}, {
   3.846070477340283*^9, 3.846070477978366*^9}, {3.8460705398933067`*^9, 
   3.846070544954166*^9}, {3.846070713310419*^9, 3.8460707247922773`*^9}, {
   3.846070781509906*^9, 3.8460707816114397`*^9}, {3.846070816982889*^9, 
   3.846070818090979*^9}, {3.846071127484771*^9, 3.846071147627302*^9}, {
   3.8460712798232193`*^9, 3.846071340928953*^9}, {3.846072248410584*^9, 
   3.846072353511059*^9}, {3.846072444383788*^9, 3.846072445164031*^9}, {
   3.846073167609318*^9, 3.846073169298229*^9}, {3.8460732552662687`*^9, 
   3.846073256349822*^9}, 3.8460733741003847`*^9, {3.846073633000607*^9, 
   3.846073651481029*^9}, {3.846073907288299*^9, 3.846073910352151*^9}, {
   3.84607494939363*^9, 3.8460749720260057`*^9}, {3.846075045185361*^9, 
   3.846075054462702*^9}, {3.846075113868787*^9, 3.846075137734048*^9}, {
   3.8460751770015574`*^9, 3.846075178929906*^9}, {3.846075280727549*^9, 
   3.8460753171926947`*^9}, {3.846075377202951*^9, 3.846075395284048*^9}, {
   3.8460754365417013`*^9, 3.8460754405603848`*^9}, {3.8460758388649483`*^9, 
   3.846075909043931*^9}, {3.846075987942666*^9, 3.846076004558165*^9}, {
   3.8460760366132383`*^9, 3.846076065611877*^9}, {3.8460764929924383`*^9, 
   3.846076550332547*^9}, {3.846076585320923*^9, 3.8460766411208353`*^9}, {
   3.846076676876367*^9, 3.8460767162077217`*^9}, {3.8460803681257*^9, 
   3.846080529578557*^9}, {3.846080566682605*^9, 3.846080573215358*^9}, {
   3.846080845054207*^9, 3.8460810526484756`*^9}, {3.8460811018068113`*^9, 
   3.846081186455217*^9}, {3.846081668070554*^9, 3.846081669444454*^9}, {
   3.846082024695846*^9, 3.846082078721361*^9}, {3.846082353378496*^9, 
   3.846082370733238*^9}, {3.846082475315261*^9, 3.846082475396023*^9}, {
   3.8460977408282557`*^9, 3.846097741041563*^9}, {3.846098825750658*^9, 
   3.846098825854809*^9}, {3.846099640914831*^9, 3.846099641014797*^9}, {
   3.846099862644096*^9, 3.846099890609529*^9}, {3.84609992828375*^9, 
   3.846099928791708*^9}, {3.846099960221334*^9, 3.8460999955140038`*^9}, {
   3.8461000506820917`*^9, 3.846100051143659*^9}, {3.8461000836047688`*^9, 
   3.846100087340406*^9}, {3.846100132889072*^9, 3.8461001884969683`*^9}, {
   3.84610022966133*^9, 3.846100229784596*^9}, {3.846100369039917*^9, 
   3.846100369462329*^9}, {3.846100581464013*^9, 3.846100613172538*^9}, {
   3.8461018082606993`*^9, 3.846101876723126*^9}, {3.846101958794731*^9, 
   3.8461019683855124`*^9}, {3.84610201490038*^9, 3.846102035024757*^9}, {
   3.846102185678227*^9, 3.846102199130221*^9}, 3.8461250490915737`*^9, {
   3.846125098947551*^9, 3.846125099151388*^9}, {3.846125172247182*^9, 
   3.846125172361702*^9}, {3.8461403887*^9, 3.846140395215308*^9}, {
   3.846140454938426*^9, 3.8461404590080347`*^9}, {3.846140567712494*^9, 
   3.846140585131774*^9}, {3.846140673949459*^9, 3.8461406789732227`*^9}, 
   3.8461407144427853`*^9, {3.846140768280587*^9, 3.846140780433278*^9}, {
   3.84614085110045*^9, 3.8461408708941183`*^9}, {3.846141528544669*^9, 
   3.8461415331570787`*^9}, {3.846141564509274*^9, 3.846141601888216*^9}, {
   3.8461416455021152`*^9, 3.846141661222554*^9}, {3.846141751530929*^9, 
   3.846141753998756*^9}, 3.8462320145485163`*^9, {3.846232280025173*^9, 
   3.846232305532693*^9}, {3.846232374097067*^9, 3.846232414754374*^9}, {
   3.846232446731743*^9, 3.846232451753982*^9}, {3.846232511370578*^9, 
   3.846232525560315*^9}, {3.846233026795898*^9, 3.846233054920498*^9}, {
   3.846233106030367*^9, 3.846233217036572*^9}, {3.846233407122407*^9, 
   3.8462334421095343`*^9}, {3.8462362274866133`*^9, 3.846236298424176*^9}, {
   3.846236651280251*^9, 3.846236653643866*^9}, {3.8462371351223583`*^9, 
   3.8462372077395687`*^9}, {3.8462372964706287`*^9, 3.846237306377326*^9}, {
   3.846237373171981*^9, 3.8462374149820843`*^9}, {3.846237455945326*^9, 
   3.846237463260663*^9}, {3.8462376189012413`*^9, 3.846237730255596*^9}, {
   3.846237781550147*^9, 3.8462378250060673`*^9}, {3.846237951885027*^9, 
   3.846237969419218*^9}, {3.846238020870377*^9, 3.846238119531334*^9}, {
   3.8462381918672867`*^9, 3.8462382429981537`*^9}, {3.846238301516121*^9, 
   3.846238479947083*^9}, {3.846238516034402*^9, 3.846238651606476*^9}, {
   3.846238684889024*^9, 3.846238694288291*^9}, {3.846238798329399*^9, 
   3.846238800823647*^9}, {3.8462389047184563`*^9, 3.846238908234045*^9}, {
   3.846238964564918*^9, 3.846239019417355*^9}, {3.84623909869937*^9, 
   3.846239122409965*^9}, {3.8462393074971333`*^9, 3.846239321444189*^9}, {
   3.8462393527367973`*^9, 3.846239437310584*^9}, {3.846239486442841*^9, 
   3.846239602144248*^9}, {3.846239651253171*^9, 3.846239652321741*^9}, {
   3.846239688666768*^9, 3.8462397210227337`*^9}, {3.846254117272972*^9, 
   3.846254117345167*^9}, {3.846257821966107*^9, 3.846257822121072*^9}, {
   3.8463274369624233`*^9, 3.8463274728945713`*^9}, {3.846329053253935*^9, 
   3.846329064534607*^9}, {3.846333085259345*^9, 3.846333111603538*^9}, {
   3.8463358388375998`*^9, 3.846335839242812*^9}, {3.84633599893493*^9, 
   3.846336017178295*^9}, {3.846397865576722*^9, 3.846397900798039*^9}, 
   3.846397958456759*^9, 3.84639805876775*^9, {3.8463980896827517`*^9, 
   3.846398148675907*^9}, {3.846398293168804*^9, 3.846398299971766*^9}, {
   3.846398348360268*^9, 3.8463983512382803`*^9}, {3.8463983951787643`*^9, 
   3.846398445537993*^9}, {3.846398480600646*^9, 3.8463985092276583`*^9}, {
   3.846398551755574*^9, 3.8463985835811987`*^9}, {3.8463986326797113`*^9, 
   3.846398645708454*^9}, {3.846398682860684*^9, 3.8463986835430613`*^9}, {
   3.8463987135706587`*^9, 3.846398781925271*^9}, {3.8463988254524937`*^9, 
   3.8463988616699333`*^9}, {3.846398904539727*^9, 3.846398981981365*^9}, {
   3.8463990710582848`*^9, 3.846399106249387*^9}, {3.846399289578429*^9, 
   3.8463993428029013`*^9}, {3.846403690341848*^9, 3.8464036917433977`*^9}, {
   3.846403726499461*^9, 3.846403767608861*^9}, {3.846403809237624*^9, 
   3.846403831482853*^9}, {3.846403984381523*^9, 3.846404035800324*^9}, {
   3.846404082050624*^9, 3.846404094260927*^9}, {3.846404201848165*^9, 
   3.846404382888317*^9}, {3.8464044168812237`*^9, 3.8464045665180883`*^9}, 
   3.84659845526967*^9, 3.847369996967491*^9, {3.847370671400693*^9, 
   3.8473706907123137`*^9}, {3.847373891447359*^9, 3.847373950183867*^9}, 
   3.8473742545107203`*^9, {3.8473743143581047`*^9, 3.8473744284452553`*^9}, {
   3.847374479829206*^9, 3.847374491218113*^9}, {3.847374571355228*^9, 
   3.847374571726612*^9}, {3.847374606592655*^9, 3.847374637248267*^9}, {
   3.8473747294796743`*^9, 3.847374760159029*^9}, {3.847374837188076*^9, 
   3.8473748415228033`*^9}, {3.8473749770251226`*^9, 3.847375072953436*^9}, {
   3.847375348756649*^9, 3.847375795678165*^9}, {3.84737597687978*^9, 
   3.847376187709243*^9}, {3.847376229262335*^9, 3.847376236366006*^9}, {
   3.847376274984495*^9, 3.847376553132908*^9}, {3.8473765994591923`*^9, 
   3.847376607327077*^9}, {3.847376664594051*^9, 3.8473767215638514`*^9}, {
   3.847376764585601*^9, 3.847376843620851*^9}, {3.847376893298222*^9, 
   3.847376907540663*^9}, {3.847376985886076*^9, 3.847377042386468*^9}, {
   3.847377074505971*^9, 3.847377277601756*^9}, {3.8473773186813726`*^9, 
   3.847377361076909*^9}, 3.8473773912381477`*^9, {3.847377427477054*^9, 
   3.847377441782036*^9}, {3.847377476838284*^9, 3.847377491643072*^9}, {
   3.847377526849598*^9, 3.847377618597875*^9}, {3.847377930989921*^9, 
   3.847377931076497*^9}, {3.8473781998528357`*^9, 3.847378202310646*^9}, {
   3.8473789365774384`*^9, 3.8473789458851213`*^9}, {3.847383239005991*^9, 
   3.847383240237214*^9}, {3.847383295076332*^9, 3.847383295157897*^9}, {
   3.847390195001232*^9, 3.847390195162056*^9}, {3.847390827917122*^9, 
   3.8473908283612947`*^9}, {3.84739147154793*^9, 3.8473914771368637`*^9}, {
   3.8473917077520647`*^9, 3.847391707838339*^9}, {3.847396772686853*^9, 
   3.847396776572905*^9}, {3.8473979744272547`*^9, 3.8473980875977592`*^9}, {
   3.847398742596568*^9, 3.847398752362713*^9}, 3.847399761897922*^9, {
   3.847400551310863*^9, 3.847400594588993*^9}, {3.8474007900439043`*^9, 
   3.8474009115146017`*^9}, {3.847400942816579*^9, 3.847400956820907*^9}, {
   3.84740103859616*^9, 3.847401038934576*^9}, 3.847401571025049*^9, {
   3.847411337599086*^9, 3.847411377707529*^9}, {3.847411416765641*^9, 
   3.847411431811698*^9}, {3.847411481317831*^9, 3.847411481402994*^9}, {
   3.847411674429364*^9, 3.847411698360899*^9}, {3.8474117337825813`*^9, 
   3.8474117558109617`*^9}, {3.847412269877339*^9, 3.847412270994499*^9}, {
   3.847412725490911*^9, 3.847412735506052*^9}, {3.847412767290926*^9, 
   3.8474127681804028`*^9}, {3.847412867447941*^9, 3.847412896881605*^9}, {
   3.8474133718543158`*^9, 3.847413393033687*^9}, {3.847413485873942*^9, 
   3.8474135331629267`*^9}, {3.8474135876004667`*^9, 3.847413589512624*^9}, {
   3.8474137659348087`*^9, 3.8474138194767103`*^9}, {3.8474138608962307`*^9, 
   3.847413868212646*^9}, {3.847414048220334*^9, 3.847414048292242*^9}, {
   3.847415089649247*^9, 3.847415089872624*^9}, {3.847415136184263*^9, 
   3.847415174123114*^9}, {3.847415252621467*^9, 3.847415441140423*^9}, {
   3.847415476779592*^9, 3.847415553818756*^9}, {3.847415599789151*^9, 
   3.847415649288946*^9}, {3.847415679876424*^9, 3.847415762776909*^9}, {
   3.8474158115375643`*^9, 3.847415812001258*^9}, {3.8474161832682743`*^9, 
   3.847416183328926*^9}, {3.8474641845913267`*^9, 3.8474642401499043`*^9}, {
   3.847464277784491*^9, 3.847464293074354*^9}, {3.847464344394185*^9, 
   3.8474643444795732`*^9}, {3.847464426465558*^9, 3.847464442594298*^9}, {
   3.8474644739328527`*^9, 3.847464532795619*^9}, {3.847464572047493*^9, 
   3.847464572118499*^9}, {3.847464614402676*^9, 3.847464633256031*^9}, {
   3.847464783591748*^9, 3.847464824898459*^9}, {3.8474650661810827`*^9, 
   3.847465243774569*^9}, {3.847465281141333*^9, 3.8474653168352537`*^9}, {
   3.847465359249756*^9, 3.847465373816063*^9}, {3.847465438870826*^9, 
   3.847465464390696*^9}, {3.8474657230144787`*^9, 3.84746586138352*^9}, {
   3.847465931030407*^9, 3.8474659604439173`*^9}, {3.84746605718384*^9, 
   3.84746606425922*^9}, {3.847466103661409*^9, 3.847466118906968*^9}, {
   3.8474661680556707`*^9, 3.847466185787714*^9}, {3.84768146252582*^9, 
   3.8476816232921753`*^9}, {3.847681654317485*^9, 3.84768167443537*^9}, {
   3.847681782179833*^9, 3.847681810024025*^9}, {3.8476820165625563`*^9, 
   3.847682075497505*^9}, {3.8476821154922543`*^9, 3.847682170691144*^9}, {
   3.8476824851811123`*^9, 3.847682490244299*^9}, {3.8476825226909847`*^9, 
   3.847682581996605*^9}, {3.8476826159223213`*^9, 3.847682616507657*^9}, {
   3.8476839475785418`*^9, 3.8476839596298237`*^9}, {3.847684096915876*^9, 
   3.8476841766197033`*^9}, {3.847684226163184*^9, 3.847684236556958*^9}, {
   3.8476845245042067`*^9, 3.847684524827273*^9}, {3.847685195386875*^9, 
   3.847685215230012*^9}, 3.847685548363756*^9, {3.8476856082003193`*^9, 
   3.8476856119123583`*^9}, {3.847685683757442*^9, 3.847685715610598*^9}, {
   3.8476858145310373`*^9, 3.8476858251063623`*^9}, {3.847685864885922*^9, 
   3.847685926482437*^9}, {3.847685961570003*^9, 3.8476859919280853`*^9}, {
   3.8476861422530413`*^9, 3.847686210485565*^9}, {3.847686312593348*^9, 
   3.8476863364191236`*^9}, {3.847686389613929*^9, 3.8476864127180243`*^9}, {
   3.847686469300659*^9, 3.847686503244796*^9}, {3.84768654301436*^9, 
   3.847686543552681*^9}, {3.847686577447055*^9, 3.847686586996039*^9}, {
   3.84774790686473*^9, 3.847747926846941*^9}, {3.847808594730546*^9, 
   3.8478086520209*^9}, {3.847808695916663*^9, 3.8478086969422092`*^9}, {
   3.8478088312276287`*^9, 3.847808831286125*^9}, {3.847809005322747*^9, 
   3.847809005413302*^9}, {3.847809137955668*^9, 3.8478091380640783`*^9}, {
   3.8478098479524193`*^9, 3.847809852783984*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"3ab854b5-4d98-48b8-94d7-c4d2fcc9dbbc"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["# particles: ", 100],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809856374197*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"502553a2-c582-4c82-8c9b-e4b9e753519b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "200"}],
  SequenceForm["# particles: ", 200],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809858010206*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"6e8b3434-b2a4-4b3f-a846-a6977580d06e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "300"}],
  SequenceForm["# particles: ", 300],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809861156013*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"db6ad24c-18e5-4adc-92f9-8cb51435afc6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "400"}],
  SequenceForm["# particles: ", 400],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809865158554*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"3cdcef35-bba8-4410-afd4-0d69764f4ac1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "500"}],
  SequenceForm["# particles: ", 500],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809870219771*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"911cc3db-c8bc-4a22-80d7-5196d4ec6948"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "600"}],
  SequenceForm["# particles: ", 600],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.8478098768860197`*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"a1b8876d-28dc-42bf-b168-868c34ac9d89"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "700"}],
  SequenceForm["# particles: ", 700],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.8478098856277637`*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"2a74a61c-b685-4e18-8f15-ee0581974998"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "800"}],
  SequenceForm["# particles: ", 800],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.8478098967352667`*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"767de828-eb8d-464e-b267-59fa47798907"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "900"}],
  SequenceForm["# particles: ", 900],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809909137539*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"26a5cbfd-47e0-47be-b2b5-d738bbf76ed4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1000"}],
  SequenceForm["# particles: ", 1000],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.8478099228611937`*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"b6e7c0b3-8191-42b2-8589-ca723d58f110"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1100"}],
  SequenceForm["# particles: ", 1100],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809937293836*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"d149ee6f-3875-49d8-b5d4-b58d083ff374"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1200"}],
  SequenceForm["# particles: ", 1200],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809955447015*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"d2830288-4690-46cd-8b86-6725a3101a53"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1300"}],
  SequenceForm["# particles: ", 1300],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809977762004*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"0dd66f82-98b4-437b-9110-e57bf4611ff6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1400"}],
  SequenceForm["# particles: ", 1400],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847809998004531*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"5d6986e4-137b-4172-a180-8d2467d85329"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1500"}],
  SequenceForm["# particles: ", 1500],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.84781002360308*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"31463f8d-1ae3-4ab9-b3c2-74bb77c62d7b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1600"}],
  SequenceForm["# particles: ", 1600],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810048324902*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"06c27ddb-e1bf-4458-8597-84a8e7046d5c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1700"}],
  SequenceForm["# particles: ", 1700],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810077242248*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"45cbddea-8442-4e81-90e8-e85ca2871949"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1800"}],
  SequenceForm["# particles: ", 1800],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810109023264*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"8d520261-dbaa-4f44-a811-7ed7a9a89e31"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "1900"}],
  SequenceForm["# particles: ", 1900],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810142295124*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"97d7bf88-193c-4631-963b-bd56baba6986"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"# particles: \"\>", "\[InvisibleSpace]", "2000"}],
  SequenceForm["# particles: ", 2000],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810180542115*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"0545b31c-5baa-4cd6-8459-9ea11c15916c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"324.73375`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8474642490213013`*^9, 3.84746429925565*^9, 3.8474645416755733`*^9, 
   3.847464577656981*^9, 3.847464638548665*^9, 3.847465135675869*^9, {
   3.847465230408142*^9, 3.847465244358529*^9}, 3.847465284764473*^9, 
   3.847465375329235*^9, {3.8474654561835737`*^9, 3.847465465294614*^9}, {
   3.8474658417973757`*^9, 3.847465862178288*^9}, {3.847465934788897*^9, 
   3.847465962635002*^9}, 3.8474660666727457`*^9, 3.84746613086021*^9, 
   3.847466350580235*^9, 3.847681683168051*^9, 3.84768181820529*^9, 
   3.847682133152307*^9, 3.8476821807083607`*^9, 3.847682501412126*^9, 
   3.847682565848957*^9, 3.847682597109974*^9, 3.8476827046353397`*^9, 
   3.847684420415618*^9, {3.8476855511736526`*^9, 3.84768556878655*^9}, 
   3.8476856461927137`*^9, 3.84768572840534*^9, 3.8476858277132273`*^9, {
   3.847685873012986*^9, 3.8476859271915283`*^9}, 3.847685963305543*^9, 
   3.8476861797503357`*^9, 3.847686211376091*^9, 3.847686340259081*^9, {
   3.847686392378783*^9, 3.847686414763752*^9}, 3.8476865067192698`*^9, 
   3.847686981614586*^9, 3.8478087699928207`*^9, 3.847808900123453*^9, 
   3.847809073503916*^9, 3.847809207098221*^9, 3.847810180543426*^9},
 CellLabel->
  "Out[230]=",ExpressionUUID->"dcf9977d-1454-4ff3-86cd-41b3d7394c93"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Num stuffed = \"\>", "\[InvisibleSpace]", "2000"}],
  SequenceForm["Num stuffed = ", 2000],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810180545106*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"2ce0f855-8a56-47be-aa08-289308b6866c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S = \"\>", "\[InvisibleSpace]", "0.8399324857101786`"}],
  SequenceForm["S = ", 0.8399324857101786],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.847810180592354*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"2c69f2f6-7c7d-4539-909a-7358ae61a4d4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"PHI: \"\>", "\[InvisibleSpace]", "0.08377580409572782`"}],
  SequenceForm["PHI: ", 0.08377580409572782],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8474642462365723`*^9, 3.847464296249221*^9, 3.8474645384716053`*^9, 
   3.847464574321918*^9, 3.847464638550151*^9, 3.847465135677771*^9, {
   3.847465230410357*^9, 3.8474652443600073`*^9}, 3.847465284766116*^9, 
   3.847465375331169*^9, {3.84746545618565*^9, 3.847465465296109*^9}, {
   3.847465841799539*^9, 3.847465862180326*^9}, {3.84746593479088*^9, 
   3.8474659626366663`*^9}, 3.847466066675049*^9, 3.847466130862136*^9, 
   3.847466195768358*^9, 3.847681686793331*^9, 3.8476818191159678`*^9, 
   3.847682134976544*^9, 3.8476821818906517`*^9, 3.847682501410285*^9, {
   3.847682563659519*^9, 3.847682583265856*^9}, 3.8476826409705133`*^9, 
   3.8476842513245087`*^9, {3.84768555117214*^9, 3.847685568785075*^9}, 
   3.84768564619084*^9, 3.847685728403565*^9, 3.847685827711706*^9, {
   3.847685873014732*^9, 3.847685927193596*^9}, 3.847685963308083*^9, 
   3.847686179752391*^9, 3.847686211378448*^9, 3.8476863402611227`*^9, {
   3.847686392380548*^9, 3.847686414761779*^9}, 3.847686506716897*^9, 
   3.847686654096609*^9, 3.8478087083151407`*^9, 3.847808834102474*^9, 
   3.8478090064836206`*^9, 3.84780914059581*^9, 3.8478101805950537`*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"4dc8c6c9-ddd3-432d-bbd4-7b3efcc727eb"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.847810210233613*^9, 
  3.847810210286295*^9}},ExpressionUUID->"c2b80b7b-04d2-40ed-b771-\
7b9d69f39a3f"],

Cell[BoxData[
 TemplateBox[{
  "DeleteFile", "fdnfnd", 
   "\"Directory or file \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/quinones/work/phys/research/rods/\
simulations/2000_rods_data_2\\\\\\\"\\\"}]\\) not found.\"", 2, 255, 5, 
   21434108751820139218, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.847686982465366*^9, 3.847808770923637*^9, 
  3.847808900584032*^9, 3.847809074152804*^9, 3.847809207755611*^9, 
  3.8478101818620367`*^9},
 CellLabel->
  "During evaluation of \
In[205]:=",ExpressionUUID->"1dd0fc6c-3c78-4b64-928d-687091d30031"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", "diam", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "L", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rotA", " ", "=", " ", 
     RowBox[{"rotMats", "[", 
      RowBox[{"[", "100", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"acceptedEllips", "[", 
      RowBox[{"[", 
       RowBox[{"100", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"baseA", " ", "=", " ", 
    RowBox[{"Inverse", "[", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"rotA", ".", "A", ".", 
         RowBox[{"Transpose", "[", "rotA", "]"}]}], "]"}], ",", 
       RowBox[{"10", "^", 
        RowBox[{"-", "10"}]}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"impA", " ", "=", " ", 
     RowBox[{
      RowBox[{"Transpose", "[", "rotA", "]"}], ".", "baseA", ".", "rotA"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rA", " ", "=", " ", 
     RowBox[{"pos", "[", 
      RowBox[{"[", "100", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"riA", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", "-", 
        RowBox[{"rA", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", "-", 
        RowBox[{"rA", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", "-", 
        RowBox[{"rA", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reg1", " ", "=", " ", 
     RowBox[{"ImplicitRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "riA", "]"}], ".", "impA", ".", "riA"}], 
          ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[LessEqual]", " ", 
        "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RegionPlot3D", "[", "reg1", "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Volume", "[", "reg1", "]"}], " ", "-", " ", "pVol"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"B", "=", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{"acceptedEllips", "[", 
        RowBox[{"[", 
         RowBox[{"100", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rB", " ", "=", " ", 
      RowBox[{"pos", "[", 
       RowBox[{"[", "100", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"riB", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", "-", 
          RowBox[{"rB", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", "-", 
          RowBox[{"rB", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", "-", 
          RowBox[{"rB", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reg2", " ", "=", " ", 
      RowBox[{"ImplicitRegion", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Transpose", "[", "riB", "]"}], ".", "B", ".", "riB"}], 
           ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[LessEqual]", " ", 
         "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegionPlot3D", "[", "reg2", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"impA", "-", "B"}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"-", "10"}]}]}], "]"}], "  ", "//", " ", "MatrixForm"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"A", " ", "=", " ", 
      RowBox[{"acceptedEllips", "[", 
       RowBox[{"[", 
        RowBox[{"100", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rA", " ", "=", " ", 
      RowBox[{"pos", "[", 
       RowBox[{"[", "100", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", " ", "=", " ", 
      RowBox[{
       RowBox[{"ellipConvert", "[", 
        RowBox[{"rA", ",", " ", 
         RowBox[{"rotMats", "[", 
          RowBox[{"[", "100", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"B", " ", "=", " ", 
          RowBox[{"acceptedEllips", "[", 
           RowBox[{"[", 
            RowBox[{"50", ",", "2"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rB", " ", "=", " ", 
        RowBox[{"pos", "[", 
         RowBox[{"[", "50", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ellipConvert", "[", 
         RowBox[{"rB", ",", " ", 
          RowBox[{"rotMats", "[", 
           RowBox[{"[", "50", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
        "riA"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", "-", 
            RowBox[{"rA", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", "-", 
            RowBox[{"rA", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", "-", 
            RowBox[{"rA", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", 
        RowBox[{"reg1", " ", "=", " ", 
         RowBox[{"ImplicitRegion", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Transpose", "[", "riA", "]"}], ".", "A", ".", "riA"}],
               ")"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "\[LessEqual]", " ",
             "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"RegionPlot3D", "[", "reg1", "]"}], "\[IndentingNewLine]", 
       RowBox[{"Volume", "[", "reg1", "]"}]}], " ", "-", " ", 
      RowBox[{"pVol", "\[IndentingNewLine]", 
       RowBox[{"ellipDisjoint", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rA", ",", "A"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"rB", ",", "B"}], "}"}]}], "]"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8473783515628242`*^9, 3.8473783914725037`*^9}, {
   3.847378855570073*^9, 3.847378904420579*^9}, {3.847378947752788*^9, 
   3.8473789623838377`*^9}, {3.847379000988656*^9, 3.847379011709354*^9}, {
   3.8473794632948*^9, 3.847379720036367*^9}, {3.847379750952951*^9, 
   3.847379790032209*^9}, {3.847379841408977*^9, 3.847379842107977*^9}, {
   3.847379879356625*^9, 3.847379888883243*^9}, {3.847379934695279*^9, 
   3.847380071496297*^9}, {3.847382426493907*^9, 3.84738245394674*^9}, {
   3.8473824862470837`*^9, 3.8473825533942327`*^9}, {3.847383421236355*^9, 
   3.847383425231031*^9}, {3.847390133587957*^9, 3.847390148446392*^9}, {
   3.847390724651414*^9, 3.847390724839796*^9}, 3.8473919570881443`*^9, {
   3.8473967421293983`*^9, 3.84739675425356*^9}, {3.84739683741215*^9, 
   3.847396838644792*^9}, {3.84739877486369*^9, 3.847398786422103*^9}, {
   3.847399025577532*^9, 3.8473990381906557`*^9}, {3.84741401541439*^9, 
   3.847414031998231*^9}, {3.8474141087349567`*^9, 3.847414163398362*^9}, {
   3.847414213601132*^9, 3.847414523992817*^9}, {3.8474146727125998`*^9, 
   3.847414757486841*^9}, {3.8474147900568132`*^9, 3.847414932327395*^9}, {
   3.847414999252987*^9, 3.8474150364870234`*^9}, {3.84741606022119*^9, 
   3.847416120201062*^9}, {3.847417316111264*^9, 3.847417372182691*^9}, {
   3.8474174072754517`*^9, 3.8474174198359613`*^9}, {3.847417496656329*^9, 
   3.8474174974398613`*^9}, {3.847417631888126*^9, 3.847417715388311*^9}, {
   3.847417750669216*^9, 3.8474178393972178`*^9}, {3.847464104563737*^9, 
   3.8474641347124577`*^9}, {3.8476844738860598`*^9, 3.84768449687952*^9}, {
   3.847685029570368*^9, 3.847685073346923*^9}, {3.847685142712669*^9, 
   3.847685165263205*^9}, {3.847685540996591*^9, 
   3.8476855413064547`*^9}},ExpressionUUID->"345ee9ea-237e-4919-a813-\
a9d9e1c12bcf"],

Cell[CellGroupData[{

Cell[BoxData["1"], "Print",
 CellChangeTimes->{{3.847685026662292*^9, 3.847685074016161*^9}, 
   3.8476851663404016`*^9},
 CellLabel->
  "During evaluation of \
In[485]:=",ExpressionUUID->"0777e976-fb06-4189-af00-24ba814437a4"],

Cell[BoxData["10"], "Print",
 CellChangeTimes->{{3.847685026662292*^9, 3.847685074016161*^9}, 
   3.8476851663419323`*^9},
 CellLabel->
  "During evaluation of \
In[485]:=",ExpressionUUID->"6d989847-b22a-499b-bd55-08c587cfcece"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.01`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.0000000000000002`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.0000000000000004`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.847685026691771*^9, 3.847685074018918*^9}, 
   3.847685166343376*^9},
 CellLabel->
  "Out[490]=",ExpressionUUID->"7c21e505-3c03-4160-b05b-0a2ab75aea7c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"31.993234547278632`", "\[VeryThinSpace]", "+", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "15.44657033973138`"}], "+", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "33.93047641675503`"}], "+", "z"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.847685026691771*^9, 3.847685074018918*^9}, 
   3.8476851663449783`*^9},
 CellLabel->
  "Out[493]=",ExpressionUUID->"541188eb-1f09-4763-b2ee-29aee5d7dac1"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    InterpretationBox["\<\"0.646917\"\>",
     0.6469171256410347,
     AutoDelete->True], ",", 
    InterpretationBox["\<\"0\"\>",
     0,
     Editable->False], ",", 
    InterpretationBox["\<\"-0.76256\"\>",
     -0.7625603140357673,
     AutoDelete->True], ",", 
    InterpretationBox["\<\"0.00000316443\"\>",
     3.1644302818136003`*^-6,
     AutoDelete->True]}], "}"}],
  DecimalForm]], "Output",
 CellChangeTimes->{{3.847685026691771*^9, 3.847685074018918*^9}, 
   3.847685170087893*^9},
 CellLabel->
  "Out[497]//DecimalForm=",ExpressionUUID->"4a1037c5-bad3-46c9-b380-\
5c5ca1d3cd2e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.847377912417282*^9, 
  3.847377912426483*^9}},ExpressionUUID->"a5b82db1-3cac-4b4b-9e9e-\
8733a0296298"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8473761197072277`*^9, 
  3.847376119708239*^9}},ExpressionUUID->"ecc54030-d10b-4bce-9bd2-\
593043a4468f"]
},
WindowSize->{Full, Full},
WindowMargins->{{117, Automatic}, {Automatic, 15}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cc0d7e7b-2594-43a5-8ccb-de769b972d0e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 52263, 1200, 3601, "Input",ExpressionUUID->"3ab854b5-4d98-48b8-94d7-c4d2fcc9dbbc"],
Cell[CellGroupData[{
Cell[52868, 1226, 1444, 24, 24, "Print",ExpressionUUID->"502553a2-c582-4c82-8c9b-e4b9e753519b"],
Cell[54315, 1252, 1444, 24, 24, "Print",ExpressionUUID->"6e8b3434-b2a4-4b3f-a846-a6977580d06e"],
Cell[55762, 1278, 1444, 24, 24, "Print",ExpressionUUID->"db6ad24c-18e5-4adc-92f9-8cb51435afc6"],
Cell[57209, 1304, 1444, 24, 24, "Print",ExpressionUUID->"3cdcef35-bba8-4410-afd4-0d69764f4ac1"],
Cell[58656, 1330, 1444, 24, 24, "Print",ExpressionUUID->"911cc3db-c8bc-4a22-80d7-5196d4ec6948"],
Cell[60103, 1356, 1446, 24, 24, "Print",ExpressionUUID->"a1b8876d-28dc-42bf-b168-868c34ac9d89"],
Cell[61552, 1382, 1446, 24, 24, "Print",ExpressionUUID->"2a74a61c-b685-4e18-8f15-ee0581974998"],
Cell[63001, 1408, 1446, 24, 24, "Print",ExpressionUUID->"767de828-eb8d-464e-b267-59fa47798907"],
Cell[64450, 1434, 1444, 24, 24, "Print",ExpressionUUID->"26a5cbfd-47e0-47be-b2b5-d738bbf76ed4"],
Cell[65897, 1460, 1448, 24, 24, "Print",ExpressionUUID->"b6e7c0b3-8191-42b2-8589-ca723d58f110"],
Cell[67348, 1486, 1446, 24, 24, "Print",ExpressionUUID->"d149ee6f-3875-49d8-b5d4-b58d083ff374"],
Cell[68797, 1512, 1446, 24, 24, "Print",ExpressionUUID->"d2830288-4690-46cd-8b86-6725a3101a53"],
Cell[70246, 1538, 1446, 24, 24, "Print",ExpressionUUID->"0dd66f82-98b4-437b-9110-e57bf4611ff6"],
Cell[71695, 1564, 1446, 24, 24, "Print",ExpressionUUID->"5d6986e4-137b-4172-a180-8d2467d85329"],
Cell[73144, 1590, 1445, 24, 24, "Print",ExpressionUUID->"31463f8d-1ae3-4ab9-b3c2-74bb77c62d7b"],
Cell[74592, 1616, 1446, 24, 24, "Print",ExpressionUUID->"06c27ddb-e1bf-4458-8597-84a8e7046d5c"],
Cell[76041, 1642, 1446, 24, 24, "Print",ExpressionUUID->"45cbddea-8442-4e81-90e8-e85ca2871949"],
Cell[77490, 1668, 1446, 24, 24, "Print",ExpressionUUID->"8d520261-dbaa-4f44-a811-7ed7a9a89e31"],
Cell[78939, 1694, 1446, 24, 24, "Print",ExpressionUUID->"97d7bf88-193c-4631-963b-bd56baba6986"],
Cell[80388, 1720, 1446, 24, 24, "Print",ExpressionUUID->"0545b31c-5baa-4cd6-8459-9ea11c15916c"]
}, Open  ]],
Cell[81849, 1747, 1344, 21, 34, "Output",ExpressionUUID->"dcf9977d-1454-4ff3-86cd-41b3d7394c93"],
Cell[CellGroupData[{
Cell[83218, 1772, 1448, 24, 24, "Print",ExpressionUUID->"2ce0f855-8a56-47be-aa08-289308b6866c"],
Cell[84669, 1798, 1457, 24, 24, "Print",ExpressionUUID->"2c69f2f6-7c7d-4539-909a-7358ae61a4d4"],
Cell[86129, 1824, 1463, 24, 24, "Print",ExpressionUUID->"4dc8c6c9-ddd3-432d-bbd4-7b3efcc727eb"]
}, Open  ]],
Cell[87607, 1851, 152, 3, 30, InheritFromParent,ExpressionUUID->"c2b80b7b-04d2-40ed-b771-7b9d69f39a3f"],
Cell[87762, 1856, 567, 13, 24, "Message",ExpressionUUID->"1dd0fc6c-3c78-4b64-928d-687091d30031"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88366, 1874, 9178, 231, 787, "Input",ExpressionUUID->"345ee9ea-237e-4919-a813-a9d9e1c12bcf"],
Cell[CellGroupData[{
Cell[97569, 2109, 227, 5, 24, "Print",ExpressionUUID->"0777e976-fb06-4189-af00-24ba814437a4"],
Cell[97799, 2116, 228, 5, 24, "Print",ExpressionUUID->"6d989847-b22a-499b-bd55-08c587cfcece"]
}, Open  ]],
Cell[98042, 2124, 490, 13, 34, "Output",ExpressionUUID->"7c21e505-3c03-4160-b05b-0a2ab75aea7c"],
Cell[98535, 2139, 524, 15, 34, "Output",ExpressionUUID->"541188eb-1f09-4763-b2ee-29aee5d7dac1"],
Cell[99062, 2156, 644, 21, 45, "Output",ExpressionUUID->"4a1037c5-bad3-46c9-b380-5c5ca1d3cd2e"]
}, Open  ]],
Cell[99721, 2180, 152, 3, 30, "Input",ExpressionUUID->"a5b82db1-3cac-4b4b-9e9e-8733a0296298"],
Cell[99876, 2185, 154, 3, 30, "Input",ExpressionUUID->"ecc54030-d10b-4bce-9bd2-593043a4468f"]
}
]
*)


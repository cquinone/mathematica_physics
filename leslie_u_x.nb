(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     74078,       1826]
NotebookOptionsPosition[     73116,       1797]
NotebookOutlinePosition[     73510,       1813]
CellTagsIndexPosition[     73467,       1810]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "define", " ", "and", " ", "solve", " ", "matrices", " ", "for", " ", 
     "non"}], "-", 
    RowBox[{"frank", " ", "form", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"is", " ", "htis", " ", "saying"}], ",", " ", 
       RowBox[{"size", " ", ">>", " ", 
        RowBox[{"K", " ", "stuff"}]}], ",", " ", "or", ",", " ", 
       RowBox[{"just", " ", "ignore", " ", "K", " ", "for", " ", 
        RowBox[{"now", "?"}]}]}], ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{"dynamics", " ", "eq", " ", "of", " ", "nhat"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DnDt", "[", 
     RowBox[{
     "v_", ",", "gradn_", ",", "nhat_", ",", "antiv_", ",", "\[Lambda]_", ",",
       "symmv_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"v", ".", "gradn"}]}], " ", "+", " ", 
     RowBox[{"nhat", ".", "antiv"}], " ", "+", " ", 
     RowBox[{"\[Lambda]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"symmv", ".", "nhat"}], " ", "-", " ", 
        RowBox[{"nhat", 
         RowBox[{"(", 
          RowBox[{"nhat", ".", "symmv", ".", "nhat"}], ")"}]}]}], ")"}]}]}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "set", " ", "simplest", " ", "form", " ", "for", " ", "stuff", " ", 
     "right", " ", "here"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"gamma", "*", 
        RowBox[{"(", 
         RowBox[{"1", "/", "R"}], ")"}], "*", "r", "*", "z"}], ",", "0"}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"gamma", " ", "=", " ", 
     RowBox[{"Omega", "/", "gap"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "r"}], "]"}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], " ",
           "-", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "r"}], ")"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}
       }], "\[NoBreak]", ")"}]}], "  ", ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "\[Theta]", " ", "is", " ", "rotation", " ", "angle", " ", "in", " ", 
     "cyl", " ", "coords"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symmv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "+", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "-", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vR", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"gamma", "*", 
        RowBox[{"(", 
         RowBox[{"1", "/", "R"}], ")"}], "*", "R", "*", "z"}], ",", "0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"vR", "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "0"}], "}"}], ".", "gradv"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dont", " ", "propose", " ", "form", " ", "for", " ", "n"}], 
       ".."}], " ", "but", " ", "use", " ", "theta", " ", "derivs"}], " ", 
     "\[Rule]", " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", "nt"}], "/", "r"}], 
         RowBox[{"nr", "/", "r"}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"DnDt", "[", 
           RowBox[{
           "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
            ",", "symmv"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"nr", "^", "2"}], "+", 
          RowBox[{"nt", "^", "2"}], "+", 
          RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", "1"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "here", " ", "is", " ", "switch", " ", "n", " ", "and", " ", "gradn", 
      " ", "to", " ", "phi"}], ",", " ", 
     RowBox[{"alpha", " ", "stuff"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nhat", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "/", "r"}], 
         RowBox[{
          RowBox[{"nhat", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "r"}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Old Dynamics vector:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"solve", " ", "for", " ", "phi"}], ",", " ", 
     RowBox[{"alph", " ", "simple", " ", "lambda", " ", "vals"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"firstEQ", " ", "=", " ", 
     RowBox[{
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"secondEQ", " ", "=", " ", 
     RowBox[{
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thirdEQ", " ", "=", " ", 
     RowBox[{
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"firstEQ", "\[Equal]", "0"}], "&&", 
         RowBox[{"secondEQ", "\[Equal]", "0"}], "&&", 
         RowBox[{"thirdEQ", "\[Equal]", "0"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Phi]", ",", "\[Alpha]"}], "}"}]}], "]"}], "]"}], ";"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "here", " ", "is", " ", "switch", " ", "to", " ", "imposed", " ", 
      "cartesian", " ", "gradv"}], ",", " ", 
     RowBox[{"gradn", " ", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"v", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalOmega]", "/", "H"}], " ", ")"}], 
         RowBox[{"(", 
          RowBox[{"R", "+", "h"}], ")"}], "\[CapitalDelta]"}], ",", "0"}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gradv", " ", "=", " ", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "h"}], "]"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "h"}], "]"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "h"}], "]"}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"R", "+", "h"}], ")"}]}], ")"}], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], 
           " ", "-", " ", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"R", "+", "h"}], ")"}]}]}], 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"R", "+", "h"}], ")"}]}], ")"}], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"v", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], 
           "+", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"R", "+", "h"}], ")"}]}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"R", "+", "h"}], ")"}]}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}]},
         {
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\[CapitalDelta]"}], "]"}], 
          
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\[CapitalDelta]"}], "]"}], 
          
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[CapitalDelta]"}], "]"}]}
        }], "\[NoBreak]", ")"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"gradn", " ", "=", " ", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"dnrdr", "dntdr", "dnzdr"},
         {
          RowBox[{
           RowBox[{"-", 
            RowBox[{"nhat", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"R", "+", "h"}], ")"}]}], 
          RowBox[{
           RowBox[{"nhat", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"R", "+", "h"}], ")"}]}], "0"},
         {"dnrdz", "dntdz", "dnzdz"}
        }], "\[NoBreak]", ")"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symmv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "+", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "-", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"eqs", " ", "for", " ", "stability", " ", "matrix"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phidot", "[", 
     RowBox[{
     "v_", ",", "gradn_", ",", "nhat_", ",", "antiv_", ",", "\[Lambda]_", ",",
       "symmv_", ",", "nhat_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], ")"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"phidot", "[", 
      RowBox[{
      "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
       "symmv", ",", "nhat"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphadot", "[", 
     RowBox[{
     "v_", ",", "gradn_", ",", "nhat_", ",", "antiv_", ",", "\[Lambda]_", ",",
       "symmv_", ",", "nhat_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], ")"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"alphadot", "[", 
      RowBox[{
      "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
       "symmv", ",", "nhat"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"phidot", "[", 
        RowBox[{
        "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
         "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}]}
       }], "\[NoBreak]", ")"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"phi_", ",", "alph_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]},
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{
            "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", 
             ",", "symmv", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]}
      }], "\[NoBreak]", ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", "[", "\"\<Stability matrix: \>\"", "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"m", "[", 
       RowBox[{"\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"m", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], ",", 
        RowBox[{"-", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"-", 
           FractionBox[
            SqrtBox[
             RowBox[{"1", "+", "\[Lambda]"}]], 
            RowBox[{
             SqrtBox["2"], " ", 
             SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "-", " ", "DEFINITE"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
     " ", "STUFF", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"ABOVE", " ", "--"}], "--"}], "--"}], "--"}], 
               "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
        "--"}], "--"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", " ", "arbitrary"}]}]}]}], " ", "function", " ", 
      "stuff"}], ",", " ", 
     RowBox[{"new", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"cell", " ", "--"}], "--"}], "--"}], "--"}]}]}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gradientV", "[", 
      RowBox[{"\[Gamma]_", ",", "r_", ",", "z_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox[
          RowBox[{"\[Gamma]", "*", "z"}], "R"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Gamma]", "*", "z"}], "R"]}], ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"\[Gamma]", "*", "r"}], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   
   RowBox[{"(*", " ", 
    RowBox[{
    "\[Theta]", " ", "is", " ", "rotation", " ", "angle", " ", "in", " ", 
     "cyl", " ", "coords"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"now", " ", "switch", " ", "to", " ", "u"}], ",", "x", ",", 
     RowBox[{"y", "!"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vtheta", "=", " ", 
     RowBox[{"gamma", "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"u", "/", "R"}]}], ")"}], "*", "y"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "vtheta", ",", "0"}], "}"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"gradientV", "[", 
      RowBox[{"gamma", ",", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"u", "/", "R"}]}], ")"}], ",", "y"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symmv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "+", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"antiv", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"gradv", " ", "-", " ", 
        RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"nhat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], ";"}], "*)"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"may", " ", "need", " ", "to", " ", "switch", " ", "form", " ", 
      RowBox[{"too", "?", " ", "or"}], " ", "are", " ", "these", " ", "nr", 
      RowBox[{"(", 
       RowBox[{"u", ",", "x", ",", "y"}], ")"}]}], ",", " ", 
     RowBox[{"implicitly", "?"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradn", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"dnrdr", "dntdr", "dnzdr"},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nhat", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"R", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"u", "/", "R"}]}], ")"}]}], ")"}]}], 
         RowBox[{
          RowBox[{"nhat", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"R", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"u", "/", "R"}]}], ")"}]}], ")"}]}], "0"},
        {"dnrdz", "dntdz", "dnzdz"}
       }], "\[NoBreak]", ")"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"these", " ", "are", " ", "the", " ", "same"}], "..."}], " ", 
     "though", " ", "switch", " ", "to", " ", "f", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"u", ",", "x"}], ")"}], "?"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wrongNdot", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"DnDt", "[", 
       RowBox[{
       "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", "\[Lambda]", ",", 
        "symmv"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"pre", " ", "hat", " ", "rearrange"}], " ", "..."}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi", " ", "=", " ", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"x", "/", "u"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ndot", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"wrongNdot", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Cos", "[", "phi", "]"}]}], " ", "-", "  ", 
        RowBox[{
         RowBox[{"wrongNdot", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{"Sin", "[", "phi", "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"wrongNdot", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"Sin", "[", "phi", "]"}]}], " ", "+", "  ", 
        RowBox[{
         RowBox[{"wrongNdot", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{"Cos", "[", "phi", "]"}]}]}], ",", 
       RowBox[{"wrongNdot", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"using", " ", "u"}], ",", "x", ",", "y", ",", " ", 
     RowBox[{
      RowBox[{"[", "1", "]"}], " ", "\[Rule]", " ", "u"}], ",", " ", 
     RowBox[{
      RowBox[{"[", "2", "]"}], " ", "\[Rule]", " ", "x"}], ",", " ", "etc"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"planar", " ", "=", " ", 
     RowBox[{"Limit", "[", 
      RowBox[{"ndot", ",", 
       RowBox[{"R", "\[Rule]", " ", "Infinity"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<planar sols now: \>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"planar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{"planar", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{"planar", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "\[Alpha]"}], "}"}]}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Quiet", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"planar", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{"planar", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{"planar", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"nr", "^", "2"}], " ", "+", " ", 
          RowBox[{"nt", "^", "2"}], " ", "+", " ", 
          RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], "]"}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newNdot", " ", "=", " ", 
     RowBox[{"ndot", " ", "-", " ", "planar"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", "ndot", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", "planar", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"FullSimplify", "[", "newNdot", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"MatrixForm", "[", "ndot", "]"}], " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]", " ", "\[Rule]", " ", 
         RowBox[{"Pi", "/", "2"}]}], ",", 
        RowBox[{"\[Alpha]", "\[Rule]", " ", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"-", 
            FractionBox[
             SqrtBox[
              RowBox[{"1", "+", "\[Lambda]"}]], 
             RowBox[{
              SqrtBox["2"], " ", 
              SqrtBox["\[Lambda]"]}]]}], "]"}]}]}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newphidot", "[", 
     RowBox[{"ndot_", ",", "nhat_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", "ndot", ")"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newalphadot", "[", 
     RowBox[{"ndot_", ",", "nhat_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", "ndot", ")"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phidotdphi", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"newphidot", "[", 
        RowBox[{"ndot", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phidotdalpha", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"newphidot", "[", 
        RowBox[{"ndot", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphadotdphi", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"newalphadot", "[", 
        RowBox[{"ndot", ",", "nhat"}], "]"}], ",", "\[Phi]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"alphadotdalpha", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"newalphadot", "[", 
        RowBox[{"ndot", ",", "nhat"}], "]"}], ",", "\[Alpha]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"alphadotdalpha", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Phi]", " ", "\[Rule]", " ", 
         RowBox[{"Pi", "/", "2"}]}], ",", " ", 
        RowBox[{"\[Alpha]", "\[Rule]", " ", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"-", 
            FractionBox[
             SqrtBox[
              RowBox[{"1", "+", "\[Lambda]"}]], 
             RowBox[{
              SqrtBox["2"], " ", 
              SqrtBox["\[Lambda]"]}]]}], "]"}]}]}]}], "}"}]}], " ", "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newm", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"phidotdphi", "phidotdalpha"},
        {"alphadotdphi", "alphadotdalpha"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{"newm", " ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", " ", "\[Rule]", " ", 
            RowBox[{"Pi", "/", "2"}]}], ",", " ", 
           RowBox[{"\[Alpha]", "\[Rule]", " ", 
            RowBox[{"-", 
             RowBox[{"ArcCos", "[", 
              RowBox[{"-", 
               FractionBox[
                SqrtBox[
                 RowBox[{"1", "+", "\[Lambda]"}]], 
                RowBox[{
                 SqrtBox["2"], " ", 
                 SqrtBox["\[Lambda]"]}]]}], "]"}]}]}]}], "}"}]}], "]"}], 
       "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Phi]", " ", "\[Rule]", " ", 
           RowBox[{"Pi", "/", "2"}]}], ",", " ", 
          RowBox[{"\[Alpha]", "\[Rule]", " ", 
           RowBox[{"-", 
            RowBox[{"ArcCos", "[", 
             RowBox[{"-", 
              FractionBox[
               SqrtBox[
                RowBox[{"1", "+", "\[Lambda]"}]], 
               RowBox[{
                SqrtBox["2"], " ", 
                SqrtBox["\[Lambda]"]}]]}], "]"}]}]}]}], "}"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"planarstab", " ", "=", " ", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"-", 
             FractionBox[
              RowBox[{"gamma", " ", 
               SqrtBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Lambda]"}]], " ", 
               SqrtBox[
                RowBox[{"1", "+", "\[Lambda]"}]]}], 
              RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 FractionBox[
                  SuperscriptBox["x", "2"], 
                  SuperscriptBox["u", "2"]]}]]}]]}], 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"gamma", " ", "x", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}]}], 
              RowBox[{"u", " ", 
               SqrtBox[
                RowBox[{"2", "+", 
                 FractionBox[
                  RowBox[{"2", " ", 
                   SuperscriptBox["x", "2"]}], 
                  SuperscriptBox["u", "2"]]}]], " ", 
               SqrtBox[
                FractionBox["\[Lambda]", 
                 RowBox[{"1", "+", "\[Lambda]"}]]]}]]}]},
           {
            FractionBox[
             RowBox[{"gamma", " ", "x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}]}], 
             RowBox[{"2", " ", "u", " ", 
              SqrtBox[
               RowBox[{"2", "+", 
                FractionBox[
                 RowBox[{"2", " ", 
                  SuperscriptBox["x", "2"]}], 
                 SuperscriptBox["u", "2"]]}]], " ", 
              SqrtBox[
               FractionBox["\[Lambda]", 
                RowBox[{"1", "+", "\[Lambda]"}]]]}]], 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"gamma", " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Lambda]"}], "\[Lambda]"]], " ", 
               
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]], "+", "\[Lambda]", "+", 
                 RowBox[{
                  SqrtBox[
                   RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]], " ", "\[Lambda]"}]}], 
                ")"}]}], 
              RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{"1", "+", 
                 FractionBox[
                  SuperscriptBox["x", "2"], 
                  SuperscriptBox["u", "2"]]}]], " ", 
               SqrtBox[
                FractionBox["\[Lambda]", 
                 RowBox[{"1", "+", "\[Lambda]"}]]]}]]}]}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fullstab", " ", "=", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gamma", " ", 
              RowBox[{"(", 
               RowBox[{"R", "+", "u"}], ")"}], " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Lambda]"}]], " ", 
              SqrtBox[
               RowBox[{"1", "+", "\[Lambda]"}]]}], 
             RowBox[{"2", " ", "R", " ", 
              SqrtBox[
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox["x", "2"], 
                 SuperscriptBox["u", "2"]]}]]}]]}], 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gamma", " ", 
              RowBox[{"(", 
               RowBox[{"R", "+", "u"}], ")"}], " ", "x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}]}], 
             RowBox[{"R", " ", "u", " ", 
              SqrtBox[
               RowBox[{"2", "+", 
                FractionBox[
                 RowBox[{"2", " ", 
                  SuperscriptBox["x", "2"]}], 
                 SuperscriptBox["u", "2"]]}]], " ", 
              SqrtBox[
               FractionBox["\[Lambda]", 
                RowBox[{"1", "+", "\[Lambda]"}]]]}]]}]},
          {
           FractionBox[
            RowBox[{"gamma", " ", 
             RowBox[{"(", 
              RowBox[{"R", "+", "u"}], ")"}], " ", "x", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}]}], 
            RowBox[{"2", " ", "R", " ", "u", " ", 
             SqrtBox[
              RowBox[{"2", "+", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["x", "2"]}], 
                SuperscriptBox["u", "2"]]}]], " ", 
             SqrtBox[
              FractionBox["\[Lambda]", 
               RowBox[{"1", "+", "\[Lambda]"}]]]}]], 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"gamma", " ", 
              RowBox[{"(", 
               RowBox[{"R", "+", "u"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Lambda]"}], "\[Lambda]"]], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  FractionBox[
                   SuperscriptBox["x", "2"], 
                   SuperscriptBox["u", "2"]]}]], "+", "\[Lambda]", "+", 
                RowBox[{
                 SqrtBox[
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]], " ", "\[Lambda]"}]}], 
               ")"}]}], 
             RowBox[{"2", " ", "R", " ", 
              SqrtBox[
               RowBox[{"1", "+", 
                FractionBox[
                 SuperscriptBox["x", "2"], 
                 SuperscriptBox["u", "2"]]}]], " ", 
              SqrtBox[
               FractionBox["\[Lambda]", 
                RowBox[{"1", "+", "\[Lambda]"}]]]}]]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"Eigenvalues", "[", "fullstab", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"MatrixForm", "[", "d", "]"}], ",", " ", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ">", "1"}], "}"}]}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Planar", " ", 
      RowBox[{"checks", "!!"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"mPlanar", "[", 
       RowBox[{"phi_", ",", "alph_"}], "]"}]}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"phidot", "[", 
                RowBox[{
                "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", 
                 "\[Lambda]", ",", "symmv", ",", "nhat"}], "]"}], ",", 
               RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], ",", "\[Phi]"}],
             "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
             RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"phidot", "[", 
                RowBox[{
                "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", 
                 "\[Lambda]", ",", "symmv", ",", "nhat"}], "]"}], ",", 
               RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], ",", 
             "\[Alpha]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
             RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]},
         {
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"alphadot", "[", 
                RowBox[{
                "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", 
                 "\[Lambda]", ",", "symmv", ",", "nhat"}], "]"}], ",", 
               RowBox[{"R", "\[Rule]", " ", "Infinity"}]}], "]"}], ",", 
             "\[Phi]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
             RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}], 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Limit", "[", 
              RowBox[{
               RowBox[{"alphadot", "[", 
                RowBox[{
                "v", ",", "gradn", ",", "nhat", ",", "antiv", ",", 
                 "\[Lambda]", ",", "symmv", ",", "nhat"}], "]"}], ",", 
               RowBox[{"R", "\[Rule]", "Infinity"}]}], "]"}], ",", 
             "\[Alpha]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
             RowBox[{"\[Alpha]", "\[Rule]", "alph"}]}], "}"}]}]}
        }], "\[NoBreak]", ")"}], "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"mPlanar", "[", 
         RowBox[{"\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"mPlanar", "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"-", 
           RowBox[{"ArcCos", "[", 
            RowBox[{"-", 
             FractionBox[
              SqrtBox[
               RowBox[{"1", "+", "\[Lambda]"}]], 
              RowBox[{
               SqrtBox["2"], " ", 
               SqrtBox["\[Lambda]"]}]]}], "]"}]}]}], "]"}], "]"}], "]"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      TagBox[
       RowBox[{"(", "\[NoBreak]", 
        TagBox[GridBox[{
           {
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], 
                 SuperscriptBox["nt", "2"], "\[Lambda]"}], "+", " ", 
                "\[Lambda]", " ", "+", "1"}], ")"}], " ", "x"}], "+", 
             RowBox[{"(", 
              RowBox[{"2", "nr", " ", "nt", " ", "u", " ", "\[Lambda]"}], " ",
               ")"}], " "}]},
           {
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "\[Lambda]", "-", 
                RowBox[{"2", " ", 
                 SuperscriptBox["nt", "2"], " ", "\[Lambda]"}]}], ")"}], 
              "u"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "nr", " ", "nt", " ", "x", " ", 
               "\[Lambda]"}], ")"}]}]},
           {
            RowBox[{" ", 
             RowBox[{"nt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Lambda]", "-", 
                RowBox[{"2", " ", 
                 SuperscriptBox["nz", "2"], " ", "\[Lambda]"}]}], ")"}]}]}]}
          },
          GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
          
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.5599999999999999]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}],
         Column], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "full"}], ",", " ", 
     RowBox[{"with", " ", 
      RowBox[{"pi", "/", "2"}], " ", "in", " ", "plane", " ", "plug", " ", 
      "in", " ", 
      RowBox[{"(", 
       RowBox[{"not", " ", "alph", " ", "yet"}], ")"}], "\[IndentingNewLine]", 
      TagBox[
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "gamma", " ", 
              RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"nr", " ", "u"}], "-", 
                   RowBox[{"nt", " ", "x"}]}], ")"}], " ", "y"}], "+", 
                RowBox[{"u", " ", 
                 RowBox[{"(", 
                  RowBox[{"R", "+", "u"}], ")"}], " ", 
                 SqrtBox[
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]], " ", 
                 RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ")"}]}], "+", 
             RowBox[{"gamma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "4"}], " ", "x", " ", "y", " ", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Alpha]", "]"}], "2"]}], "-", 
                RowBox[{"u", " ", 
                 RowBox[{"(", 
                  RowBox[{"R", "+", "u"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "\[Lambda]"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SqrtBox[
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]]}], ")"}], " ", "\[Lambda]", 
                    " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}]}], 
            RowBox[{"4", " ", "R", " ", "u", " ", 
             SqrtBox[
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox["x", "2"], 
                SuperscriptBox["u", "2"]]}]]}]], 
           FractionBox[
            RowBox[{
             RowBox[{"gamma", " ", 
              RowBox[{"(", 
               RowBox[{"R", "+", "u"}], ")"}], " ", "x", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "+", "\[Lambda]"}], ")"}], " ", 
                 RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "-", 
                RowBox[{"3", " ", "\[Lambda]", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"3", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}], "-", 
             RowBox[{"4", " ", "gamma", " ", "u", " ", "y", " ", 
              RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], 
            RowBox[{"4", " ", "R", " ", "u", " ", 
             SqrtBox[
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox["x", "2"], 
                SuperscriptBox["u", "2"]]}]]}]]},
          {
           FractionBox[
            RowBox[{"gamma", " ", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u", " ", "y"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"R", "+", "u"}], ")"}], " ", "x", " ", "\[Lambda]", 
                " ", 
                RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
                RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], ")"}]}], 
            RowBox[{"R", " ", "u", " ", 
             SqrtBox[
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox["x", "2"], 
                SuperscriptBox["u", "2"]]}]]}]], 
           FractionBox[
            RowBox[{
             RowBox[{"gamma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"nr", " ", "u"}], "-", 
                RowBox[{"nt", " ", "x"}]}], ")"}], " ", "y", " ", 
              RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "+", 
             RowBox[{"gamma", " ", "x", " ", "y", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Alpha]"}], "]"}]}], "-", 
             RowBox[{
              FractionBox["1", "2"], " ", "gamma", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"R", "+", "u"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SqrtBox[
                 RowBox[{"1", "+", 
                  FractionBox[
                   SuperscriptBox["x", "2"], 
                   SuperscriptBox["u", "2"]]}]], "+", "\[Lambda]", "+", 
                RowBox[{
                 SqrtBox[
                  RowBox[{"1", "+", 
                   FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]], " ", "\[Lambda]"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   SqrtBox[
                    RowBox[{"1", "+", 
                    FractionBox[
                    SuperscriptBox["x", "2"], 
                    SuperscriptBox["u", "2"]]}]]}], ")"}], " ", "\[Lambda]", 
                 " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], 
            RowBox[{"R", " ", "u", " ", 
             SqrtBox[
              RowBox[{"1", "+", 
               FractionBox[
                SuperscriptBox["x", "2"], 
                SuperscriptBox["u", "2"]]}]]}]]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], "\[NoBreak]", ")"}],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8266752799540854`*^9, 3.8266753071948223`*^9}, {
   3.826675664843732*^9, 3.8266756901798983`*^9}, {3.826675869053034*^9, 
   3.826675988497328*^9}, {3.82667603722441*^9, 3.826676268554097*^9}, {
   3.826676384735524*^9, 3.826676431675276*^9}, {3.8266765121851597`*^9, 
   3.8266767612926903`*^9}, {3.826676820305739*^9, 3.826676985177932*^9}, {
   3.826677026541018*^9, 3.8266770738015623`*^9}, {3.826677109504314*^9, 
   3.8266771184989862`*^9}, {3.826677153028069*^9, 3.826677178498794*^9}, {
   3.826677219719841*^9, 3.826677297141605*^9}, {3.826677356180641*^9, 
   3.82667740141089*^9}, {3.826677453720838*^9, 3.826677610289278*^9}, {
   3.8266850741666937`*^9, 3.826685104498743*^9}, {3.8266851585717897`*^9, 
   3.826685177385954*^9}, {3.8266867655545053`*^9, 3.8266867949417677`*^9}, {
   3.8266868269174747`*^9, 3.8266869441441183`*^9}, {3.826686993526887*^9, 
   3.8266870852828503`*^9}, {3.826687187078718*^9, 3.8266874311784678`*^9}, {
   3.8266874718308353`*^9, 3.826687512579859*^9}, {3.8266875732310534`*^9, 
   3.826687581565832*^9}, {3.82668779224944*^9, 3.826687926275687*^9}, {
   3.826687983236977*^9, 3.8266880629178*^9}, {3.826688100172669*^9, 
   3.826688203820545*^9}, {3.82668828038172*^9, 3.8266883937544727`*^9}, {
   3.826688440129004*^9, 3.8266884439559813`*^9}, {3.826688488348743*^9, 
   3.826688545842688*^9}, {3.8266887128364487`*^9, 3.8266887460881987`*^9}, {
   3.8266887763351717`*^9, 3.826688784396687*^9}, {3.8266888253648243`*^9, 
   3.8266888337491283`*^9}, {3.826688877385788*^9, 3.826688884598859*^9}, {
   3.8266889741716213`*^9, 3.826689009699057*^9}, {3.8266902857176867`*^9, 
   3.8266903066340837`*^9}, {3.826697617996537*^9, 3.8266976324928637`*^9}, {
   3.826697687785988*^9, 3.826697793666182*^9}, {3.826697833961116*^9, 
   3.826697940399906*^9}, {3.8266981065181713`*^9, 3.826698151825027*^9}, {
   3.8266981836610203`*^9, 3.826698186648077*^9}, {3.826698325071155*^9, 
   3.8266983781926517`*^9}, {3.826698413513307*^9, 3.826698502122808*^9}, 
   3.826849042072997*^9, {3.826849084035697*^9, 3.826849102433227*^9}, {
   3.8268491360807333`*^9, 3.826849218269122*^9}, {3.826849275660131*^9, 
   3.8268492790226383`*^9}, {3.826849312667118*^9, 3.826849314199774*^9}, {
   3.826849378934092*^9, 3.8268493892303534`*^9}, 3.826849426204302*^9, {
   3.8268494627770653`*^9, 3.8268494796039143`*^9}, {3.826849669814518*^9, 
   3.826849787626096*^9}, {3.826851651265483*^9, 3.826851718933124*^9}, {
   3.826851759340425*^9, 3.8268517881026087`*^9}, {3.826851931225995*^9, 
   3.826851960141914*^9}, {3.826851990812619*^9, 3.826852035255816*^9}, {
   3.8268520674348*^9, 3.826852070711692*^9}, {3.826852246335545*^9, 
   3.826852303030847*^9}, 3.826852379100375*^9, {3.826852685582899*^9, 
   3.826852686287402*^9}, {3.826852758154278*^9, 3.82685281802089*^9}, {
   3.8268530193873453`*^9, 3.8268531262635517`*^9}, {3.826853174522757*^9, 
   3.826853185170986*^9}, {3.826853237171986*^9, 3.8268533100304613`*^9}, {
   3.82685334633039*^9, 3.82685340885181*^9}, {3.8268534660204773`*^9, 
   3.8268534706678247`*^9}, {3.8268535391953573`*^9, 3.826853583876688*^9}, {
   3.8268582864023943`*^9, 3.826858361399314*^9}, {3.826858402084729*^9, 
   3.826858402213182*^9}, {3.8268584354962177`*^9, 3.826858437238428*^9}, {
   3.826858476305705*^9, 3.826858537086557*^9}, 3.826858594237236*^9, {
   3.826858642199092*^9, 3.8268587037224607`*^9}, {3.826858801720055*^9, 
   3.826858802208788*^9}, {3.827292782625389*^9, 3.827292827870491*^9}, {
   3.827312130448621*^9, 3.827312293533786*^9}, {3.827312402961833*^9, 
   3.827312560450828*^9}, {3.827312608412445*^9, 3.827312722676353*^9}, {
   3.827312795515319*^9, 3.8273128516545763`*^9}, {3.827312894496409*^9, 
   3.8273129123224773`*^9}, {3.827412466108673*^9, 3.8274125116876163`*^9}, {
   3.827412542643824*^9, 3.8274126082356033`*^9}, {3.827412686972869*^9, 
   3.8274126897404003`*^9}, {3.827412804292905*^9, 3.827413006971655*^9}, {
   3.82741305757976*^9, 3.827413121832234*^9}, {3.827413169399618*^9, 
   3.82741320071413*^9}, {3.8274132396326523`*^9, 3.827413252591816*^9}, {
   3.8274133452732267`*^9, 3.827413418810751*^9}, {3.827413511494461*^9, 
   3.827413576301386*^9}, {3.827413633980268*^9, 3.827413690388123*^9}, {
   3.8274137775296*^9, 3.8274138062314043`*^9}, {3.8274138478749037`*^9, 
   3.82741390641532*^9}, {3.827413963143956*^9, 3.82741413013883*^9}, {
   3.827414307675866*^9, 3.82741462214295*^9}, {3.8274146936096*^9, 
   3.827414762140606*^9}, {3.827414917110798*^9, 3.827414994658031*^9}, {
   3.82741503016457*^9, 3.8274155571915083`*^9}, 3.827415593731245*^9, {
   3.827415858903501*^9, 3.827415911820114*^9}, {3.827415949314198*^9, 
   3.827415974322516*^9}, {3.827416005874748*^9, 3.8274161529353857`*^9}, {
   3.827416189223271*^9, 3.8274163061638947`*^9}, {3.8274163403061047`*^9, 
   3.827416497385223*^9}, {3.827416573509686*^9, 3.827416638776935*^9}, {
   3.827416696652032*^9, 3.827416734600984*^9}, {3.827416834757762*^9, 
   3.82741688545956*^9}, 3.827416962461381*^9, {3.827433023210761*^9, 
   3.82743306662418*^9}, {3.8274330971355762`*^9, 3.8274331615219173`*^9}, {
   3.827433346965386*^9, 3.827433352412775*^9}, {3.827433398485186*^9, 
   3.827433409459565*^9}, 3.827457189642198*^9, {3.827457266765684*^9, 
   3.827457362492113*^9}, {3.827457461936749*^9, 3.827457565488484*^9}, {
   3.8274575993922377`*^9, 3.8274576002001266`*^9}, {3.827457678436448*^9, 
   3.827457703562065*^9}, {3.82745774503976*^9, 3.8274577451435757`*^9}, {
   3.827458046362423*^9, 3.8274580500038*^9}, {3.827458159934802*^9, 
   3.8274581661175547`*^9}, {3.827460585060837*^9, 3.82746058964499*^9}, {
   3.8274606515371*^9, 3.8274606836689653`*^9}, {3.82746084518363*^9, 
   3.827460850216016*^9}, {3.827460921460155*^9, 3.827460988407914*^9}, {
   3.827461033947467*^9, 3.8274610425935907`*^9}, 3.8274612094991627`*^9, {
   3.8274612804988203`*^9, 3.827461287013423*^9}, 3.8274613697515078`*^9, {
   3.827461496425355*^9, 3.827461654617276*^9}, {3.827463365114093*^9, 
   3.827463399214134*^9}, {3.8274634687641287`*^9, 3.8274634755001507`*^9}, 
   3.827463665730028*^9, {3.8274639174212933`*^9, 3.827463951933091*^9}, 
   3.827469924955927*^9, {3.827470125386216*^9, 3.827470205588333*^9}, {
   3.82747041793687*^9, 3.827470441199842*^9}, {3.827470496408263*^9, 
   3.8274707569044447`*^9}, {3.827470828721987*^9, 3.827471050454465*^9}, {
   3.827471087753467*^9, 3.8274711677936573`*^9}, {3.82747147419914*^9, 
   3.827471480383353*^9}, {3.82747153230132*^9, 3.827471611306388*^9}, {
   3.827471685584276*^9, 3.827471699557461*^9}, {3.827471825144657*^9, 
   3.827471828087018*^9}, {3.827472240693932*^9, 3.827472259789384*^9}, {
   3.8274722909492903`*^9, 3.827472306007864*^9}, {3.827472403388488*^9, 
   3.827472445227681*^9}, {3.8274724922977858`*^9, 3.827472492702745*^9}, 
   3.827503486645973*^9, 3.827504275254383*^9, 3.82750437737669*^9, {
   3.82750441232094*^9, 3.827504426984379*^9}, {3.827504738854031*^9, 
   3.827504766452173*^9}, {3.827504805783909*^9, 3.827504835078628*^9}, {
   3.8275048698306704`*^9, 3.8275048701618433`*^9}, {3.8275049098103313`*^9, 
   3.827504910348922*^9}, {3.82750502492245*^9, 3.827505064014963*^9}, {
   3.827505095953287*^9, 3.827505101832245*^9}, {3.827505135094254*^9, 
   3.82750515320795*^9}, {3.827505195695133*^9, 3.827505295537561*^9}, {
   3.827505346086179*^9, 3.827505401907023*^9}, {3.827505452499387*^9, 
   3.827505504789558*^9}, {3.827563650932921*^9, 3.827563680268119*^9}, 
   3.827564230345352*^9, 3.827564265014669*^9, {3.8275643731048183`*^9, 
   3.827564407172515*^9}, {3.8275644427155857`*^9, 3.827564464186948*^9}, {
   3.827564632822583*^9, 3.8275646607829847`*^9}, {3.827564714730966*^9, 
   3.827564738172791*^9}, {3.827564792001429*^9, 3.827564913199662*^9}, {
   3.827565224361291*^9, 3.82756530305825*^9}, {3.827567999816489*^9, 
   3.827568014657189*^9}, {3.827569019348083*^9, 3.827569030086828*^9}, {
   3.8275692063587503`*^9, 3.8275692118021517`*^9}, {3.827569379827035*^9, 
   3.82756941873133*^9}, 3.827569471454762*^9, {3.827569528009822*^9, 
   3.82756953142498*^9}, {3.827569784410918*^9, 3.827569811448831*^9}, {
   3.827569844177288*^9, 3.827569892378722*^9}, 3.827569932235701*^9, {
   3.827569971279832*^9, 3.8275700076884613`*^9}, {3.8275700886973877`*^9, 
   3.827570118417234*^9}, {3.8275701993308277`*^9, 3.8275702685090733`*^9}, {
   3.827571088448854*^9, 3.827571131370988*^9}, {3.8275712416474*^9, 
   3.8275712421414967`*^9}, {3.827571452476213*^9, 3.827571455963578*^9}, {
   3.827571533174469*^9, 3.827571556509386*^9}, {3.82757619782028*^9, 
   3.827576244116033*^9}, {3.827576280673643*^9, 3.8275762915095253`*^9}, {
   3.82757635566364*^9, 3.8275763598127327`*^9}, {3.8275763915980043`*^9, 
   3.8275764223877153`*^9}, {3.827591116982288*^9, 3.827591137602104*^9}, {
   3.827591202868785*^9, 3.8275912033320913`*^9}, {3.8275915218779707`*^9, 
   3.827591546020945*^9}, {3.827591693373995*^9, 3.827591707816277*^9}, {
   3.8275917651332903`*^9, 3.827591804460565*^9}, {3.82759194494084*^9, 
   3.8275919615248127`*^9}, {3.827970622682187*^9, 3.827970746088423*^9}, {
   3.8279707891131277`*^9, 3.827970830145863*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"2a6caf09-dd25-47bc-9d77-ea3c64666733"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"gamma", " ", "z"}], "+", 
        FractionBox[
         RowBox[{"gamma", " ", "r", " ", "z"}], "R"]}]},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.827458055213567*^9, 3.827458166653861*^9, 3.82745885822751*^9, {
   3.827460830838456*^9, 3.827460850509301*^9}, {3.827460937386088*^9, 
   3.827460991977654*^9}, {3.827461036504463*^9, 3.827461043418923*^9}, 
   3.8274612107331676`*^9, {3.8274612812583303`*^9, 3.8274612875397587`*^9}, 
   3.8274613702642527`*^9, {3.827461576821958*^9, 3.827461594689555*^9}, 
   3.82746163167225*^9, 3.827463404382229*^9, 3.827463477445513*^9, 
   3.827463666616234*^9, {3.827469908762835*^9, 3.827469925453598*^9}, 
   3.827470128403253*^9, {3.827470165033951*^9, 3.827470206061966*^9}, 
   3.827470453186083*^9, 3.827470709504327*^9, 3.8274707605810747`*^9, {
   3.827470848513569*^9, 3.827470857028172*^9}, 3.827471051584741*^9, 
   3.827471116919012*^9, {3.8274711485782146`*^9, 3.827471168252318*^9}, 
   3.8274714819406357`*^9, 3.827471613080975*^9, 3.827471704001408*^9, 
   3.827472316451089*^9, 3.827472495632039*^9, 3.827504277263919*^9, 
   3.82750437822923*^9, 3.8275044277182207`*^9, 3.8275047682483587`*^9, 
   3.827504840260745*^9, 3.8275049426660023`*^9, 3.827505067006885*^9, 
   3.827505154721242*^9, 3.827505216996459*^9, 3.827505267526763*^9, 
   3.827505298672003*^9, {3.827505385303388*^9, 3.827505402762582*^9}, {
   3.8275054981899643`*^9, 3.827505514033474*^9}, {3.8275636529962883`*^9, 
   3.827563681175562*^9}, 3.827564230865493*^9, 3.827564265553062*^9, 
   3.82756440960809*^9, {3.827564448537993*^9, 3.82756446468256*^9}, {
   3.827564649494255*^9, 3.827564662005601*^9}, 3.8275647852763577`*^9, {
   3.827564870326338*^9, 3.827564880635137*^9}, 3.827564915957777*^9, {
   3.827565251339561*^9, 3.82756530471719*^9}, 3.827568017618849*^9, 
   3.827569035421134*^9, 3.827569213968272*^9, 3.8275693909798*^9, 
   3.827569423974531*^9, 3.8275696601877203`*^9, {3.827569796543453*^9, 
   3.8275698131505938`*^9}, 3.827569869183167*^9, 3.827569923875173*^9, 
   3.8275699827970533`*^9, 3.827570021448985*^9, 3.8275701239893923`*^9, 
   3.82757027089272*^9, 3.827571153826351*^9, 3.827571557731246*^9, 
   3.827576199453073*^9, 3.827576247270603*^9, 3.8275762931262083`*^9, 
   3.827576367629697*^9, 3.827576427730377*^9, {3.827591123873918*^9, 
   3.827591138207987*^9}, 3.827591205293909*^9, 3.827591536549851*^9, 
   3.8275917092709846`*^9, {3.827591780318277*^9, 3.827591809134408*^9}, 
   3.827591964576694*^9, {3.827970648248167*^9, 3.827970664589658*^9}, 
   3.8279707516450243`*^9, 3.827970795720357*^9, 3.8279708332011013`*^9},
 CellLabel->
  "Out[220]//MatrixForm=",ExpressionUUID->"1c3efc34-ae3f-4ff7-87b8-\
2d76a1f4770e"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Old Dynamics vector:\"\>"], "Print",
 CellChangeTimes->{
  3.8274580552113667`*^9, 3.827458166652053*^9, 3.827458858225699*^9, {
   3.8274608308363047`*^9, 3.827460850507491*^9}, {3.8274609372446938`*^9, 
   3.827460991841358*^9}, {3.82746103637255*^9, 3.827461043273633*^9}, 
   3.82746121058886*^9, {3.827461281110868*^9, 3.827461287401926*^9}, 
   3.8274613701256638`*^9, {3.827461576678577*^9, 3.827461594541836*^9}, 
   3.827461631532054*^9, 3.8274634042327967`*^9, 3.82746347730661*^9, 
   3.827463666614258*^9, {3.827469908199897*^9, 3.827469925451457*^9}, 
   3.82747012840091*^9, {3.827470165031494*^9, 3.827470206059493*^9}, 
   3.827470453184278*^9, 3.827470709501946*^9, 3.827470760578475*^9, {
   3.8274708485114307`*^9, 3.827470857025667*^9}, 3.827471051005672*^9, 
   3.8274711169167013`*^9, {3.827471148575592*^9, 3.827471168249867*^9}, 
   3.827471481938065*^9, 3.827471612480617*^9, 3.827471703435829*^9, 
   3.827472315865576*^9, 3.827472495022759*^9, 3.827504277261868*^9, 
   3.8275043782273397`*^9, 3.827504427716217*^9, 3.827504768094882*^9, 
   3.827504840109537*^9, 3.827504942525289*^9, 3.82750506686692*^9, 
   3.8275051545800962`*^9, 3.827505216856839*^9, 3.827505267382938*^9, 
   3.827505297926175*^9, {3.827505385161005*^9, 3.8275054026185637`*^9}, {
   3.8275054980502577`*^9, 3.827505513891159*^9}, {3.8275636520554028`*^9, 
   3.827563681039423*^9}, 3.827564230727089*^9, 3.827564265413074*^9, 
   3.827564409470914*^9, {3.827564448399272*^9, 3.827564464546751*^9}, {
   3.827564649365119*^9, 3.827564661867375*^9}, 3.82756478514193*^9, {
   3.8275648701860733`*^9, 3.827564880503951*^9}, 3.827564915229186*^9, {
   3.827565250607705*^9, 3.827565304087606*^9}, 3.827568016826494*^9, 
   3.827569034693799*^9, 3.827569213274225*^9, 3.827569390853977*^9, 
   3.827569423832899*^9, 3.827569660059423*^9, {3.8275697964105167`*^9, 
   3.8275698130126343`*^9}, 3.8275698690394907`*^9, 3.827569923729095*^9, 
   3.827569982665716*^9, 3.827570021318997*^9, 3.827570123858089*^9, 
   3.827570270725895*^9, 3.827571153138215*^9, 3.827571556972249*^9, 
   3.8275761986728354`*^9, 3.827576246714468*^9, 3.82757629299671*^9, 
   3.8275763674896803`*^9, 3.8275764275902367`*^9, {3.827591122871594*^9, 
   3.827591138039795*^9}, 3.827591205127685*^9, 3.8275915363709517`*^9, 
   3.827591709088605*^9, {3.827591780134823*^9, 3.827591808957357*^9}, 
   3.82759196441607*^9, {3.827970647326893*^9, 3.82797066458792*^9}, 
   3.827970751647519*^9, 3.827970795722122*^9, 3.827970833202915*^9},
 CellLabel->
  "During evaluation of \
In[213]:=",ExpressionUUID->"5ff1cb9d-59ee-4815-9dc5-74245f82a225"],

Cell[BoxData["\<\"planar sols now: \"\>"], "Print",
 CellChangeTimes->{
  3.8274580552113667`*^9, 3.827458166652053*^9, 3.827458858225699*^9, {
   3.8274608308363047`*^9, 3.827460850507491*^9}, {3.8274609372446938`*^9, 
   3.827460991841358*^9}, {3.82746103637255*^9, 3.827461043273633*^9}, 
   3.82746121058886*^9, {3.827461281110868*^9, 3.827461287401926*^9}, 
   3.8274613701256638`*^9, {3.827461576678577*^9, 3.827461594541836*^9}, 
   3.827461631532054*^9, 3.8274634042327967`*^9, 3.82746347730661*^9, 
   3.827463666614258*^9, {3.827469908199897*^9, 3.827469925451457*^9}, 
   3.82747012840091*^9, {3.827470165031494*^9, 3.827470206059493*^9}, 
   3.827470453184278*^9, 3.827470709501946*^9, 3.827470760578475*^9, {
   3.8274708485114307`*^9, 3.827470857025667*^9}, 3.827471051005672*^9, 
   3.8274711169167013`*^9, {3.827471148575592*^9, 3.827471168249867*^9}, 
   3.827471481938065*^9, 3.827471612480617*^9, 3.827471703435829*^9, 
   3.827472315865576*^9, 3.827472495022759*^9, 3.827504277261868*^9, 
   3.8275043782273397`*^9, 3.827504427716217*^9, 3.827504768094882*^9, 
   3.827504840109537*^9, 3.827504942525289*^9, 3.82750506686692*^9, 
   3.8275051545800962`*^9, 3.827505216856839*^9, 3.827505267382938*^9, 
   3.827505297926175*^9, {3.827505385161005*^9, 3.8275054026185637`*^9}, {
   3.8275054980502577`*^9, 3.827505513891159*^9}, {3.8275636520554028`*^9, 
   3.827563681039423*^9}, 3.827564230727089*^9, 3.827564265413074*^9, 
   3.827564409470914*^9, {3.827564448399272*^9, 3.827564464546751*^9}, {
   3.827564649365119*^9, 3.827564661867375*^9}, 3.82756478514193*^9, {
   3.8275648701860733`*^9, 3.827564880503951*^9}, 3.827564915229186*^9, {
   3.827565250607705*^9, 3.827565304087606*^9}, 3.827568016826494*^9, 
   3.827569034693799*^9, 3.827569213274225*^9, 3.827569390853977*^9, 
   3.827569423832899*^9, 3.827569660059423*^9, {3.8275697964105167`*^9, 
   3.8275698130126343`*^9}, 3.8275698690394907`*^9, 3.827569923729095*^9, 
   3.827569982665716*^9, 3.827570021318997*^9, 3.827570123858089*^9, 
   3.827570270725895*^9, 3.827571153138215*^9, 3.827571556972249*^9, 
   3.8275761986728354`*^9, 3.827576246714468*^9, 3.82757629299671*^9, 
   3.8275763674896803`*^9, 3.8275764275902367`*^9, {3.827591122871594*^9, 
   3.827591138039795*^9}, 3.827591205127685*^9, 3.8275915363709517`*^9, 
   3.827591709088605*^9, {3.827591780134823*^9, 3.827591808957357*^9}, 
   3.82759196441607*^9, {3.827970647326893*^9, 3.82797066458792*^9}, 
   3.827970751647519*^9, 3.827970795722122*^9, 3.8279708332764883`*^9},
 CellLabel->
  "During evaluation of \
In[213]:=",ExpressionUUID->"442c3ab1-1a0a-452d-9dbe-b3e12c9ae482"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.827458518923234*^9, 
  3.82745851892461*^9}},ExpressionUUID->"7c49e706-999a-4b40-8458-\
e7aa3c128f91"]
},
WindowSize->{Full, Full},
WindowMargins->{{3, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3b2cec13-6ede-48ee-ba2e-05a6586c5644"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 63986, 1629, 3430, "Input",ExpressionUUID->"2a6caf09-dd25-47bc-9d77-ea3c64666733"],
Cell[64411, 1646, 3236, 60, 84, "Output",ExpressionUUID->"1c3efc34-ae3f-4ff7-87b8-2d76a1f4770e"],
Cell[CellGroupData[{
Cell[67672, 1710, 2630, 38, 24, "Print",ExpressionUUID->"5ff1cb9d-59ee-4815-9dc5-74245f82a225"],
Cell[70305, 1750, 2629, 38, 24, "Print",ExpressionUUID->"442c3ab1-1a0a-452d-9dbe-b3e12c9ae482"]
}, Open  ]]
}, Open  ]],
Cell[72961, 1792, 151, 3, 30, "Input",ExpressionUUID->"7c49e706-999a-4b40-8458-e7aa3c128f91"]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     62630,       1616]
NotebookOptionsPosition[     61952,       1597]
NotebookOutlinePosition[     62347,       1613]
CellTagsIndexPosition[     62304,       1610]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "ALL", " ", "below", " ", "eqs", " ", "are", " ", "assuming", " ", "Q", 
       " ", "is", " ", 
       RowBox[{"uniaxial", "!!"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "matQ"}], " ", "=", " ", 
      RowBox[{"\[Mu]", "*", "z", "*", "s", "*", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{
            RowBox[{"-", "2"}], "*", "nr", "*", "nt"}], 
           RowBox[{
            RowBox[{"nr", "*", "nr"}], "-", 
            RowBox[{"nt", "*", "nt"}]}], 
           RowBox[{
            RowBox[{"-", "nt"}], "*", "nz"}]},
          {
           RowBox[{
            RowBox[{"nr", "*", "nr"}], "-", 
            RowBox[{"nt", "*", "nt"}]}], 
           RowBox[{"2", "*", "nr", "*", "nt"}], 
           RowBox[{"nr", "*", "nz"}]},
          {
           RowBox[{
            RowBox[{"-", "nt"}], "*", "nz"}], 
           RowBox[{"nr", "*", "nz"}], "0"}
         }], "\[NoBreak]", ")"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ny", " ", "=", "  ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], "*", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], ",", " ", 
    RowBox[{"nx", " ", "=", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Alpha]", "]"}], "*", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", " ", 
    RowBox[{"nz", " ", "=", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "phi", "]"}], " ", "is", " ", "shear"}]}], ",", " ", 
    RowBox[{"but", " ", "for", " ", 
     RowBox[{"radial", ":", "\[IndentingNewLine]", "   ", 
      RowBox[{
      "we", " ", "have", " ", "nr", " ", "like", " ", "nz", " ", "in", " ", 
       "shear"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"so", " ", "nr"}], " ", "=", " ", 
     RowBox[{"cos", 
      RowBox[{"(", "phi", ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"nr", " ", "\[Rule]", " ", "nz"}], ")"}]}]}], ",", " ", 
    RowBox[{"ntheta", " ", "like", " ", "nx", " ", "in", " ", "shear"}], ",", 
    " ", 
    RowBox[{
     RowBox[{"so", " ", "ntheta"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"cos", 
       RowBox[{"(", "alpha", ")"}], "*", "sin", 
       RowBox[{"(", "phi", ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"ntheta", " ", "\[Rule]", " ", "nx"}], ")"}], 
       "\[IndentingNewLine]", "   ", "and", " ", "finally", " ", "nz"}], " ", 
      "\[Rule]", " ", "ny"}]}], ",", " ", 
    RowBox[{
     RowBox[{"so", " ", "nz"}], " ", "=", " ", 
     RowBox[{"sin", 
      RowBox[{"(", "alpha", ")"}], "sin", 
      RowBox[{"(", "phi", ")"}]}]}]}], "  ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0X0s1HEcB/BLXB5Wy3WxZELnORaWJF3djmsrC1HN9YCTHCk5VkeJUZY6
3Q0p/iCGTIQjTl1Onh/nYcVY9CSG83BcsbNWv/fvj+9e++7zfb//+HwteDFn
w7UoFIoXceDuHxGzfKGS5SNUrUKzZ2OUSMKr1XM6MJHBpcEQn61GsOIY1QQ2
7Aq2gFoUuQ1MSDewhbN2LCc4c4F7EJblDR2BHHsuG+bSXPbeIHReZJNm1QfZ
w5dUDxdoGqrrGof+dxQmXItjX4IdVdwQOJpkFA4FLDNSHnP18iPCsFctPEjh
U2Nhqn83qXYlZ5l0YIJU33Vj9i1hdhdbBZ+LNbIGwsXO8iZo6cBfh8Utm6SK
zijjRsL4HHcTyOpOFUFpgXcmFLlLssn58PY6uK+KLoMVq4OdcMW5po98V6ga
geW6M18g/W/8FNnznpPRTNj7MS0XVtJqX8NA79A6mKfOlcOdgwFd8FBbxiR0
6qEvQLlljJaC0KS2XxsqdUb0IKdowgBm0bONoKQ4ngF/azs6wSSqmws0Ynox
oduJpuOkrKWvHcg5KtSwSN1O6yTU6HtawFvSK1Zwx7qlK+z4PO4O400Vp+AW
4X4/cl6sCoC2vc5BZN4/mQ/Hon1uwiFlvgCqmXeewI3gYyJYMZxcCXk5S6Si
n0HTcPR0GKl0jqvThX84aboHnmmPNoMr1v8YcK27xh7qTJay4b3A2wJIUfFT
oIUh7wGMtll4CIf7Lgq6CT1nC+Ogr5CmgOyT2i2Ql14n6IPnvO7Akk/ie1Bo
158NY1K6XsAoumM+jEgJKYBvfmsKocFhahk0W7CXQv5dNxl0nLzZDCsk11uh
SO47Cv8MtYwPIy/j/YJa7LR56KfWrEFJD2MDFqSn6o4Qcp/Oy3sSlKzMhsgP
cNq8pBXy5bVt5L3Ez7A1UckKjjlAh1PfS7e1EcrE9cYwIFKi8UgjegZiN6H4
vphxlPDx+Ws2sLFtuXrhKbGXdD0pFLZ/s3IQK1nmn4ut4X+uj0fB
  
  "],ExpressionUUID->"6c12b451-4fcd-4343-90a8-64bd9a3c5de3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckRow", "[", "vec_", "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "vec", "]"}], "<", "2"}], ",", " ", 
     RowBox[{"Transpose", "[", "vec", "]"}], ",", " ", "vec"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VecOuter", "[", 
     RowBox[{"vec1_", ",", "vec2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"vec1", ",", "vec2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatOuter", "[", 
     RowBox[{"mat1_", ",", "mat2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "1"}], "]"}], ",",
               "1"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "1"}], "]"}], ",",
               "2"}], "]"}], ",", "1"}], "]"}], ",", "2"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "1"}], "]"}], ",",
               "3"}], "]"}], ",", "1"}], "]"}], ",", "3"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "2"}], "]"}], ",",
               "1"}], "]"}], ",", "2"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "2"}], "]"}], ",",
               "2"}], "]"}], ",", "2"}], "]"}], ",", "2"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "2"}], "]"}], ",",
               "3"}], "]"}], ",", "2"}], "]"}], ",", "3"}], "]"}]},
       {
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "3"}], "]"}], ",",
               "1"}], "]"}], ",", "3"}], "]"}], ",", "1"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "3"}], "]"}], ",",
               "2"}], "]"}], ",", "3"}], "]"}], ",", "2"}], "]"}], 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"mat1", ",", "mat2"}], "]"}], ",", "3"}], "]"}], ",",
               "3"}], "]"}], ",", "3"}], "]"}], ",", "3"}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"\[Mu]", "*", "r", "*", "z"}], ",", "0"}], "}"}]}], ";"}], " ", 
  
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"or", " ", "use", " ", "gamma"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"Omega", "/", "gap"}], "*", 
     RowBox[{"R", " ", "?"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradv", " ", "=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "r"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "r"}], "]"}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], " ",
           "-", " ", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "r"}], ")"}], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "r"}], ")"}], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]"}], "]"}]}]},
        {
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}
       }], "\[NoBreak]", ")"}], " ", "]"}]}], " ", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", "gradv", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\[Theta]", " ", "is", " ", "rotation", " ", "angle", " ", "in", " ", 
    "cyl", " ", "coords"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"variable", " ", "form", " ", "of", " ", "gradv"}], "..."}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"gradv", " ", "=", " ", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "gv12", "0"},
         {"gv21", "0", "gv23"},
         {"0", "0", "0"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nhat", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"Cos", "[", "\[Phi]", "]"}]},
        {
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}]},
        {
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], 
          RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}
       }], "\[NoBreak]", ")"}]}], ";"}], "*)"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"nr", " ", "\[Rule]", " ", 
     RowBox[{"cos", 
      RowBox[{"(", "phi", ")"}]}]}], ",", " ", 
    RowBox[{"so", " ", "like", " ", "old", " ", "nz"}], ",", " ", 
    RowBox[{
    "then", " ", "nt", " ", "and", " ", "nz", " ", "are", " ", "alpha", " ", 
     "ones"}]}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nhat", " ", "=", " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"nr"},
       {"nt"},
       {"nz"}
      }], "\[NoBreak]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ident", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"symmv", " ", "=", 
    RowBox[{"(", 
     RowBox[{"gradv", "+", 
      RowBox[{"Transpose", "[", "gradv", "]"}]}], ")"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"ACTUALLY", " ", "D", "*", 
    RowBox[{"2", "!!"}]}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qtens", "[", "nhat_", "]"}], " ", ":=", " ", 
   RowBox[{"s", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"VecOuter", "[", 
       RowBox[{
        RowBox[{"CheckRow", "[", "nhat", "]"}], ",", 
        RowBox[{"CheckRow", "[", "nhat", "]"}]}], "]"}], "-", 
      RowBox[{"ident", "/", "3"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"qtens", "[", "nhat", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "functions", " ", "of", " ", "above", " ", "variables"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"u_", ",", "s_", ",", " ", "d_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", "6"}], "*", "d", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"u", "/", "3"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"u", "/", "3"}], ")"}], "*", "s"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "/", "3"}], ")"}], "*", "u", "*", 
       RowBox[{"s", "^", "2"}]}]}], ")"}]}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "3"}], ")"}], 
     RowBox[{"(", "symmv", ")"}]}], " ", "+", " ", 
    RowBox[{"gradv", ".", "q"}], " ", "+", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"gradv", ".", "q"}], "]"}], " ", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "/", "3"}], ")"}], "*", "ident", "*", 
     RowBox[{"(", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"MatOuter", "[", 
         RowBox[{"gradv", ",", "q"}], "]"}], ",", "Infinity"}], "]"}], 
      ")"}]}], " ", "-", " ", 
    RowBox[{"2", "*", "q", "*", 
     RowBox[{"(", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"MatOuter", "[", 
         RowBox[{"gradv", ",", "q"}], "]"}], ",", "Infinity"}], "]"}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", " ", "=", " ", 
   RowBox[{"q", "*", 
    RowBox[{"h", "[", 
     RowBox[{"U", ",", "s", ",", "D"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nf", " ", "=", " ", 
   RowBox[{"Flatten", "[", "nhat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matQ", " ", "=", "  ", 
    RowBox[{"\[Mu]", "*", "z", "*", "s", "*", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"-", "2"}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"nf", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"nf", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nf", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"nf", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"nf", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], 
         RowBox[{"2", "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], 
         RowBox[{
          RowBox[{"nf", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"nf", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], 
         RowBox[{
          RowBox[{"nf", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"nf", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "0"}
       }], "\[NoBreak]", ")"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"material", " ", "derivative", " ", "component"}], ",", " ", 
    RowBox[{"=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"v", ".", "grad"}], ")"}], "Q"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ndot", "[", 
    RowBox[{
    "s_", ",", "q_", ",", "nhat_", ",", "f_", ",", "g_", ",", "matQ_"}], 
    "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "s"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", ".", "nhat"}], " ", "+", " ", 
       RowBox[{"f", ".", "nhat"}], "-", 
       RowBox[{"matQ", ".", "nhat"}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "s"}], ")"}], "*", 
     RowBox[{"sdot", "[", 
      RowBox[{"s", ",", "q", ",", "f", ",", "g", ",", "matQ"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"2", "*", 
       RowBox[{"nhat", "/", "3"}]}], ")"}]}]}]}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"explicit", " ", "form"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sdot", "[", 
   RowBox[{"s_", ",", "q_", ",", "f_", ",", "g_", ",", "matQ_"}], "]"}], " ", 
  ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3", "/", 
     RowBox[{"(", 
      RowBox[{"2", "s"}], ")"}]}], ")"}], "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{"q", ".", "f"}], "]"}], " ", "+", " ", 
     RowBox[{"Tr", "[", 
      RowBox[{"q", ".", "g"}], "]"}], "-", " ", 
     RowBox[{"Tr", "[", 
      RowBox[{"q", ".", "matQ"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndot", "[", 
   RowBox[{"s_", ",", "q_", ",", "nhat_", ",", "g_", ",", "matQ_"}], "]"}], ":=",
   " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "s"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"g", ".", "nhat"}], ")"}]}], " ", "-", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"s", "^", "2"}]}], ")"}], "*", "nhat", "*", 
    RowBox[{"Tr", "[", 
     RowBox[{"q", ".", "g"}], "]"}]}], "  ", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "s"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"matQ", ".", "nhat"}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"sdot", "[", 
     RowBox[{"s", ",", "q", ",", "f", ",", "g", ",", "matQ"}], "]"}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"nr", "^", "2"}], " ", "+", " ", 
      RowBox[{"nt", "^", "2"}], " ", "+", " ", 
      RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", " ", "1"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"ndot", "[", 
        RowBox[{"s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}],
         "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"nr", "^", "2"}], " ", "+", " ", 
         RowBox[{"nt", "^", "2"}], " ", "+", " ", 
         RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", " ", "1"}]}], "]"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"sdot", "[", 
       RowBox[{"s", ",", "q", ",", "nhat", ",", "g", ",", "matQ"}], "]"}], 
      ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"nr", "^", "2"}], " ", "+", " ", 
        RowBox[{"nt", "^", "2"}], " ", "+", " ", 
        RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", " ", "1"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", "/", 
           RowBox[{"(", 
            RowBox[{"2", "s"}], ")"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tr", "[", 
            RowBox[{"q", ".", "f"}], "]"}], " ", "+", " ", 
           RowBox[{"Tr", "[", 
            RowBox[{"q", ".", "g"}], "]"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"nr", "^", "2"}], " ", "+", " ", 
          RowBox[{"nt", "^", "2"}], " ", "+", " ", 
          RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", " ", "1"}]}], "]"}], "   ",
       "OLD", " ", "ONE"}], ",", " ", 
     RowBox[{"WITHOUT", " ", "MAT"}]}], " ", "*)"}], "  ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nsols", " ", "=", " ", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{"nr", "^", "2"}], " ", "+", " ", 
        RowBox[{"nt", "^", "2"}], "+", 
        RowBox[{"nz", "^", "2"}]}], " ", "\[Equal]", "1"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"doesnt", " ", "have", " ", "s", " ", "changing"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"so", " ", "idea", " ", "would", " ", "be"}], " ", "..."}], " ",
      "check", " ", "stability", " ", "of", " ", "associated", " ", "S"}], 
    ",", " ", 
    RowBox[{
     RowBox[{
     "which", " ", "is", " ", "value", " ", "that", " ", "satisifies", " ", 
      "picked", " ", 
      RowBox[{"solution", "?", " ", "may"}], " ", "just", " ", "be", " ", 
      "un"}], "-", 
     RowBox[{"flowed", " ", "s"}]}], ",", " ", 
    RowBox[{"or", "..."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"test", " ", "non"}], "-", 
       RowBox[{
        RowBox[{"dst", "/", "dt"}], " ", "nhat", " ", "\"\<sol\>\""}]}], 
      "..."}], " ", "use", " ", "nhat", " ", "to", " ", "get", " ", 
     RowBox[{
      RowBox[{"q", "?", " ", "Sqrt"}], "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "/", "2"}], ")"}], "Tr", 
       RowBox[{"(", 
        RowBox[{"q", "^", "2"}], ")"}]}], "]"}]}], " ", "=", " ", "s"}], " ", 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nTOs", "[", 
     RowBox[{"nr_", ",", "nt_", ",", "nz_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}], "*", 
      RowBox[{"Tr", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qtens", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"nr"},
             {"nt"},
             {"nz"}
            }], "\[NoBreak]", ")"}], "]"}], ".", 
         RowBox[{"qtens", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"nr"},
             {"nt"},
             {"nz"}
            }], "\[NoBreak]", ")"}], "]"}]}], ")"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"nsols", " ", "=", " ", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ndot", "[", 
           RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"ndot", "[", 
           RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"ndot", "[", 
           RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nSsols", " ", "=", " ", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ndot", "[", 
           RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"ndot", "[", 
           RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"ndot", "[", 
           RowBox[{"s", ",", "q", ",", "nhat", ",", "g"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
        RowBox[{
         RowBox[{"sdot", "[", 
          RowBox[{"s", ",", "q", ",", "f", ",", "g"}], "]"}], "\[Equal]", 
         "0"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "s"}], "}"}]}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"conversion", " ", "from", " ", "nr"}], ",", "nt", ",", 
    RowBox[{"nz", " ", "to", " ", "phi"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"alph", " ", "..."}], ".", " ", "arcos"}], 
      RowBox[{"(", "nr", ")"}]}], " ", "=", " ", "phi"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"easy", ".", " ", "arctan"}], 
      RowBox[{"(", 
       RowBox[{"nz", "/", "nt"}], ")"}]}], " ", "=", " ", "alph"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"now", " ", "stability"}], "  ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phidot", "[", 
   RowBox[{"s_", ",", "\[Phi]_", ",", "\[Alpha]_"}], "]"}], " ", ":=", 
  RowBox[{"Part", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Phi]"}], "]"}]}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"phidot", "[", 
    RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alphadot", "[", 
   RowBox[{"s_", ",", "\[Phi]_", ",", "\[Alpha]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Part", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"ndot", "[", 
         RowBox[{
         "s", ",", "q", ",", "nhat", ",", "f", ",", "g", ",", "matQ"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], ".", 
     RowBox[{"D", "[", 
      RowBox[{"nhat", ",", "\[Alpha]"}], "]"}]}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"alphadot", "[", 
     RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alphadot", "[", 
    RowBox[{"s_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", "u_"}], "]"}], ":=", 
   " ", 
   FractionBox[
    RowBox[{"r", " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "s"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "s"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], 
    RowBox[{"6", " ", "s"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"phidot", "[", 
     RowBox[{"s_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", "u_"}], "]"}], " ", 
    ":=", " ", 
    FractionBox[
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "s"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
     RowBox[{"3", " ", "s"}]]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sdot", "[", 
       RowBox[{
       "gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_", ",", "d_", ",", 
        "p_", ",", "vol_"}], "]"}], " ", "--"}], ">", " ", 
     RowBox[{
     "d", " ", "can", " ", "be", " ", "removed", " ", "in", " ", "unitless", 
      " ", "way"}]}], ",", " ", 
    RowBox[{
     RowBox[{"rest", " ", "at", " ", "least", " ", "must", " ", 
      RowBox[{"stay", ".", " ", "write"}], " ", 
      RowBox[{"sdot", "[", "]"}], " ", "\[IndentingNewLine]", "via", " ", 
      "U"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"p", "*", 
       RowBox[{"L", "/", "D"}]}], " ", "=", " ", 
      RowBox[{"p", "*", "aspect"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"D_rflat", "/", "D_r0"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "*", "aspect"}], ")"}], "^", 
       RowBox[{"-", "2"}]}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"s", "^", "2"}]}], ")"}], "^", 
       RowBox[{"-", "2"}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "[", 
      RowBox[{"phi_", ",", "alph_", ",", "order_"}], "]"}], " ", ":=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"phidot", "[", 
              RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
             "\[Phi]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
             RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
             RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], "\[NoBreak]"}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"phidot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"phidot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", "s"}],
            "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]},
        {
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"alphadot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
            "\[Phi]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"alphadot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"alphadot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", "s"}],
            "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]},
        {
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"sdot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
            "\[Phi]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"sdot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
            "\[Alpha]"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"sdot", "[", 
             RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", "s"}],
            "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
            RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
            RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]}
       }], "\[NoBreak]", ")"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mNoS", "[", 
     RowBox[{"phi_", ",", "alph_", ",", "order_"}], "]"}], ":=", " ", 
    RowBox[{"(", "\[NoBreak]\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}], "\[NoBreak]"}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]},
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]}
      }], ")"}]}], " ", ";", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "stability", " ", "matrix", " ", "assuming", " ", "s", " ", 
       "constant"}], " ", "..."}], " ", "haver", " ", "to", " ", "simul", " ",
      "solve", " ", "to", " ", "get", " ", "full", " ", "set", " ", "and", 
     " ", "then", " ", "define", " ", "upper", " ", "matrix", " ", "to", " ", 
     "check"}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"mNoS", "[", 
        RowBox[{"\[Phi]", ",", "\[Alpha]", ",", "s"}], "]"}], "]"}], "]"}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"phi_", ",", "alph_", ",", "order_"}], "]"}], " ", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}], "\[NoBreak]"}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"phidot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", "s"}], 
          "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]},
       {
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Phi]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", 
           "\[Alpha]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}], 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"alphadot", "[", 
            RowBox[{"s", ",", "\[Phi]", ",", "\[Alpha]"}], "]"}], ",", "s"}], 
          "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Phi]", "\[Rule]", "phi"}], ",", 
           RowBox[{"\[Alpha]", "\[Rule]", "alph"}], ",", 
           RowBox[{"s", "\[Rule]", "order"}]}], "}"}]}]},
       {"0", "0", "0"}
      }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.826898915644627*^9, 3.826899011239695*^9}, {
   3.82689905200825*^9, 3.826899075062983*^9}, {3.826899133947584*^9, 
   3.826899185318486*^9}, {3.8268992608192377`*^9, 3.8268993223153067`*^9}, {
   3.8268993918806343`*^9, 3.82689953100348*^9}, {3.826899762193128*^9, 
   3.826899805097146*^9}, {3.826899867538062*^9, 3.826899946412159*^9}, {
   3.826900010834715*^9, 3.826900156002543*^9}, {3.8269001923433867`*^9, 
   3.826900267202427*^9}, {3.826900299392354*^9, 3.8269003479133043`*^9}, {
   3.826900400135762*^9, 3.8269005057054358`*^9}, {3.82690054272609*^9, 
   3.826900721492976*^9}, {3.826900753216051*^9, 3.826900836474292*^9}, {
   3.827045740548459*^9, 3.827045760228565*^9}, {3.8270461146072083`*^9, 
   3.827046138424348*^9}, {3.827046187215279*^9, 3.827046191547913*^9}, {
   3.827046225662167*^9, 3.827046330095862*^9}, {3.827046478916407*^9, 
   3.827046511080452*^9}, {3.827046610915388*^9, 3.827046631338704*^9}, {
   3.827046930885301*^9, 3.827047036229466*^9}, {3.8270471514454727`*^9, 
   3.827047209251878*^9}, {3.8270473410181704`*^9, 3.8270474497861443`*^9}, {
   3.82704749782752*^9, 3.827047526585595*^9}, {3.8270475881406813`*^9, 
   3.82704787447047*^9}, {3.827047933182979*^9, 3.827047997789569*^9}, {
   3.82704807227118*^9, 3.8270482051261997`*^9}, {3.827048242338007*^9, 
   3.8270483613823967`*^9}, {3.827048426099472*^9, 3.8270485722131777`*^9}, {
   3.827048625731124*^9, 3.8270487108542852`*^9}, {3.827048801898897*^9, 
   3.8270488677602663`*^9}, {3.82704891628024*^9, 3.827048916687298*^9}, {
   3.827048967239747*^9, 3.82704897111856*^9}, {3.827049059173052*^9, 
   3.827049225289289*^9}, 3.827049337168597*^9, {3.827049368697093*^9, 
   3.827049369418489*^9}, {3.827049439571735*^9, 3.827049466471303*^9}, {
   3.827049570207899*^9, 3.827049659960032*^9}, {3.827049715661866*^9, 
   3.827049817181356*^9}, {3.827050105897019*^9, 3.827050134283341*^9}, {
   3.827050234370963*^9, 3.827050271533049*^9}, {3.82705031144531*^9, 
   3.827050322510579*^9}, {3.8270504856203527`*^9, 3.827050486057712*^9}, {
   3.82797272171381*^9, 3.827972742300149*^9}, {3.8279728037488327`*^9, 
   3.827972805803397*^9}, {3.827972840476473*^9, 3.827972848897373*^9}, {
   3.8279728792693377`*^9, 3.8279728793830967`*^9}, {3.82797295308401*^9, 
   3.827973021718925*^9}, {3.827973055022843*^9, 3.827973057340638*^9}, {
   3.827973090798748*^9, 3.827973132906234*^9}, {3.82797360974971*^9, 
   3.827973630407456*^9}, {3.827973676664838*^9, 3.827973679236261*^9}, {
   3.827973723293098*^9, 3.827973741601282*^9}, {3.8279737743392353`*^9, 
   3.82797378326597*^9}, {3.827975899945876*^9, 3.827975982809251*^9}, {
   3.827976150170895*^9, 3.82797615031851*^9}, {3.827976182493791*^9, 
   3.827976296484899*^9}, {3.8279764177685833`*^9, 3.827976440926092*^9}, {
   3.827976484981558*^9, 3.827976618765685*^9}, {3.827976652970992*^9, 
   3.827976668702339*^9}, {3.8279770838708973`*^9, 3.8279770999081087`*^9}, {
   3.827977193367654*^9, 3.8279772100142117`*^9}, {3.827977435868597*^9, 
   3.827977676345891*^9}, {3.827977747275092*^9, 3.8279777513568907`*^9}, {
   3.8279777835785522`*^9, 3.827977837949396*^9}, {3.827977877280286*^9, 
   3.827977889846607*^9}, 3.827977959994576*^9, {3.8279781547489977`*^9, 
   3.8279781992369423`*^9}, {3.827978252725566*^9, 3.827978300890828*^9}, {
   3.827978338070982*^9, 3.8279783599281807`*^9}, 3.827979589678916*^9, 
   3.827980681056745*^9, {3.827980713856327*^9, 3.8279807316635647`*^9}, {
   3.827980850447061*^9, 3.827980977445739*^9}, {3.827981008438435*^9, 
   3.827981011815854*^9}, {3.827981462452333*^9, 3.827981466750559*^9}, {
   3.8279815150875683`*^9, 3.827981691661746*^9}, {3.829367411660462*^9, 
   3.829367421186246*^9}, {3.829368719113096*^9, 3.829368844300003*^9}, {
   3.8293689387703648`*^9, 3.829369027317334*^9}, {3.8293691028084707`*^9, 
   3.829369127016955*^9}, {3.8293692249550323`*^9, 3.82936922676085*^9}, {
   3.8293695549258223`*^9, 3.8293695961265173`*^9}, {3.8293772759048653`*^9, 
   3.829377276223274*^9}, {3.829377309228128*^9, 3.829377314705327*^9}, 
   3.829377461355606*^9, {3.829377508068199*^9, 3.829377525201446*^9}, {
   3.829377572819872*^9, 3.829377678075548*^9}, {3.82937911293351*^9, 
   3.829379146424699*^9}, {3.829381566091441*^9, 3.829381635485491*^9}, {
   3.829381701454376*^9, 3.8293817091652*^9}, {3.829382011933963*^9, 
   3.829382102725747*^9}, {3.829382202912375*^9, 3.829382236276115*^9}, {
   3.829382287278379*^9, 3.8293823212767143`*^9}, {3.8293823735333233`*^9, 
   3.829382601624473*^9}, {3.829382657216589*^9, 3.829382928671341*^9}, {
   3.82938296022204*^9, 3.829383004080626*^9}, {3.829383052620687*^9, 
   3.829383157514591*^9}, {3.829383284931067*^9, 3.829383304761965*^9}, {
   3.829383413788228*^9, 3.829383419607519*^9}, {3.829383477314177*^9, 
   3.8293834962051287`*^9}, {3.8293835324149942`*^9, 
   3.8293835333559027`*^9}, {3.829383633613612*^9, 3.8293836575858383`*^9}, {
   3.829383809467971*^9, 3.829383888075638*^9}, {3.829383930849619*^9, 
   3.829383968131564*^9}, {3.829384049309869*^9, 3.829384107541486*^9}, {
   3.829384166851645*^9, 3.829384239714581*^9}, {3.82938430127836*^9, 
   3.8293843088703823`*^9}, {3.829384361849234*^9, 3.829384364989717*^9}, {
   3.8293844136970987`*^9, 3.8293844140245543`*^9}, 3.829391412754052*^9, {
   3.829391482001308*^9, 3.829391579020083*^9}, {3.829391679537869*^9, 
   3.829391730423752*^9}, 3.829392753186842*^9, {3.829392845902224*^9, 
   3.829392847939354*^9}, {3.8293930258584557`*^9, 3.829393042868779*^9}, {
   3.8293931285954*^9, 3.829393177858603*^9}, {3.8293933442998877`*^9, 
   3.8293934666917458`*^9}, 3.829393502393487*^9, {3.829393534016926*^9, 
   3.829393584200198*^9}, {3.8293936498617573`*^9, 3.829393649967791*^9}, {
   3.8293937339430933`*^9, 3.829393735080057*^9}, {3.829393783630402*^9, 
   3.829393783723785*^9}, {3.829393829500061*^9, 3.8293938480104837`*^9}, {
   3.829393897221036*^9, 3.8293939226734257`*^9}, {3.829393956438381*^9, 
   3.829394037818059*^9}, {3.829394110739691*^9, 3.829394191995195*^9}, {
   3.829394566033215*^9, 3.829394597230446*^9}, 3.829394647375311*^9, {
   3.829473438525968*^9, 3.829473507249671*^9}, {3.829474868569001*^9, 
   3.82947487578133*^9}, {3.829475215805356*^9, 3.829475298265373*^9}, {
   3.82947545492039*^9, 3.829475527620796*^9}, {3.829476240155423*^9, 
   3.829476257805455*^9}, {3.829476541892755*^9, 3.829476575403449*^9}, {
   3.829856567952417*^9, 3.829856645437978*^9}, {3.8298580563340673`*^9, 
   3.82985809699193*^9}, {3.8303478198056927`*^9, 3.830347847179449*^9}, {
   3.8303478839746437`*^9, 3.830347886354516*^9}, {3.8303479341120443`*^9, 
   3.830347934893289*^9}, {3.830347966214657*^9, 3.8303479664620657`*^9}, {
   3.8303480794317923`*^9, 3.830348081537431*^9}, {3.830376845277124*^9, 
   3.830376858758431*^9}, {3.8303769143322973`*^9, 3.830376923608796*^9}, 
   3.8303814577774773`*^9, {3.830427152518401*^9, 3.830427177545106*^9}, 
   3.83042721472418*^9, {3.830865779004654*^9, 3.830865816123673*^9}, {
   3.830865858038712*^9, 3.830865862690805*^9}, {3.830866037087537*^9, 
   3.830866087221849*^9}, {3.830866236468177*^9, 3.830866268661228*^9}, {
   3.830887552725322*^9, 3.8308876161742363`*^9}, {3.83088922815315*^9, 
   3.83088929066278*^9}, {3.830890121458268*^9, 3.830890121734178*^9}, {
   3.83089346018528*^9, 3.830893460347651*^9}, {3.830920785037486*^9, 
   3.830920862545981*^9}, {3.83092099580933*^9, 3.830921007688815*^9}, {
   3.830921083958366*^9, 3.830921155539463*^9}, {3.83092121819703*^9, 
   3.830921326036227*^9}, {3.831478364998589*^9, 3.831478387796825*^9}, {
   3.831478428617956*^9, 3.831478474190443*^9}, {3.8314785516963167`*^9, 
   3.831478551936592*^9}, {3.832039334618314*^9, 3.83203938238373*^9}, {
   3.832039503685601*^9, 3.8320396419305687`*^9}, {3.832039727540082*^9, 
   3.832039739355241*^9}, {3.832039814198319*^9, 3.832039825886528*^9}, {
   3.832040366943768*^9, 3.832040471719141*^9}, {3.8320711887051973`*^9, 
   3.8320712293210707`*^9}, 3.832071595931933*^9, {3.832072035661992*^9, 
   3.8320720951255903`*^9}, {3.832072152840444*^9, 3.832072195027062*^9}, {
   3.83207237857784*^9, 3.8320724821011257`*^9}, {3.832072544757064*^9, 
   3.832072705906732*^9}, {3.832073064093655*^9, 3.832073110157652*^9}, {
   3.832073603574428*^9, 3.832073603710979*^9}, 3.8320744178830233`*^9, {
   3.832074454774582*^9, 3.832074462520976*^9}, {3.832074509590044*^9, 
   3.8320745335387506`*^9}, 3.832074751261656*^9, {3.83207574879946*^9, 
   3.832075768884079*^9}, {3.8320772282737913`*^9, 3.8320772289962463`*^9}, {
   3.832078462729269*^9, 3.83207847314752*^9}, {3.832078511551282*^9, 
   3.8320785446636267`*^9}, {3.832078720789212*^9, 3.8320787237957687`*^9}, {
   3.832078774400584*^9, 3.83207877757028*^9}, 3.832087838744837*^9, {
   3.832863494113323*^9, 3.8328635209461823`*^9}, {3.833027507964614*^9, 
   3.833027545043988*^9}, {3.8330278769547157`*^9, 3.8330279130197687`*^9}, {
   3.833027948857306*^9, 3.833027958082038*^9}, {3.833027991021153*^9, 
   3.83302800178623*^9}, {3.833028877007834*^9, 3.8330288996284027`*^9}, {
   3.8330293046886063`*^9, 3.8330293380724707`*^9}, {3.833029371531208*^9, 
   3.83302937172602*^9}, {3.8330298670277443`*^9, 3.833029950125641*^9}, {
   3.833031036776273*^9, 3.8330311705914907`*^9}, {3.833031203444166*^9, 
   3.8330312384820757`*^9}, {3.833031269301713*^9, 3.833031300826494*^9}, {
   3.833031363118267*^9, 3.833031446757525*^9}, {3.8330314808772984`*^9, 
   3.833031486647606*^9}, {3.833031518834052*^9, 3.833031527844861*^9}, {
   3.833031562406959*^9, 3.8330315671451883`*^9}, {3.8330316776114283`*^9, 
   3.833031677949904*^9}, {3.8330721439157543`*^9, 3.833072224033793*^9}, {
   3.8330724774998007`*^9, 3.833072477850335*^9}, 3.833072537412093*^9, {
   3.833072683912051*^9, 3.833072698214579*^9}, {3.8330727532848988`*^9, 
   3.833072753685959*^9}, {3.8330727978679667`*^9, 3.833072802058591*^9}, {
   3.83315592257653*^9, 3.833155958579248*^9}, {3.833157205732491*^9, 
   3.833157270783825*^9}, {3.8331573022719927`*^9, 3.833157306608614*^9}, {
   3.833157460151292*^9, 3.833157463756469*^9}, {3.833157500062171*^9, 
   3.833157531069399*^9}, {3.8331575750741253`*^9, 3.833157667701282*^9}, {
   3.833157743154665*^9, 3.833157809210751*^9}, {3.833157924216838*^9, 
   3.833157944327248*^9}, {3.833157976706848*^9, 3.833157980022057*^9}, {
   3.833158104004869*^9, 3.833158104729536*^9}, {3.8331582576038*^9, 
   3.833158261972322*^9}, {3.833158387962318*^9, 3.83315838893758*^9}, {
   3.833158449617388*^9, 3.833158545553137*^9}, {3.833191943655717*^9, 
   3.833191989935555*^9}, {3.833192248173884*^9, 3.833192310981093*^9}, {
   3.83319234532339*^9, 3.833192374119328*^9}, {3.833192743567235*^9, 
   3.833192753343863*^9}, {3.833192786762417*^9, 3.833192941861013*^9}, {
   3.833192987721027*^9, 3.833193033881796*^9}, {3.8331931082953377`*^9, 
   3.8331931597297153`*^9}, {3.833193205712997*^9, 3.833193285612895*^9}, {
   3.83319366611795*^9, 3.8331937457602243`*^9}, {3.833208005849515*^9, 
   3.833208006044505*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"aad7fbfa-31cd-41fc-8030-26e96e234b09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "D", " ", "s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "s", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["s", "2"]}]}], ")"}], " ", "U"}]}], ")"}]}], "+", 
  RowBox[{"nt", " ", "nz", " ", "r", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "s", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["s", "2"]}]}], ")"}], " ", "\[Mu]"}]}]], "Output",
 CellChangeTimes->{
  3.8331583895451*^9, {3.833158495770577*^9, 3.8331585465894337`*^9}, {
   3.833191972776617*^9, 3.833191991036131*^9}, 3.833192270886786*^9, {
   3.833192306328739*^9, 3.833192311426306*^9}, {3.8331923545415173`*^9, 
   3.833192375295277*^9}, 3.833193169282632*^9, 3.833193207821591*^9, 
   3.8331932498922997`*^9, 3.833193288135306*^9, 3.8331935397150717`*^9, {
   3.833193681410452*^9, 3.833193746192441*^9}, 3.83320796157473*^9, 
   3.833208007459325*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"aec0cacd-610a-43a6-a5cb-84ad666cd2f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nr", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"nt", "\[Rule]", "0"}], ",", 
     RowBox[{"nz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nr", "\[Rule]", "1"}], ",", 
     RowBox[{"nt", "\[Rule]", "0"}], ",", 
     RowBox[{"nz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nr", "\[Rule]", "0"}], ",", 
     RowBox[{"nt", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}], ",", 
     RowBox[{"nz", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "-", "s"}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nr", "\[Rule]", "0"}], ",", 
     RowBox[{"nt", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}], ",", 
     RowBox[{"nz", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "-", "s"}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nr", "\[Rule]", "0"}], ",", 
     RowBox[{"nt", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "s"}]}]], 
        SqrtBox[
         RowBox[{"2", "+", "s"}]]]}]}], ",", 
     RowBox[{"nz", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "-", "s"}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nr", "\[Rule]", "0"}], ",", 
     RowBox[{"nt", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "s"}]}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}], ",", 
     RowBox[{"nz", "\[Rule]", 
      FractionBox[
       SqrtBox[
        RowBox[{"1", "-", "s"}]], 
       SqrtBox[
        RowBox[{"2", "+", "s"}]]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8331583895451*^9, {3.833158495770577*^9, 3.8331585465894337`*^9}, {
   3.833191972776617*^9, 3.833191991036131*^9}, 3.833192270886786*^9, {
   3.833192306328739*^9, 3.833192311426306*^9}, {3.8331923545415173`*^9, 
   3.833192375295277*^9}, 3.833193169282632*^9, 3.833193207821591*^9, 
   3.8331932498922997`*^9, 3.833193288135306*^9, 3.8331935397150717`*^9, {
   3.833193681410452*^9, 3.833193746192441*^9}, 3.83320796157473*^9, 
   3.833208007539516*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"01988dba-5ad3-49cb-91b0-e62b2f7abbd4"]
}, Open  ]]
},
WindowSize->{1229, 778},
WindowMargins->{{85, Automatic}, {14, Automatic}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1db12eda-75c2-4b42-b2bd-ee3cfe79c3b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3853, 92, 257, "Input",ExpressionUUID->"6c12b451-4fcd-4343-90a8-64bd9a3c5de3"],
Cell[CellGroupData[{
Cell[4436, 116, 53641, 1360, 2172, "Input",ExpressionUUID->"aad7fbfa-31cd-41fc-8030-26e96e234b09"],
Cell[58080, 1478, 1045, 24, 37, "Output",ExpressionUUID->"aec0cacd-610a-43a6-a5cb-84ad666cd2f5"],
Cell[59128, 1504, 2808, 90, 107, "Output",ExpressionUUID->"01988dba-5ad3-49cb-91b0-e62b2f7abbd4"]
}, Open  ]]
}
]
*)


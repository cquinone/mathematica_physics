(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45989,       1070]
NotebookOptionsPosition[     45407,       1052]
NotebookOutlinePosition[     45802,       1068]
CellTagsIndexPosition[     45759,       1065]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\</Users/quinones/Desktop\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RealQ", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Element", "[", 
     RowBox[{"x", ",", "Reals"}], "]"}], "===", "True"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "6"}], "s", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"s", "^", "2"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"(", "p", ")"}], "^", "4"}], " ", "*", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "vol"}], ")"}], "^", "2"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", "s"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gradv", "*", "nt", "*", "nz"}], " ", "+", " ", 
        RowBox[{"2", "s", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"s", "^", "2"}]}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"-", "2"}], ")"}]}], " ", "*", 
         RowBox[{"(", 
          RowBox[{"p", "^", "3"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "/", "vol"}], ")"}]}]}], ")"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", "sdot"}], ",", " ", 
    RowBox[{
     RowBox[{"for", " ", 
      RowBox[{"r", "/", "R"}]}], " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"4", "/", 
     RowBox[{"pi", " ", "~", " ", "1"}]}], ",", "  ", 
    RowBox[{"p", " ", "=", " ", 
     RowBox[{"d", "/", "L"}]}], ",", " ", 
    RowBox[{"gradv", " ", "=", " ", 
     RowBox[{"mu_hat", " ", "R"}]}], ",", " ", "..."}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"so", " ", "into", " ", "this"}], ",", " ", 
    RowBox[{
     RowBox[{"plug", "..."}], " ", "nt"}], ",", " ", 
    RowBox[{"nz", " ", "sols"}], ",", " ", 
    RowBox[{"of", " ", "given", " ", 
     RowBox[{"form", ".", " ", "pick"}], " ", 
     RowBox[{"z", "/", "R"}]}], ",", " ", "gradv", ",", " ", 
    RowBox[{
     RowBox[{"solve", " ", "..."}], " ", "\[IndentingNewLine]", "but", " ", 
     RowBox[{"z", "/", "R"}], " ", "needs", " ", "to", " ", "correspond", " ",
      "to", " ", "n_hat", " ", "that", " ", "can", " ", 
     RowBox[{"be", "?", " ", "\[IndentingNewLine]", "should"}], " ", "i", " ",
      "solve", " ", "all", " ", "three"}], ",", " ", 
    RowBox[{"or", " ", "do", " ", "this", " ", "backwards", " ", 
     RowBox[{"way", "?", "\[IndentingNewLine]", "Try"}], " ", 
     RowBox[{"both", "!"}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"nr", " ", "nt", " ", "nz", " ", "rRatio", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "s"}], ")"}]}], 
           RowBox[{"3", " ", "s"}]]}]},
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"nz", " ", "rRatio", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              RowBox[{"2", " ", "s"}], "+", 
              RowBox[{
               SuperscriptBox["nt", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "s"}], ")"}]}]}], ")"}]}], 
           RowBox[{"3", " ", "s"}]]}]},
        {
         RowBox[{"-", 
          FractionBox[
           RowBox[{"nt", " ", "rRatio", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "s", "+", 
              RowBox[{
               SuperscriptBox["nz", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "s"}], ")"}]}]}], ")"}]}], 
           RowBox[{"3", " ", "s"}]]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", " ", "=", " ", 
    RowBox[{"1", "/", "10"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"p", " ", "=", " ", 
     RowBox[{"d", "/", "L"}]}], ",", " ", 
    RowBox[{
     RowBox[{"L", "/", "d"}], " ", "=", " ", "10"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vol", " ", "=", " ", ".39"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zRatio", " ", "=", " ", ".005"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"z", "/", "R"}], ",", " ", 
    RowBox[{
    "in", " ", "principle", " ", "smaller", " ", "than", " ", "this", " ", 
     "buts", " ", "lets", " ", "just", " ", "see"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"rRatio", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradv", " ", "=", " ", ".001"}], ";", "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"this", " ", "is", " ", "now", " ", "mu_hat", "*", "R"}], ",", 
     " ", 
     RowBox[{"not", " ", "just", " ", "mu_hat"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"deltav", " ", "=", " ", ".01"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"file", "=", 
  RowBox[{"OpenWrite", "[", 
   RowBox[{"\"\<rad_fix_r1\>\"", ",", 
    RowBox[{"FormatType", "\[Rule]", "OutputForm"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"gradv", " ", "<", " ", "1.001"}], ",", " ", 
    RowBox[{
     RowBox[{"Write", "[", 
      RowBox[{"file", ",", " ", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<gradv = \>\"", ",", 
         RowBox[{"ToString", "[", "gradv", "]"}]}], "]"}]}], "]"}], ";", " ", 
     
     RowBox[{"Print", "[", 
      RowBox[{"\"\<gradv= \>\"", ",", "gradv"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sols", "=", " ", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"nr", " ", "nt", " ", "nz", " ", "rRatio", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "s"}], ")"}]}], 
            RowBox[{"3", " ", "s"}]]}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"nz", " ", "rRatio", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "-", 
               RowBox[{"2", " ", "s"}], "+", 
               RowBox[{
                SuperscriptBox["nt", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "s"}], ")"}]}]}], ")"}]}], 
            RowBox[{"3", " ", "s"}]]}], "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"nt", " ", "rRatio", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "s", "+", 
               RowBox[{
                SuperscriptBox["nz", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "s"}], ")"}]}]}], ")"}]}], 
            RowBox[{"3", " ", "s"}]]}], "\[Equal]", "0"}], "&&", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "6"}], "s", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"s", "^", "2"}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"-", "2"}], ")"}]}], "*", 
            RowBox[{
             RowBox[{"(", "p", ")"}], "^", "4"}], " ", "*", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "vol"}], ")"}], "^", "2"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "-", "1"}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"2", "s"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rRatio", "*", "gradv", "*", "nt", "*", "nz"}], " ", 
              "+", " ", 
              RowBox[{"2", "s", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"s", "^", "2"}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"-", "2"}], ")"}]}], " ", "*", 
               RowBox[{"(", 
                RowBox[{"p", "^", "3"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"1", "/", "vol"}], ")"}]}]}], ")"}]}]}], "\[Equal]", 
          " ", "0", "\[Equal]", " ", "0"}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"nr", "^", "2"}], "+", 
           RowBox[{"nt", "^", "2"}], " ", "+", " ", 
           RowBox[{"nz", "^", "2"}]}], "\[Equal]", " ", "1"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"nr", ",", "nt", ",", "nz", ",", "s"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ordersols", " ", "=", " ", 
      RowBox[{"s", " ", "/.", " ", "sols"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"checksol", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"RealQ", ",", " ", "ordersols"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"direcsols", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nr", ",", "nt", ",", "nz"}], "}"}], " ", "/.", " ", 
       "sols"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", " ", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "checksol", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"checksol", ",", "i"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"printstr", " ", "=", " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"DecimalForm", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"direcsols", ",", "i"}], "]"}], "]"}], "]"}], ",", 
              "\"\<,\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"DecimalForm", "[", 
                RowBox[{"Part", "[", 
                 RowBox[{"ordersols", ",", "i"}], "]"}], "]"}], "]"}]}], 
             "]"}]}], ";", 
           RowBox[{"WriteString", "[", 
            RowBox[{"file", ",", " ", "printstr"}], "]"}], ";", 
           RowBox[{"WriteString", "[", 
            RowBox[{"file", ",", "\"\<\\n\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Print", "[", "printstr", "]"}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     " ", ";", "\[IndentingNewLine]", 
     RowBox[{"gradv", " ", "=", " ", 
      RowBox[{"gradv", " ", "+", " ", "deltav"}]}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Close", "[", "file", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8321746941274223`*^9, 3.832174698436412*^9}, {
   3.832174806071055*^9, 3.832175019749391*^9}, {3.832175079025444*^9, 
   3.832175086403761*^9}, {3.8321751288580713`*^9, 3.8321751350957413`*^9}, {
   3.832175398273584*^9, 3.832175399082876*^9}, {3.832175444631586*^9, 
   3.832175449159054*^9}, {3.832176195792715*^9, 3.8321761972307253`*^9}, {
   3.832176391191517*^9, 3.832176397063429*^9}, {3.832176495653447*^9, 
   3.832176508527648*^9}, {3.833030930659552*^9, 3.833030939626937*^9}, {
   3.833031009592844*^9, 3.833031019028521*^9}, {3.833031617410434*^9, 
   3.83303164811617*^9}, {3.8330318323987427`*^9, 3.833031863539978*^9}, {
   3.833031894208479*^9, 3.833031897503385*^9}, {3.8330320139348087`*^9, 
   3.833032019842557*^9}, {3.833045901921322*^9, 3.833045931976055*^9}, {
   3.833046000384288*^9, 3.83304601165923*^9}, {3.8330460940685177`*^9, 
   3.833046108310432*^9}, 3.833208709893759*^9, 3.8332087727857027`*^9, {
   3.833208815871003*^9, 3.8332088244592533`*^9}, {3.8332088559346027`*^9, 
   3.833208862774288*^9}, {3.8332090254237957`*^9, 3.833209043894445*^9}, {
   3.833209094146338*^9, 3.8332092141977167`*^9}, {3.833228243699892*^9, 
   3.8332282876777353`*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"82132110-dc14-4e78-bba1-94a7c5c023e5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["OutputStream",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              Thickness[0.0016806722689075631`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               RGBColor[0.699951, 0.699951, 0.699951], 
               Opacity[1.], 
               JoinForm[{ElisionsDump`Miter, 10.}], 
               
               JoinedCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, {{{3.52539, 
                1.0035199999999997`}, {2.5250000000000004`, 
                1.0035199999999997`}, {1.6828099999999997`, 
                1.0035199999999997`}, {0.9999999999999999, 
                1.6863299999999997`}, {0.9999999999999999, 
                2.5285199999999994`}, {0.9999999999999999, 
                23.474999999999998`}, {0.9999999999999999, 
                24.317199999999996`}, {1.6828099999999997`, 
                24.999999999999996`}, {2.5250000000000004`, 
                24.999999999999996`}, {3.52539, 24.999999999999996`}, {
                3.52539, 24.999999999999993`}, {5.523440000000001, 
                22.421099999999996`}, {5.523440000000001, 13.0039}, {
                5.523440000000001, 3.5867199999999992`}, {3.52539, 
                1.0035199999999997`}, {3.52539, 1.0035199999999997`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}}}, {{{22.4977, 12.9016}, {
                17.740599999999997`, 16.8398}, {17.740599999999997`, 
                14.856599999999998`}, {19.980900000000002`, 
                12.947299999999997`}, {17.740599999999997`, 
                10.946100000000001`}, {17.740599999999997`, 8.96289}, {
                22.4977, 12.9016}}}]}, {
               FaceForm[{
                 RGBColor[
                 0.46093800000000007`, 0.46093800000000007`, 
                  0.46093800000000007`], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{9.202339999999998, 12.8969}, {9.202339999999998, 
                12.335499999999998`}, {8.747660000000002, 
                11.880899999999999`}, {8.186329999999998, 
                11.880899999999999`}, {7.624999999999999, 
                11.880899999999999`}, {7.169920000000001, 
                12.335499999999998`}, {7.169920000000001, 12.8969}, {
                7.169920000000001, 13.458200000000003`}, {7.624999999999999, 
                13.9133}, {8.186329999999998, 13.9133}, {8.747660000000002, 
                13.9133}, {9.202339999999998, 13.458200000000003`}, {
                9.202339999999998, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{12.6227, 12.8969}, {12.6227, 12.335499999999998`}, {
                12.167599999999998`, 11.880899999999999`}, {
                11.606200000000001`, 11.880899999999999`}, {11.0449, 
                11.880899999999999`}, {10.589799999999999`, 
                12.335499999999998`}, {10.589799999999999`, 12.8969}, {
                10.589799999999999`, 13.458200000000003`}, {11.0449, 
                13.9133}, {11.606200000000001`, 13.9133}, {
                12.167599999999998`, 13.9133}, {12.6227, 
                13.458200000000003`}, {12.6227, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{16.042600000000004`, 12.8969}, {16.042600000000004`, 
                12.335499999999998`}, {15.587499999999999`, 
                11.880899999999999`}, {15.026199999999998`, 
                11.880899999999999`}, {14.464799999999997`, 
                11.880899999999999`}, {14.010199999999998`, 
                12.335499999999998`}, {14.010199999999998`, 12.8969}, {
                14.010199999999998`, 13.458200000000003`}, {
                14.464799999999997`, 13.9133}, {15.026199999999998`, 
                13.9133}, {15.587499999999999`, 13.9133}, {
                16.042600000000004`, 13.458200000000003`}, {
                16.042600000000004`, 12.8969}}}]}}, AspectRatio -> 1, Axes -> 
             False, Background -> GrayLevel[0.5], Frame -> True, FrameStyle -> 
             Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Name: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  StyleBox[
                   PaneBox[
                   "\"rad_fix_r1\"", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                   False], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Unique ID: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              Thickness[0.0016806722689075631`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               RGBColor[0.699951, 0.699951, 0.699951], 
               Opacity[1.], 
               JoinForm[{ElisionsDump`Miter, 10.}], 
               
               JoinedCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}}}, {{{3.52539, 
                1.0035199999999997`}, {2.5250000000000004`, 
                1.0035199999999997`}, {1.6828099999999997`, 
                1.0035199999999997`}, {0.9999999999999999, 
                1.6863299999999997`}, {0.9999999999999999, 
                2.5285199999999994`}, {0.9999999999999999, 
                23.474999999999998`}, {0.9999999999999999, 
                24.317199999999996`}, {1.6828099999999997`, 
                24.999999999999996`}, {2.5250000000000004`, 
                24.999999999999996`}, {3.52539, 24.999999999999996`}, {
                3.52539, 24.999999999999993`}, {5.523440000000001, 
                22.421099999999996`}, {5.523440000000001, 13.0039}, {
                5.523440000000001, 3.5867199999999992`}, {3.52539, 
                1.0035199999999997`}, {3.52539, 1.0035199999999997`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}}}, {{{22.4977, 12.9016}, {
                17.740599999999997`, 16.8398}, {17.740599999999997`, 
                14.856599999999998`}, {19.980900000000002`, 
                12.947299999999997`}, {17.740599999999997`, 
                10.946100000000001`}, {17.740599999999997`, 8.96289}, {
                22.4977, 12.9016}}}]}, {
               FaceForm[{
                 RGBColor[
                 0.46093800000000007`, 0.46093800000000007`, 
                  0.46093800000000007`], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{9.202339999999998, 12.8969}, {9.202339999999998, 
                12.335499999999998`}, {8.747660000000002, 
                11.880899999999999`}, {8.186329999999998, 
                11.880899999999999`}, {7.624999999999999, 
                11.880899999999999`}, {7.169920000000001, 
                12.335499999999998`}, {7.169920000000001, 12.8969}, {
                7.169920000000001, 13.458200000000003`}, {7.624999999999999, 
                13.9133}, {8.186329999999998, 13.9133}, {8.747660000000002, 
                13.9133}, {9.202339999999998, 13.458200000000003`}, {
                9.202339999999998, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{12.6227, 12.8969}, {12.6227, 12.335499999999998`}, {
                12.167599999999998`, 11.880899999999999`}, {
                11.606200000000001`, 11.880899999999999`}, {11.0449, 
                11.880899999999999`}, {10.589799999999999`, 
                12.335499999999998`}, {10.589799999999999`, 12.8969}, {
                10.589799999999999`, 13.458200000000003`}, {11.0449, 
                13.9133}, {11.606200000000001`, 13.9133}, {
                12.167599999999998`, 13.9133}, {12.6227, 
                13.458200000000003`}, {12.6227, 12.8969}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}}}, {{{16.042600000000004`, 12.8969}, {16.042600000000004`, 
                12.335499999999998`}, {15.587499999999999`, 
                11.880899999999999`}, {15.026199999999998`, 
                11.880899999999999`}, {14.464799999999997`, 
                11.880899999999999`}, {14.010199999999998`, 
                12.335499999999998`}, {14.010199999999998`, 12.8969}, {
                14.010199999999998`, 13.458200000000003`}, {
                14.464799999999997`, 13.9133}, {15.026199999999998`, 
                13.9133}, {15.587499999999999`, 13.9133}, {
                16.042600000000004`, 13.458200000000003`}, {
                16.042600000000004`, 12.8969}}}]}}, AspectRatio -> 1, Axes -> 
             False, Background -> GrayLevel[0.5], Frame -> True, FrameStyle -> 
             Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Name: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                  "\"rad_fix_r1\"", ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Unique ID: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Binary: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["False", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Open: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  DynamicBox[
                   ToBoxes[Options[
                    OutputStream["rad_fix_r1", 3]] =!= {}, StandardForm], 
                   UpdateInterval -> 1], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Encoding: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Automatic", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Format: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["OutputForm", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Page width: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["78", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Number marks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Automatic", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  OutputStream["rad_fix_r1", 3],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.8321762010402193`*^9, 3.832176400439993*^9, 3.832176523119335*^9, 
   3.833031688502666*^9, {3.833031854351655*^9, 3.833031864002412*^9}, 
   3.8330318980977077`*^9, {3.8330320165437202`*^9, 3.8330320286657057`*^9}, 
   3.833046109129219*^9, 3.83320882668055*^9, {3.833208864321807*^9, 
   3.833208876033559*^9}, 3.833209048959084*^9, {3.8332091117505608`*^9, 
   3.833209182209319*^9}, 3.8332092161436853`*^9, 3.8332282931769753`*^9},
 CellLabel->
  "Out[415]=",ExpressionUUID->"88999004-adb5-4c79-a9da-7b333e7ac0a2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "might", " ", "take", " ", "out", " ", "rRatio", " ", "from", " ", 
      "below"}], ",", " ", 
     RowBox[{
     "to", " ", "remove", " ", "another", " ", "variable", " ", 
      "\[IndentingNewLine]", "  ", "thats", " ", "just", " ", "setting", " ", 
      "equal", " ", "to", " ", "1", " ", "here"}], ",", " ", 
     RowBox[{"if", " ", "done"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sdot", "[", 
     RowBox[{
     "gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_", ",", "p_", ",", 
      "vol_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "6"}], "s", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"s", "^", "2"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "2"}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"(", "p", ")"}], "^", "4"}], " ", "*", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "vol"}], ")"}], "^", "2"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"s", "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", "s"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"rRatio", "*", "gradv", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], "^", "2"}], ")"}], "*", 
         RowBox[{"Sin", "[", "\[Alpha]", "]"}], "*", 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], " ", "+", " ", 
        RowBox[{"2", "s", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"s", "^", "2"}]}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"-", "2"}], ")"}]}], " ", "*", 
         RowBox[{"(", 
          RowBox[{"p", "^", "3"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "/", "vol"}], ")"}]}]}], ")"}]}]}]}], 
   RowBox[{"(*", " ", 
    RowBox[{"from", " ", 
     RowBox[{"Tr", "[", 
      RowBox[{"F", "+", 
       RowBox[{"Q", " ", "dot", " ", "Q"}]}], "]"}], " ", "thing"}], "  ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"phidot", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", ":=", " ", 
     FractionBox[
      RowBox[{"rRatio", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "s"}], ")"}], " ", "gradv", " ", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{"3", " ", "s"}]]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"got", " ", "these", " ", "from", " ", 
      RowBox[{"dn", "/", "dphi"}], " ", "dot", " ", 
      RowBox[{"dn", "/", "dt"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphadot", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", ":=", " ", 
     FractionBox[
      RowBox[{"rRatio", " ", "gradv", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", "s"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "+", "s"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], 
      RowBox[{"6", " ", "s"}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"phidotphi", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"phidot", "[", 
        RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
       ",", " ", "\[Phi]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"phidotalpha", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"phidot", "[", 
        RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
       ",", " ", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"phidots", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"phidot", "[", 
        RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
       ",", " ", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"alphadotphi", " ", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"alphadot", "[", 
        RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
       ",", "\[Phi]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"alphadotalpha", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"alphadot", "[", 
        RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
       ",", "\[Alpha]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"alphadots", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"alphadot", "[", 
        RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
       ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdotphi", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sdot", "[", 
        RowBox[{
        "gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]", ",", "p", ",", 
         "vol"}], "]"}], ",", "\[Phi]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdotalpha", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sdot", "[", 
        RowBox[{
        "gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]", ",", "p", ",", 
         "vol"}], "]"}], ",", "\[Alpha]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdots", "[", 
      RowBox[{"gradv_", ",", "s_", ",", "\[Alpha]_", ",", "\[Phi]_"}], "]"}], 
     " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"sdot", "[", 
        RowBox[{
        "gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]", ",", "p", ",", 
         "vol"}], "]"}], ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Print", "[", " ", 
     RowBox[{
      RowBox[{"FortranForm", "[", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"sdots", "[", 
         RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
        "]"}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]", "\[RuleDelayed]", "alph"}], ",", " ", 
        RowBox[{"\[Phi]", "\[RuleDelayed]", "phi"}]}], "}"}]}], "]"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"phidotphi", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"phidotalpha", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"phidots", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], 
          "]"}]},
        {
         RowBox[{"alphadotphi", " ", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"alphadotalpha", " ", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"alphadots", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], 
          "]"}]},
        {
         RowBox[{"sdotphi", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"sdotalpha", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"sdots", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}]}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", " ", "=", " ", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{"phidotphi", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"phidotalpha", " ", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], 
          "]"}]},
        {
         RowBox[{"alphadotphi", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}], 
         
         RowBox[{"alphadotalpha", "[", 
          RowBox[{"gradv", ",", "s", ",", "\[Alpha]", ",", "\[Phi]"}], "]"}]}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"zRatio", " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"rRatio", " ", "=", " ", "1"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Phi]", " ", "=", " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"zRatio", "*", 
        RowBox[{"(", 
         RowBox[{"3", 
          RowBox[{"s", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "s"}], ")"}]}]}], ")"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "s"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "+", "s"}], ")"}]}], "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"\[Alpha]", " ", "=", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "-", "s"}], "]"}], "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"s", "-", "2", "+", 
            RowBox[{"s", "^", "2"}]}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{"2", "+", "s"}], "]"}], "*", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "s", "+", 
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"s", "^", "2"}]}], ")"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"9", 
               RowBox[{"s", "^", "2"}]}], ")"}], "*", 
             RowBox[{"zRatio", "^", "2"}]}]}], "]"}]}], ")"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gradv", " ", "=", " ", "1"}], ";", " ", 
     RowBox[{"zRatio", " ", "=", " ", "0"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"MatrixForm", "[", "m", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"MatrixForm", "[", "g", "]"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8321746941274223`*^9, 3.832174698436412*^9}, {
  3.832174806071055*^9, 3.832175019749391*^9}, {3.832175079025444*^9, 
  3.832175086403761*^9}, {3.8321751288580713`*^9, 3.8321751350957413`*^9}, {
  3.832175398273584*^9, 3.832175399082876*^9}, {3.832175444631586*^9, 
  3.832175465395041*^9}, {3.832175795158038*^9, 3.8321758094606037`*^9}, {
  3.833209285173793*^9, 3.8332093668730993`*^9}, {3.833210596254036*^9, 
  3.8332106196786823`*^9}, {3.833210673320786*^9, 3.833210758693241*^9}, {
  3.8332270751230803`*^9, 3.833227115956285*^9}, {3.833227269273468*^9, 
  3.833227369159852*^9}, {3.83322774994444*^9, 3.833227767457917*^9}, {
  3.833227803534178*^9, 3.8332278095848103`*^9}, {3.833227999989615*^9, 
  3.833228021218874*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"449649b7-8e21-47df-a8c9-6da3249fda6f"]
},
WindowSize->{1130, 831},
WindowMargins->{{-25, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8190ed5e-c075-4985-a1c0-94ae1c766c24"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 13008, 335, 1032, "Input",ExpressionUUID->"82132110-dc14-4e78-bba1-94a7c5c023e5"],
Cell[13591, 359, 19317, 357, 62, "Output",ExpressionUUID->"88999004-adb5-4c79-a9da-7b333e7ac0a2"]
}, Open  ]],
Cell[32923, 719, 12480, 331, 805, "Input",ExpressionUUID->"449649b7-8e21-47df-a8c9-6da3249fda6f"]
}
]
*)

